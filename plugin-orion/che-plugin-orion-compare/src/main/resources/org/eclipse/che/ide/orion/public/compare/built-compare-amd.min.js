/*

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation
 RequireJS text 2.0.12 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/text for details

 Copyright (c) 2012, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).


 Copyright (c) 2012, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010,2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation
               Alex Lakatos - fix for bug#369781

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10/.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 


 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013,2014 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation
  Mihai Sucan (Mozilla Foundation) - fix for Bug#334583 Bug#348471 Bug#349485 Bug#350595 Bug#360726 Bug#361180 Bug#362835 Bug#362428 Bug#362286 Bug#354270 Bug#361474 Bug#363945 Bug#366312 Bug#370584

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2010, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2009, 2015 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2014 IBM Corporation and others. All rights reserved.
 This program and the accompanying materials are made available under the
 terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: 
 IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: 
  Felipe Heidrich (IBM Corporation) - initial API and implementation
  Silenio Quarti (IBM Corporation) - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2012, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made
 available under the terms of the Eclipse Public License v1.0
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors: IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2010, 2012 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation

 Copyright (c) 2011, 2012 IBM Corporation and others. All rights reserved. This
 program and the accompanying materials are made available under the terms of
 the Eclipse Public License v1.0 (http://www.eclipse.org/legal/epl-v10.html),
 and the Eclipse Distribution License v1.0
 (http://www.eclipse.org/org/documents/edl-v10.html).

 Contributors: IBM Corporation - initial API and implementation
 RequireJS i18n 2.0.4 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details

 Copyright (c) 2011, 2013 IBM Corporation and others.
 All rights reserved. This program and the accompanying materials are made 
 available under the terms of the Eclipse Public License v1.0 
 (http://www.eclipse.org/legal/epl-v10.html), and the Eclipse Distribution 
 License v1.0 (http://www.eclipse.org/org/documents/edl-v10.html). 

 Contributors:
     IBM Corporation - initial API and implementation
*/
define("orion/util",[],function(){var k=navigator.userAgent,m=-1!==k.indexOf("MSIE")||-1!==k.indexOf("Trident")?document.documentMode:void 0,e=parseFloat(k.split("Firefox/")[1]||k.split("Minefield/")[1])||void 0,c=-1!==k.indexOf("Opera")?parseFloat(k.split("Version/")[1]):void 0,g=parseFloat(k.split("Chrome/")[1])||void 0,d=-1!==k.indexOf("Safari")&&!g,f=parseFloat(k.split("WebKit/")[1])||void 0,n=-1!==k.indexOf("Android"),l=-1!==k.indexOf("iPad"),k=-1!==k.indexOf("iPhone"),b=l||k,a=-1!==navigator.platform.indexOf("Mac"),
q=-1!==navigator.platform.indexOf("Win"),h=-1!==navigator.platform.indexOf("Linux"),p="undefined"!==typeof document&&"ontouchstart"in document.createElement("input");return{formatMessage:function(a){var b=arguments;return a.replace(/\$\{([^\}]+)\}/g,function(a,h){return b[(h<<0)+1]})},createElement:function(a,b){return a.createElementNS?a.createElementNS("http://www.w3.org/1999/xhtml",b):a.createElement(b)},isIE:m,isFirefox:e,isOpera:c,isChrome:g,isSafari:d,isWebkit:f,isAndroid:n,isIPad:l,isIPhone:k,
isIOS:b,isMac:a,isWindows:q,isLinux:h,isTouch:p,platformDelimiter:q?"\r\n":"\n"}});
define("orion/webui/littlelib",["orion/util"],function(k){function m(a,b){b||(b=document);return b.querySelectorAll(a)}function e(a){var b=a.tabIndex;0===b&&k.isIE&&!{a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0}[a.nodeName.toLowerCase()]&&!a.attributes.tabIndex&&(b=-1);return b}function c(a){if(0<=e(a))return a;if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++){var h=c(a.childNodes[b]);if(h)return h}return null}function g(a){if(0<=
e(a))return a;if(a.hasChildNodes())for(var b=a.childNodes.length-1;0<=b;b--){var h=g(a.childNodes[b]);if(h)return h}return null}function d(a,b){if(3===a.nodeType){var h=f.exec(a.nodeValue);h&&1<h.length&&b(a,h)}if(a.hasChildNodes())for(h=0;h<a.childNodes.length;h++)d(a.childNodes[h],b)}var f=/\$\{([^\}]+)\}/,n=null,l={BKSPC:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DEL:46},b=Object.create(null);Object.keys(l).forEach(function(a){b[l[a]]=
a});return{$:function(a,b){b||(b=document);return b.querySelector(a)},$$:m,$$array:function(a,b){return Array.prototype.slice.call(m(a,b))},node:function(a){var b=a;"string"===typeof a&&(b=document.getElementById(a));return b},contains:function(a,b){if(!a||!b)return!1;if(a===b)return!0;var h=a.compareDocumentPosition(b);return Boolean(h&16)},bounds:function(a){a=a.getBoundingClientRect();var b=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),h=Math.max(document.documentElement.scrollTop,
document.body.scrollTop);return{left:a.left+b,top:a.top+h,width:a.width,height:a.height}},empty:function(a){for(;a.hasChildNodes();)a.removeChild(a.firstChild)},firstTabbable:c,lastTabbable:g,stop:function(a){window.document.all&&(a.keyCode=0);a.preventDefault&&(a.preventDefault(),a.stopPropagation())},processTextNodes:function(a,b){d(a,function(a,p){a.parentNode.replaceChild(document.createTextNode(b[p[1]]||p[1]),a)})},processDOMNodes:function(a,b){d(a,function(a,p){var r=b[p[1]];if(r){var u=document.createRange(),
d=p.index;u.setStart(a,d);u.setEnd(a,d+p[0].length);u.deleteContents();u.insertNode(r)}})},addAutoDismiss:function(a,b){function h(a){n.forEach(function(b){var h=!1,d=b.excludeNodes.some(function(b){return document.body.contains(b)?(h=!0,b.contains(a.target)):!1});if(h&&!d)try{b.dismiss(a)}catch(q){"undefined"!==typeof console&&console&&console.error(q&&q.message)}});n=n.filter(function(a){return a.excludeNodes.some(function(a){return document.body.contains(a)})})}null===n&&(n=[],document.addEventListener("click",
h,!0),k.isIOS&&document.addEventListener("touchend",function(a){function b(){a.target.removeEventListener("click",b)}0===a.touches.length&&a.target.addEventListener("click",b)},!1));n.push({excludeNodes:a,dismiss:b})},setFramesEnabled:function(a){for(var b=document.getElementsByTagName("iframe"),h=0;h<b.length;h++)b[h].parentNode.style.pointerEvents=a?"":"none"},getOffsetParent:function(a){a=a.parentNode;for(var b=document.documentElement;a&&a!==b;){var h=window.getComputedStyle(a,null);if(!h)break;
h=h.getPropertyValue("overflow-y");if("auto"===h||"scroll"===h)break;a=a.parentNode}return a},removeAutoDismiss:function(a){n=n.filter(function(b){return a!==b.dismiss})},keyName:function(a){return b[a]||null},KEY:l,createNodes:function(a,b){var h=b,p=null;void 0===h&&(h=document.createElement("div"));h.innerHTML=a;return p=1<h.children.length?h.children:h.firstChild}}});
define("orion/commandsProxy",["orion/util","orion/webui/littlelib"],function(k,m){function e(c,d){c=c||window.event;if(function(d){if(k.isMac){if(d.metaKey&&!d.altKey)return!d.shiftKey&&!d.ctrlKey&&(65===d.keyCode||67===d.keyCode||86===d.keyCode||88===d.keyCode||90===d.keyCode)?!0:!1;if(d.ctrlKey)return!1}else{if(d.ctrlKey&&!d.altKey)return!d.shiftKey&&(65===d.keyCode||67===d.keyCode||86===d.keyCode||88===d.keyCode||90===d.keyCode)?!0:!1;if(d.altKey&&!d.ctrlKey||d.ctrlKey&&d.altKey)return!1}if(d["char"])return 0<
d["char"].length;if(d.charCode||d.keyCode)switch(d=d.charCode||d.keyCode,d){case 8:case 9:case 13:case 46:return!0;default:return 32<=d&&112>d||123<d}return!1}(c)){if("true"===c.target.contentEditable)return;var f=c.target.nodeName.toLowerCase();if("input"===f)switch(c.target.type.toLowerCase()){case "text":case "password":case "search":case "color":case "date":case "datetime":case "datetime-local":case "email":case "month":case "number":case "range":case "tel":case "time":case "url":case "week":return}else if("textarea"===
f)return}d(c)}function c(){this._init()}c.prototype={destroy:function(){this._listener&&(document.removeEventListener("keydown",this._listener),this._listener=null)},setProxy:function(c){this.proxy=c},setKeyBindings:function(c){this.bindings=c},_init:function(){var c=this;document.addEventListener("keydown",this._listener=function(d){return e(d,function(d){var n=c.proxy,l=c.bindings;if(l&&n)for(var b=0;b<l.length;b++)l[b].match(d)&&(n.processKey({type:d.type,keyCode:d.keyCode,altKey:d.altKey,ctrlKey:d.ctrlKey,
metaKey:d.metaKey,shiftKey:d.shiftKey}),m.stop(d))})})}};return{handleKeyEvent:e,CommandsProxy:c}});
define("orion/EventTarget",[],function(){function k(){this._namedListeners={}}k.prototype={dispatchEvent:function(k){if(!k.type)throw Error("unspecified type");var e=this._namedListeners[k.type];e&&e.forEach(function(c){try{"function"===typeof c?c(k):c.handleEvent(k)}catch(g){"undefined"!==typeof console&&console.log(g)}});return!k.defaultPrevented},addEventListener:function(k,e){if("function"===typeof e||e.handleEvent)this._namedListeners[k]=this._namedListeners[k]||[],this._namedListeners[k].push(e)},
removeEventListener:function(k,e){var c=this._namedListeners[k];if(c)for(var g=0;g<c.length;g++)if(c[g]===e){1===c.length?delete this._namedListeners[k]:c.splice(g,1);break}}};k.prototype.constructor=k;k.attach=function(m){var e=new k;m.dispatchEvent=e.dispatchEvent.bind(e);m.addEventListener=e.addEventListener.bind(e);m.removeEventListener=e.removeEventListener.bind(e)};return k});
define("orion/webui/dropdown",["orion/webui/littlelib","orion/EventTarget"],function(k,m){function e(d){m.attach(this);this._init(d)}function c(d,c){var g=document.createElement(void 0===c?"span":c);g.tabIndex=0;g.className="dropdownMenuItem";g.role="menuitem";if(d){var l=document.createElement("span");l.appendChild(document.createTextNode(d));l.classList.add("dropdownCommandName");g.appendChild(l)}l=document.createElement("li");l.appendChild(g);return l}function g(){var d=document.createElement("li");
d.classList.add("dropdownSeparator");return d}e.prototype={_init:function(d){this._dropdownNode=k.node(d.dropdown);if(!this._dropdownNode)throw"no dom node for dropdown found";this._populate=d.populate;this._selectionClass=d.selectionClass;this._parentDropdown=d.parentDropdown;this._positioningNode=d.positioningNode;if(!this._parentDropdown)for(var c=this._dropdownNode.parentNode;c&&document!==c;){if(c.classList&&c.classList.contains("dropdownMenu")){this._parentDropdown=c.dropdown;break}c=c.parentNode}this._dropdownNode.tabIndex=
0;this._triggerNode=d.triggerNode?d.triggerNode:k.$(".dropdownTrigger",this._dropdownNode.parentNode);if(!this._triggerNode)throw"no dom node for dropdown trigger found";var g=function(d){var b=!1;(b=this._triggerNode.classList.contains("dropdownMenuItem")?this.open(d):this.toggle(d))&&k.stop(d)}.bind(this);d.skipTriggerEventListeners||(this._triggerNode.addEventListener("click",g,!1),"span"===this._triggerNode.tagName.toLowerCase()&&this._triggerNode.addEventListener("keydown",function(d){(d.keyCode===
k.KEY.ENTER||d.keyCode===k.KEY.SPACE)&&g(d)}.bind(this),!1));this._dropdownNode.addEventListener("keydown",this._dropdownKeyDown.bind(this),!1)},addTriggerNode:function(d){var c=this;d.addEventListener("click",function(d){c.toggle(d)&&k.stop(d)},!1)},toggle:function(d){return this.isVisible()?this.close():this.open(d)},isVisible:function(){return this._isVisible},open:function(d){var c=!1;this.isVisible()||(this.dispatchEvent({type:"triggered",dropdown:this,event:d}),k.setFramesEnabled(!1),this._populate&&
(this.empty(),this._populate(this._dropdownNode)),0<this.getItems().length&&(this._boundAutoDismiss&&k.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=this._autoDismiss.bind(this),c=k.$$array(".dropdownSubMenu",this._dropdownNode),k.addAutoDismiss([this._triggerNode].concat(c),this._boundAutoDismiss),this._triggerNode.classList.add("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.add(this._selectionClass),this._dropdownNode.classList.add("dropdownMenuOpen"),
this._isVisible=!0,this._positionDropdown(d),this._focusDropdownNode(),c=!0,this._parentDropdown&&this._parentDropdown.submenuOpen(this)));return c},_focusDropdownNode:function(){this._dropdownNode.focus()},_autoDismiss:function(d){if(this.close(!1)&&this._dropdownNode.contains(d.target))for(d=this._parentDropdown;d;)d.close(!1),d=d._parentDropdown},_positionDropdown:function(d){this._dropdownNode.style.left="";this._dropdownNode.style.top="";if(this._positioningNode)this._dropdownNode.style.left=
this._positioningNode.offsetLeft+"px";else{d=k.bounds(this._dropdownNode);var c=k.bounds(document.body);if(d.left+d.width>c.left+c.width)if(this._triggerNode.classList.contains("dropdownMenuItem"))this._dropdownNode.style.left=-d.width+"px";else{var g=k.bounds(this._boundingNode(this._triggerNode)),l=k.bounds(this._triggerNode);this._dropdownNode.style.left=l.left-g.left-d.width+l.width+"px"}d=d.top+d.height-(c.top+c.height);0<d&&(this._dropdownNode.style.top=Math.floor(this._dropdownNode.style.top-
d)+"px")}},_boundingNode:function(d){var c=window.getComputedStyle(d,null);return null===c||"absolute"===c.getPropertyValue("position")||!d.parentNode||d===document.body?d:this._boundingNode(d.parentNode)},close:function(d){var c=!1;this.isVisible()&&(this._triggerNode.classList.remove("dropdownTriggerOpen"),this._selectionClass&&this._triggerNode.classList.remove(this._selectionClass),this._dropdownNode.classList.remove("dropdownMenuOpen"),k.setFramesEnabled(!0),d&&this._triggerNode.focus(),this._isVisible=
!1,this._selectedItem&&(this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=null),this._boundAutoDismiss&&(k.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=null),c=!0);return c},getItems:function(){var d=[],c=this;k.$$array("li:not(.dropdownSeparator) \x3e .dropdownMenuItem",this._dropdownNode,!0).forEach(function(g){g.parentNode.parentNode===c._dropdownNode&&d.push(g)});d.forEach(function(d){d._hasDropdownMouseover||(d.addEventListener("mouseover",
function(g){d.dropdown?d.dropdown.open(g):(c._closeSelectedSubmenu(),k.stop(g));c._selectItem(d)}),d._hasDropdownMouseover=!0)});return d},empty:function(){var d=this;k.$$array("li",this._dropdownNode).forEach(function(c){c.parentNode===d._dropdownNode&&c.parentNode.removeChild(c)})},_dropdownKeyDown:function(d){if(d.keyCode===k.KEY.UP||d.keyCode===k.KEY.DOWN||d.keyCode===k.KEY.RIGHT||d.keyCode===k.KEY.ENTER||d.keyCode===k.KEY.LEFT){var c=this.getItems();if(c.length&&0<c.length){if(this._selectedItem){var g=
c.indexOf(this._selectedItem);0>g&&(g=c.indexOf(this._selectedItem.parentNode));0<=g&&(d.keyCode===k.KEY.UP&&0<g?(g--,this._selectItem(c[g])):d.keyCode===k.KEY.DOWN&&g<c.length-1?(g++,this._selectItem(c[g])):d.keyCode===k.KEY.ENTER||d.keyCode===k.KEY.RIGHT?this._selectedItem.classList.contains("dropdownTrigger")&&this._selectedItem.dropdown?(this._selectedItem.dropdown.open(),this._selectedItem.dropdown._selectItem()):d.keyCode===k.KEY.ENTER&&this._selectedItem.click():d.keyCode===k.KEY.LEFT&&this._selectedItem.parentNode.parentNode.classList.contains("dropdownMenuOpen")&&
(this.close(!0),this._parentDropdown&&this._parentDropdown._dropdownNode.focus()))}else this._selectItem(c[0]);k.stop(d)}}else d.keyCode===k.KEY.ESCAPE&&(this.close(!0),k.stop(d))},_selectItem:function(d){if(d=d||this.getItems()[0])this._selectedItem&&this._selectedItem.classList.remove("dropdownMenuItemSelected"),this._selectedItem=d,this._selectedItem.classList.add("dropdownMenuItemSelected");document.activeElement!==this._dropdownNode&&this._dropdownNode.focus()},submenuOpen:function(d){d!==this._selectedSubmenu&&
(this._closeSelectedSubmenu(),this._selectedSubmenu=d)},_closeSelectedSubmenu:function(){for(var d=this._selectedSubmenu;d;)d.close(),d=d._selectedSubmenu},destroy:function(){this.empty();this._boundAutoDismiss&&(k.removeAutoDismiss(this._boundAutoDismiss),this._boundAutoDismiss=null)},appendMenuItem:function(d,f){var g=c(d,f);this._dropdownNode.appendChild(g);return g},appendSeparator:function(){var d=g();this._dropdownNode.appendChild(d);return d}};e.prototype.constructor=e;return{Dropdown:e,appendKeyBindingString:function(d,
c){var g=document.createElement("span");g.classList.add("dropdownKeyBinding");g.appendChild(document.createTextNode(c));d.appendChild(g)},createMenuItem:c,createSeparator:g}});
define("text",["module"],function(k){var m,e,c,g,d,f=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,b="undefined"!==typeof location&&location.href,a=b&&location.protocol&&location.protocol.replace(/\:/,""),q=b&&location.hostname,h=b&&(location.port||void 0),p={},r=k.config&&k.config()||{};m={version:"2.0.12",strip:function(a){if(a){a=a.replace(n,"");var b=a.match(l);b&&(a=b[1])}else a=
"";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:r.createXhr||function(){var a,b,h;if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)for(b=0;3>b;b+=1){h=f[b];try{a=new ActiveXObject(h)}catch(r){}if(a){f=[h];break}}return a},parseName:function(a){var b,
h,r=!1,d=a.indexOf(".");b=0===a.indexOf("./")||0===a.indexOf("../");-1!==d&&(!b||1<d)?(b=a.substring(0,d),h=a.substring(d+1,a.length)):b=a;a=h||b;d=a.indexOf("!");-1!==d&&(r="strip"===a.substring(d+1),a=a.substring(0,d),h?h=a:b=a);return{moduleName:b,ext:h,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,b,h,r){var d,c;d=m.xdRegExp.exec(a);if(!d)return!0;a=d[2];d=d[3];d=d.split(":");c=d[1];d=d[0];return(!a||a===b)&&(!d||d.toLowerCase()===h.toLowerCase())&&(!c&&!d||c===r)},finishLoad:function(a,
b,h,d){h=b?m.strip(h):h;r.isBuild&&(p[a]=h);d(h)},load:function(d,c,p,f){if(f&&f.isBuild&&!f.inlineText)p();else{r.isBuild=f&&f.isBuild;var g=m.parseName(d);f=g.moduleName+(g.ext?"."+g.ext:"");var l=c.toUrl(f),n=r.useXhr||m.useXhr;0===l.indexOf("empty:")?p():!b||n(l,a,q,h)?m.get(l,function(a){m.finishLoad(d,g.strip,a,p)},function(a){p.error&&p.error(a)}):c([f],function(a){m.finishLoad(g.moduleName+"."+g.ext,g.strip,a,p)})}},write:function(a,b,h,d){p.hasOwnProperty(b)&&(d=m.jsEscape(p[b]),h.asModule(a+
"!"+b,"define(function () { return '"+d+"';});\n"))},writeFile:function(a,b,h,d,r){b=m.parseName(b);var c=b.ext?"."+b.ext:"",p=b.moduleName+c,q=h.toUrl(b.moduleName+c)+".js";m.load(p,h,function(b){b=function(s){return d(q,s)};b.asModule=function(s,x){return d.asModule(s,q,x)};m.write(a,p,b,r)},r)}};if("node"===r.env||!r.env&&"undefined"!==typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"])e=require.nodeRequire("fs"),m.get=function(a,b,h){try{var d=e.readFileSync(a,
"utf8");0===d.indexOf("\ufeff")&&(d=d.substring(1));b(d)}catch(r){h&&h(r)}};else if("xhr"===r.env||!r.env&&m.createXhr())m.get=function(a,b,h,d){var c=m.createXhr(),p;c.open("GET",a,!0);if(d)for(p in d)d.hasOwnProperty(p)&&c.setRequestHeader(p.toLowerCase(),d[p]);if(r.onXhr)r.onXhr(c,a);c.onreadystatechange=function(d){if(4===c.readyState&&(d=c.status||0,399<d&&600>d?(d=Error(a+" HTTP status: "+d),d.xhr=c,h&&h(d)):b(c.responseText),r.onXhrComplete))r.onXhrComplete(c,a)};c.send(null)};else if("rhino"===
r.env||!r.env&&"undefined"!==typeof Packages&&"undefined"!==typeof java)m.get=function(a,b){var h,d,r=new java.io.File(a),c=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),p="";try{h=new java.lang.StringBuffer;(d=r.readLine())&&(d.length()&&65279===d.charAt(0))&&(d=d.substring(1));for(null!==d&&h.append(d);null!==(d=r.readLine());)h.append(c),h.append(d);p=String(h.toString())}finally{r.close()}b(p)};
else if("xpconnect"===r.env||!r.env&&"undefined"!==typeof Components&&Components.classes&&Components.interfaces)c=Components.classes,g=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),d="@mozilla.org/windows-registry-key;1"in c,m.get=function(a,b){var h,r,p,q={};d&&(a=a.replace(/\//g,"\\"));p=new FileUtils.File(a);try{h=c["@mozilla.org/network/file-input-stream;1"].createInstance(g.nsIFileInputStream),h.init(p,1,0,!1),r=c["@mozilla.org/intl/converter-input-stream;1"].createInstance(g.nsIConverterInputStream),
r.init(h,"utf-8",h.available(),g.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(h.available(),q),r.close(),h.close(),b(q.value)}catch(f){throw Error((p&&p.path||"")+": "+f);}};return m});define("text!orion/webui/dropdowntriggerbutton.html",[],function(){return'\x3cbutton class\x3d"dropdownTrigger"\x3e${ButtonText}\x3c!--span class\x3d"dropdownArrowDown core-sprite-openarrow"\x3e\x3c/span--\x3e\x3c/button\x3e\x3cul class\x3d"dropdownMenu"\x3e\x3c/ul\x3e'});
define("text!orion/webui/dropdowntriggerbuttonwitharrow.html",[],function(){return'\x3cbutton class\x3d"dropdownTrigger dropdownDefaultButton"\x3e${ButtonText}\x3cspan class\x3d"dropdownArrowDown core-sprite-openarrow"\x3e\x3c/span\x3e\x3c/button\x3e\x3cul class\x3d"dropdownMenu"\x3e\x3c/ul\x3e'});define("text!orion/webui/checkedmenuitem.html",[],function(){return'\x3cli\x3e\x3clabel class\x3d"dropdownMenuItem"\x3e\x3cinput class\x3d"checkedMenuItem" role\x3d"menuitem" type\x3d"checkbox" /\x3e${ItemText}\x3c/label\x3e\x3c/li\x3e'});
define("orion/webui/tooltip",["orion/webui/littlelib"],function(k){function m(e){this._init(e)}m.prototype={_init:function(e){this._node=k.node(e.node);if(!this._node)throw"no dom node for tooltip found";this._position=e.position||["right","above","below","left"];this._text=e.text;this._hideDelay=void 0===e.hideDelay?200:e.hideDelay;this._tailSize=e.tailSize||10;this._trigger=e.trigger||"mouseover";this._afterShowing=e.afterShowing;this._afterHiding=e.afterHiding;var c=this;if("click"===this._trigger)this._showDelay=
0,this._node.addEventListener("click",this._clickHandler=function(d){d.target===c._node&&(c.show(),k.stop(d))},!1);else if("mouseover"===this._trigger){this._showDelay=void 0===e.showDelay?500:e.showDelay;e=["mouseout","click"];this._node.addEventListener("mouseover",this._mouseoverHandler=function(d){k.contains(c._node,d.target)&&(c.show(),k.stop(d))},!1);this._leaveHandler=function(d){k.contains(c._node,d.target)&&c.hide()};for(var g=0;g<e.length;g++)this._node.addEventListener(e[g],this._leaveHandler,
!1)}else"focus"===this._trigger&&(this._showDelay=void 0===e.showDelay?0:e.showDelay,this._hideDelay=void 0===e.hideDelay?0:e.hideDelay,this._node.addEventListener("focus",this._focusHandler=function(d){k.contains(c._node,d.target)&&c.show()},!1),this._blurHandler=function(d){k.contains(c._node,d.target)&&c.hide()},this._node.addEventListener("blur",this._blurHandler,!1))},_makeTipNode:function(){if(!this._tip){this._tip=document.createElement("span");this._tip.classList.add("tooltipContainer");this._tipInner=
document.createElement("div");this._tipInner.classList.add("tooltip");if(this._text){this._tipTextContent=document.createElement("div");this._tipTextContent.classList.add("textContent");this._tipInner.appendChild(this._tipTextContent);var e=document.createTextNode(this._text);this._tipTextContent.appendChild(e)}this._tip.appendChild(this._tipInner);document.body.appendChild(this._tip);var c=this;k.addAutoDismiss([this._tip,this._node],function(){c.hide()});"mouseover"===this._trigger&&(this._tipInner.role=
"tooltip",this._tipInner.id="tooltip"+(new Date).getTime().toString(),this._node.setAttribute("aria-describedby",this._tipInner.id),this._tip.addEventListener("mouseover",function(g){c._timeout&&(window.clearTimeout(c._timeout),c._timeout=null);c._tip.addEventListener("mouseout",function(d){k.contains(c._tip,d.target)&&(c.hide(),k.stop(d))},!1)},!1))}return this._tip},_positionTip:function(e,c){this._makeTipNode();this._tip.classList.add("tooltipShowing");"left"===e?this._tipInner.classList.add("left"):
this._tipInner.classList.remove("left");var g=this._node,d;for(d=k.bounds(g);g&&!d.width&&!d.height;g=g.parentNode)d=k.bounds(g);var g=k.bounds(this._tipInner),f;switch(e){case "above":f=d.top-g.height-this._tailSize-1;d=d.left-this._tailSize;break;case "below":f=d.top+d.height+this._tailSize+1;d=d.left-this._tailSize;break;case "left":f=d.top-this._tailSize/2;d=d.left-g.width-this._tailSize-1;break;default:f=d.top-this._tailSize/2,d=d.left+d.width+this._tailSize+1}var n=document.body,l=document.documentElement,
b=Math.max(l.scrollLeft,n.scrollLeft),n=Math.max(l.scrollTop,n.scrollTop),a=b+l.clientWidth,l=n+l.clientHeight;if(f+g.height>l)if(c)f=l-g.height-1;else return!1;if(d+g.width>a)if(c)d=a-g.width-1;else return!1;if(d<b)if(c)d=b+4;else return!1;if(f<n)if(c)f=n+4;else return!1;this._tail&&this._tail.previousPosition!==e&&(this._tip.removeChild(this._tail),this._tail=null);this._tail||(this._tail=document.createElement("span"),this._tail.classList.add("tooltipTailFrom"+e),"above"===e||"left"===e?this._tip.appendChild(this._tail):
this._tip.insertBefore(this._tail,this._tipInner),this._tail.previousPosition=e);this._tip.style.top=f+"px";this._tip.style.left=d+"px";return!0},contentContainer:function(){this._makeTipNode();return this._tipInner},isShowing:function(){return this._tip&&this._tip.classList.contains("tooltipShowing")},show:function(){this.isShowing()||(this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null),this._showDelay?this._timeout=window.setTimeout(this._showImmediately.bind(this),this._showDelay):
this._showImmediately())},_showImmediately:function(){for(var e=!1,c=0;!e&&c<this._position.length;)e=this._positionTip(this._position[c]),c++;e||this._positionTip(this._position[0],!0);this._afterShowing&&this._afterShowing()},hide:function(e){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null);if(this.isShowing()){void 0===e&&(e=this._hideDelay);var c=this;this._timeout=window.setTimeout(function(){c._tip.classList.remove("tooltipShowing");c._tip.removeAttribute("style");c._afterHiding&&
c._afterHiding()},e)}},destroy:function(){this._timeout&&(window.clearTimeout(this._timeout),this._timeout=null);this._tip&&(document.body.removeChild(this._tip),this._tail=this._tipTextContent=this._tipInner=this._tip=null);if(this._node){this._node.removeEventListener("click",this._clickHandler,!1);this._node.removeEventListener("mouseover",this._mouseoverHandler,!1);this._node.removeEventListener("focus",this._focusHandler,!1);this._node.removeEventListener("blur",this._blurHandler,!1);for(var e=
["mouseout","click"],c=0;c<e.length;c++)this._node.removeEventListener(e[c],this._leaveHandler,!1)}}};m.prototype.constructor=m;return{Tooltip:m}});
define("orion/metrics",[],function(){function k(c,g){var d=window.location.protocol+"//"+window.location.hostname+window.location.pathname+window.location.search,f=window.location.pathname+window.location.search,n=document.title;e=c;e.forEach(function(c){c.pageLoad(d,f,n,g)})}function m(c,g,d,f){e.forEach(function(n){n.logTiming(c,g,d,f)})}var e=[];return{init:k,initFromRegistry:function(c,g){var d=[];c.getServiceReferences("orion.metrics").forEach(function(f){d.push(c.getService(f))});k(d,g)},logEvent:function(c,
g,d,f){e.forEach(function(n){n.logEvent(c,g,d,f)})},logPageLoadTiming:function(c,g){window.performance&&(window.performance.getEntriesByName&&window.performance.mark&&!window.performance.getEntriesByName(c).length)&&(window.performance.mark(c),m("page",c,window.performance.now(),g))},logTiming:m}});
define("orion/commands","orion/webui/littlelib orion/commandsProxy orion/webui/dropdown text!orion/webui/dropdowntriggerbutton.html text!orion/webui/dropdowntriggerbuttonwitharrow.html text!orion/webui/checkedmenuitem.html orion/webui/tooltip orion/metrics".split(" "),function(k,m,e,c,g,d,f,n){function l(a){var b=a.invocation;if(b){var h=a.command;if(h.hrefCallback)return a=h.hrefCallback.call(b.handler||window,b),a.then?a.then(function(a){window.open(a)}):window.open(a),!0;if(b.commandRegistry)return b.commandRegistry._invoke(b),
!0;if(h.onClick||h.callback)return window.setTimeout(function(){(h.onClick||h.callback).call(b.handler||window,b)},0),!0}return!1}function b(a,b){for(var h in b)if(b[h]&&(b[h].keyBinding&&b[h].command)&&b[h].keyBinding.match(a)){var d=b[h],r=d.keyBinding;if((!r.domScope||k.contains(k.node(r.domScope),a.target))&&l(d)){k.stop(a);break}}}function a(){var a={};if(u){var b,h,d;h=Object.keys(v);for(b=0;b<h.length;b++)d=h[b],a[d]=v[d];var r=u();h=Object.keys(r);for(b=0;b<h.length;b++)d=h[b],a[d]=r[d]}else a=
v;return a}function q(h){b(h,a())}function h(a,b,h){b.classList.add("commandImage");var d;a.imageClass?a.addImageClassToElement?b.classList.add(a.imageClass):(d=document.createElement("span"),b.appendChild(d),d.classList.add(a.spriteClass),d.classList.add(a.imageClass)):(d=new Image,d.alt=a.name,d.name=h,d.id=h,d.src=a.image,b.appendChild(d));return d}function p(a,b,h,d,r){this.commandRegistry=r;this.handler=a;this.items=b;this.userData=h;this.command=d;d.parameters&&(this.parameters=d.parameters.makeCopy());
this.id=d.id}function r(a){this._init(a)}var u=null,v={};window.document.addEventListener("keydown",function(a){return m.handleKeyEvent(a,q)},!1);p.prototype={collectsParameters:function(){return this.commandRegistry&&this.commandRegistry.collectsParameters()},makeCopy:function(a){var b=new p(this.handler,this.items,this.userData,this.command,this.commandRegistry);b.domNode=this.domNode;b.domParent=this.domParent;a?b.parameters=a.makeCopy():this.parameters&&(b.parameters=this.parameters.makeCopy());
return b}};p.prototype.constructor=p;r.prototype={_init:function(a){this.id=a.id;this.name=a.name;this.tooltip=a.tooltip;this.callback=a.callback;this.preCallback=a.preCallback;this.hrefCallback=a.hrefCallback;this.choiceCallback=a.choiceCallback;this.positioningNode=a.positioningNode;this.image=a.image||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC";this.imageClass=a.imageClass;this.addImageClassToElement=
a.addImageClassToElement;this.extraClass=a.extraClass;this.selectionClass=a.selectionClass;this.spriteClass=a.spriteClass||"commandSprite";this.visibleWhen=a.visibleWhen;this.parameters=a.parameters;this.isEditor=a.isEditor;this.type=a.type;this.checked=a.checked;this.track=a.track},populateChoicesMenu:function(a,b,h,d,r){h=this.getChoices(b,h,d);var c=h.some(function(a){return a.checked});h.forEach(function(h){if(h.name){var s=document.createElement("li");a.appendChild(s);var x=document.createElement("span");
x.tabIndex=0;x.role="menuitem";x.classList.add("dropdownMenuItem");if(c){var y=document.createElement("span");y.classList.add("check");y.appendChild(document.createTextNode(h.checked?"\u25cf":""));x.appendChild(y)}h.imageClass&&(y=document.createElement("span"),y.classList.add(h.imageClass),x.appendChild(y));var y=document.createElement("span"),d=document.createTextNode(h.name);y.appendChild(d);x.appendChild(y);s.appendChild(x);x.choice=h;x.addEventListener("click",function(s){n.logEvent("command",
"invoke",this.id+"\x3e"+h.name);h.callback.call(h,b)}.bind(this),!1);x.addEventListener("keydown",function(s){if(s.keyCode===k.KEY.ENTER||s.keyCode===k.KEY.SPACE)n.logEvent("command","invoke",this.id+"\x3e"+h.name),h.callback.call(h,b)}.bind(this),!1)}else r._generateMenuSeparator(a)}.bind(this))},getChoices:function(a,b,h){return this.choiceCallback?this.choiceCallback.call(b,a,h):null},makeChoiceCallback:function(a,b){return function(h){a.callback&&a.callback.call(a,b,h)}},hasImage:function(){return this.imageClass||
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC"!==this.image}};r.prototype.constructor=r;return{Command:r,CommandInvocation:p,createDropdownMenu:function(a,b,d,r,p,q,u,s,x,y){a=k.node(a);if(!a)throw"no parent node was specified";var D=document.createRange();D.selectNode(a);D=x?D.createContextualFragment(g):D.createContextualFragment(c);k.processTextNodes(D,{ButtonText:b});a.appendChild(D);a=a.lastChild;
var f;x?(x=a.previousSibling,f=x.lastChild):x=a.previousSibling;r?x.classList.add(r):(x.classList.add("orionButton"),x.classList.add("commandButton"));y&&y.split(" ").forEach(x.classList.add.bind(x.classList));p&&(q||(x.textContent="",x.setAttribute("aria-label",b)),h({spriteClass:"commandSprite",imageClass:p},x,b),x.classList.add("orionButton"));x.dropdown=new e.Dropdown({dropdown:a,populate:d,selectionClass:u,skipTriggerEventListeners:!!f,positioningNode:s});a.dropdown=x.dropdown;return{menuButton:x,
menu:a,dropdown:x.dropdown,dropdownArrow:f}},createCheckedMenuItem:function(a,b,h,r){a=k.node(a);if(!a)throw"no parent node was specified";var c=document.createRange();c.selectNode(a);c=c.createContextualFragment(d);k.processTextNodes(c,{ItemText:b});a.appendChild(c);a=k.$(".checkedMenuItem",a.lastChild);a.checked=h;a.addEventListener("change",r,!1);return a},createCommandItem:function(a,b,d,r,c,p,q){var s,x;p=p||!b.name&&b.hasImage();var y=function(){if(p)b.hasImage()?(h(b,s,r),b.name&&s.setAttribute("aria-label",
b.name)):(s.classList.add("commandButton"),s.classList.add("commandMissingImageButton"),s.appendChild(document.createTextNode(b.name)));else{s.classList.add("commandButton");var a=document.createTextNode(b.name);s.appendChild(a)}};if(b.hrefCallback)s=x=document.createElement("a"),s.id=r,p&&b.hasImage()?h(b,s,r):(s.className="commandLink",s.appendChild(document.createTextNode(b.name))),q=b.hrefCallback.call(d.handler,d),q.then?q.then(function(a){s.href=a}):s.href=q?q:"#";else{if("switch"===b.type){s=
document.createElement("div");s.tabIndex=0;s.className="orionSwitch";var u=x=document.createElement("input");u.type="checkbox";u.className="orionSwitchCheck";u.id="orionSwitchCheck"+b.id;a.id&&(u.id+=a.id);s.appendChild(u);y=document.createElement("label");y.className="orionSwitchLabel";y.setAttribute("for",u.id);var g=document.createElement("span");g.className="orionSwitchInner";var l=document.createElement("span");l.className="orionSwitchSwitch";y.appendChild(g);y.appendChild(l);s.appendChild(y);
s.addEventListener("keydown",function(s){(s.keyCode===k.KEY.ENTER||s.keyCode===k.KEY.SPACE)&&u.click()},!1);u.checked=b.checked;g.classList.add(b.imageClass)}else"toggle"===b.type?(s=x=document.createElement("button"),s.className="orionButton",s.classList.add(b.checked?"orionToggleOn":"orionToggleOff"),s.id="orionToggle"+b.id,a.id&&(s.id+=a.id)):(s=x=document.createElement("button"),s.className="orionButton",b.extraClass&&s.classList.add(b.extraClass)),y();var n=q||b.callback;if(n){var e=function(){n.call(d.handler,
d)};b.onClick=n;x.addEventListener("click",function(a){var x;x="switch"===b.type||"toggle"===b.type?function(a){"toggle"===b.type?(a&&(b.checked=!b.checked),b.checked?(s.classList.remove("orionToggleOff"),s.classList.add("orionToggleOn")):(s.classList.remove("orionToggleOn"),s.classList.add("orionToggleOff")),s.classList.add("orionToggleAnimate")):a?b.checked=u.checked:u.checked=!u.checked;a&&window.setTimeout(e,250)}:function(s){s&&e()};b.preCallback?b.preCallback(d).then(function(s){x(s)}):x(!0);
a.stopPropagation()},!1)}}"ul"===a.nodeName.toLowerCase()?(q=document.createElement("li"),a.appendChild(q),a=q):s.classList.add("commandMargins");a.appendChild(s);b.tooltip&&(s.commandTooltip=new f.Tooltip({node:s,text:b.tooltip,position:["above","below","right","left"]}));c&&(v[b.id]={keyBinding:c,command:b,invocation:d});return s},createCommandMenuItem:function(a,b,h,d,r,c){var p,s,x=a.dropdown;if(b.hrefCallback)s=e.createMenuItem(b.name,"a"),p=s.firstElementChild,r=b.hrefCallback.call(h.handler,
h),r.then?r.then(function(s){p.href=s}):p.href=r?r:"#",p.addEventListener("keydown",function(s){(s.keyCode===k.KEY.ENTER||s.keyCode===k.KEY.SPACE)&&p.click()},!1);else{s=e.createMenuItem(b.name);p=s.firstElementChild;var y=r||b.callback;y&&(b.onClick=y,p.addEventListener("click",function(s){x&&x.close(!0);y.call(h.handler,h)},!1),p.addEventListener("keydown",function(s){if(s.keyCode===k.KEY.ENTER||s.keyCode===k.KEY.SPACE)s.preventDefault(),p.click()},!1))}b.tooltip&&(p.commandTooltip=new f.Tooltip({node:p,
text:b.tooltip,position:["above","below","right","left"]}));c&&e.appendKeyBindingString(p,c);a.appendChild(s);d&&(v[b.id]={keyBinding:d,command:b,invocation:h});return p},executeBinding:l,setKeyBindingProvider:function(a){u=a},localKeyBindings:v,getKeyBindings:a,processKey:q,NO_IMAGE:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAAtJREFUCNdjIBEAAAAwAAFletZ8AAAAAElFTkSuQmCC",_testMethodProcessKey:b}});
define("orion/explorers/navigationUtils",[],function(){function k(e,c,g,d){!m&&e&&(e.push({domNode:c}),c.style.outline="none")}var m=-1!==navigator.userAgent.indexOf("iPad");return{addNavGrid:function(e,c,g){e&&(e=e.getGridNavHolder(c,!0))&&k(e,g)},generateNavGrid:k,removeNavGrid:function(e,c){if(e)for(var g=0;g<e.length;g++)if(e[g].domNode===c){e.splice(g,1);break}}}});
define("orion/PageUtil",[],function(){var k=/^http[s]?/i;return{hash:function(){var k=window.location.href.split("#")[1];return k?"#"+k:""},matchResourceParameters:function(k){k=k||window.location.toString();var e={resource:""},c=k.indexOf("#");if(-1!==c&&(k=k.substring(c+1),0!==k.length)){k=k.split(",");e.resource=decodeURIComponent(k[0]);for(c=1;c<k.length;c++){var g=/([^=]*)(=?)(.*)/.exec(k[c]),d=decodeURIComponent(g[1]||""),g=decodeURIComponent(g[3]||"");""!==d&&"resource"!==d&&(e[d]=g)}}return e},
validateURLScheme:function(m,e){var c=m;if(-1===m.indexOf("://")){var g=document.createElement("a");g.href=m;c=g.href}g=!1;if(g=e?e.some(function(d){return RegExp("^"+d+":","i").test(c)}):k.test(c))return m;console.log("Illegal URL Scheme: '"+m+"'");return""}}});
(function(){function k(c,d,f,n,l,b){d[c]&&(f.push(c),(!0===d[c]||1===d[c])&&n.push(l+c+"/"+b))}function m(c,d,f,n,l){d=n+d+"/"+l;require._fileExists(c.toUrl(d+".js"))&&f.push(d)}function e(c,d,f){for(var n in d)d.hasOwnProperty(n)&&(!c.hasOwnProperty(n)||f)?c[n]=d[n]:"object"===typeof d[n]&&(!c[n]&&d[n]&&(c[n]={}),e(c[n],d[n],f))}var c=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(g){var d=g.config?g.config():{};return{version:"2.0.4",load:function(f,g,l,b){b=b||{};b.locale&&
(d.locale=b.locale);var a=c.exec(f),q=a[1],h=a[4],p=a[5],r=h.split("-"),u=[],v={},w,t="";a[5]?(q=a[1],f=q+p):(p=a[4],h=d.locale,h||(h=d.locale="undefined"===typeof navigator?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),r=h.split("-"));if(b.isBuild){u.push(f);m(g,"root",u,q,p);for(w=0;w<r.length;w++)h=r[w],t+=(t?"-":"")+h,m(g,t,u,q,p);if(b.locales)for(a=0;a<b.locales.length;a++){h=b.locales[a];r=h.split("-");t="";for(f=0;f<r.length;f++)h=r[f],t+=(t?"-":"")+h,m(g,t,u,q,
p)}g(u,function(){l()})}else g([f],function(a){var b=[],h;k("root",a,b,u,q,p);for(w=0;w<r.length;w++)h=r[w],t+=(t?"-":"")+h,k(t,a,b,u,q,p);g(u,function(){var h,d,s;for(h=b.length-1;-1<h&&b[h];h--){s=b[h];d=a[s];if(!0===d||1===d)d=g(q+s+"/"+p);e(v,d)}l(v)})})}}})})();define("orion/nls/messages",{root:!0});
define("orion/nls/root/messages",{Navigator:"Navigator",Sites:"Sites",Shell:"Shell",ShellLinkWorkspace:"Shell","Get Plugins":"Get Plugins",Global:"Global",Editor:"Editor",EditorRelatedLink:"Show Current Folder",EditorRelatedLinkParent:"Show Enclosing Folder",EditorLinkWorkspace:"Edit",EditorRelatedLinkProj:"Show Project","Filter bindings":"Filter bindings",orionClientLabel:"Orion client repository","Orion Editor":"Orion Editor","Orion Image Viewer":"Orion Image Viewer","Orion Markdown Editor":"Orion Markdown Editor",
"Orion Markdown Viewer":"Orion Markdown Viewer","Orion JSON Editor":"Orion JSON Editor","View on Site":"View on Site","View this file or folder on a web site hosted by Orion":"View this file or folder on a web site hosted by Orion.",ShowAllKeyBindings:"Show a list of all the keybindings on this page","Show Keys":"Show Keys",HideShowBannerFooter:"Hide or show the page banner","Toggle banner and footer":"Toggle banner",ChooseFileOpenEditor:"Choose a file by name and open an editor on it",FindFile:"Find File Named...",
"System Configuration Details":"System Configuration Details","System Config Tooltip":"Go to the System Configuration Details page","Background Operations":"Background Operations","Background Operations Tooltip":"Go to the Background Operations page","Operation status is unknown":"Operation status is unknown","Unknown item":"Unknown item",NoSearchAvailableErr:"Can't search: no search service is available",Related:"Related",Options:"Options","LOG: ":"LOG: ",View:"View","no parent":"no parent","no tree model":"no tree model",
"no renderer":"no renderer","could not find table row ":"could not find table row ",Operations:"Operations","Operations running":"Operations running",SomeOpWarning:"Some operations finished with warning",SomeOpErr:"Some operations finished with error","no service registry":"no service registry",Tasks:"Tasks",Close:"Close","Expand all":"Expand all","Collapse all":"Collapse all",Search:"Search","Advanced search":"Advanced search",Submit:"Submit",More:"More","Recent searches":"Recent searches","Regular expression":"Regular expression",
"Search options":"Search options","Global search":"Global search","Orion Home":"Orion Home","Close notification":"Close notification",OpPressSpaceMsg:"Operations - Press spacebar to show current operations","Toggle side panel":"Toggle side panel","Open or close the side panel":"Open or close the side panel",Projects:"Projects","Toggle Sidebar":"Toggle Sidebar","Sample HTML5 Site":"Sample HTML5 Site","Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.":"Generate an HTML5 'Hello World' website, including JavaScript, HTML, and CSS files.",
"Sample Orion Plugin":"Sample Orion Plugin","Generate a sample plugin for integrating with Orion.":"Generate a sample plugin for integrating with Orion.",Browser:"Web Browser",OutlineProgress:"Getting outline for ${0} from ${1}",outlineTimeout:"Outline service timed out. Try reloading the page and opening the outline again.",UnknownError:"An unknown error occurred.",Filter:"Filter (* \x3d any string, ? \x3d any character)",TemplateExplorerLabel:"Templates",OpenTemplateExplorer:"Open Template Explorer",
Edit:"Edit",CentralNavTooltip:"Toggle Navigation Menu","Wrote: ${0}":"Wrote: ${0}",GenerateHTML:"Generate HTML file",GenerateHTMLTooltip:"Write an HTML file generated from the current Markdown editor content","alt text":"alt text",blockquote:"blockquote",code:"code","code (block)":"code (block)","code (span)":"code (span)",emphasis:"emphasis","fenced code (${0})":"fenced code (${0})","header (${0})":"header (${0})","horizontal rule":"horizontal rule",label:"label","link (auto)":"link (auto)","link (image)":"link (image)",
"link (inline)":"link (inline)","link label":"link label","link label (optional)":"link label (optional)","link (ref)":"link (ref)","list item (bullet)":"list item (bullet)","list item (numbered)":"list item (numbered)","strikethrough (${0})":"strikethrough (${0})",strong:"strong","table (${0})":"table (${0})",text:"text","title (optional)":"title (optional)",url:"url",TogglePaneOrientationTooltip:"Toggle split pane orientation",WarningDuplicateLinkId:"Duplicate link ID: ${0} (link IDs are not case-sensitive)",
WarningHeaderTooDeep:"Header level cannot exceed 6",WarningLinkHasNoText:"Link has no text",WarningLinkHasNoURL:"Link has no URL",WarningOrderedListItem:"Ordered list item within unordered list",WarningOrderedListShouldStartAt1:"The first item in an ordered list should have index 1",WarningUndefinedLinkId:"Undefined link ID: ${0}",WarningUnorderedListItem:"Unordered list item within ordered list",PageTitleFormat:"${0} - ${1}",KeyCTRL:"Ctrl",KeySHIFT:"Shift",KeyALT:"Alt",KeyBKSPC:"Backspace",KeyDEL:"Del",
KeyEND:"End",KeyENTER:"Enter",KeyESCAPE:"Esc",KeyHOME:"Home",KeyINSERT:"Ins",KeyPAGEDOWN:"Page Down",KeyPAGEUP:"Page Up",KeySPACE:"Space",KeyTAB:"Tab","a year":"a year",years:"${0} years","a month":"a month",months:"${0} months","a day":"a day",days:"${0} days","an hour":"an hour",hours:"${0} hours","a minute":"a minute",minutes:"${0} minutes",timeAgo:"${0} ago",justNow:"just now"});
define("orion/i18nUtil",[],function(){return{formatMessage:function(k){var m=/\$\{([^\}]+)\}/g,e=arguments;return 2===e.length&&e[1]&&"object"===typeof e[1]?k.replace(m,function(c,g){return e[1][g]}):k.replace(m,function(c,g){return e[(g<<0)+1]})}}});
define("orion/uiUtils",["i18n!orion/nls/messages","orion/webui/littlelib","orion/i18nUtil"],function(k,m,e){function c(a){var d="";l?(a.mod4&&(d+="\u2303"),a.mod3&&(d+="\u2325"),a.mod2&&(d+="\u21e7"),a.mod1&&(d+="\u2318")):(a.mod1&&(d+=k.KeyCTRL+"+"),a.mod2&&(d+=k.KeySHIFT+"+"),a.mod3&&(d+=k.KeyALT+"+"));if(a.alphaKey)return d+a.alphaKey;if("keypress"===a.type)return d+a.keyCode;var h=a.keyCode,c=b[h];if(c)return d+c;if(h=m.keyName(h))return h=k["Key"+h]||h,d+h;var r;switch(a.keyCode){case 59:r=a.mod2?
":":";";break;case 61:r=a.mod2?"+":"\x3d";break;case 188:r=a.mod2?"\x3c":",";break;case 190:r=a.mod2?"\x3e":".";break;case 191:r=a.mod2?"?":"/";break;case 192:r=a.mod2?"~":"`";break;case 219:r=a.mod2?"{":"[";break;case 220:r=a.mod2?"|":"\\";break;case 221:r=a.mod2?"}":"]";break;case 222:r=a.mod2?'"':"'"}return r?d+r:112<=a.keyCode&&123>=a.keyCode?d+"F"+(a.keyCode-111):d+String.fromCharCode(a.keyCode)}function g(a){var b=-1!==window.navigator.platform.indexOf("Mac");return b&&a.metaKey||!b&&a.ctrlKey}
function d(a,b){if(!a||!a.tagName)return!1;switch(a.tagName.toLowerCase()){case "button":case "fieldset":case "form":case "input":case "keygen":case "label":case "legend":case "meter":case "optgroup":case "output":case "progress":case "select":case "textarea":return!0}return a.parentNode===b?!1:a.parentNode&&d(a.parentNode,b)}function f(a,b,h){return 0<a?1===a?k[b]:e.formatMessage(k[h],a):""}function n(a){a=new Date(a);var b=(new Date).getTime()-a.getTime();a=Math.floor(b/1E3/60/60/24/365);var b=
b-31536E6*a,h=Math.floor(b/1E3/60/60/24/30),b=b-2592E6*h,d=Math.floor(b/1E3/60/60/24),b=b-864E5*d,r=Math.floor(b/1E3/60/60),c=Math.floor((b-36E5*r)/1E3/60),b=f(a,"a year","years"),g=f(h,"a month","months"),l=f(d,"a day","days"),e=f(r,"an hour","hours"),c=f(c,"a minute","minutes"),n="";b?n=0<a?b:b+g:g?n=0<h?g:g+l:l?n=0<d?l:l+e:e?n=0<r?e:e+c:c&&(n=c);return n}var l=-1!==navigator.platform.indexOf("Mac"),b=Object.create(null);b[m.KEY.DOWN]="\u2193";b[m.KEY.UP]="\u2191";b[m.KEY.RIGHT]="\u2192";b[m.KEY.LEFT]=
"\u2190";l&&(b[m.KEY.BKSPC]="\u232b",b[m.KEY.DEL]="\u2326",b[m.KEY.END]="\u21f2",b[m.KEY.ENTER]="\u23ce",b[m.KEY.ESCAPE]="\u238b",b[m.KEY.HOME]="\u21f1",b[m.KEY.PAGEDOWN]="\u21df",b[m.KEY.PAGEUP]="\u21de",b[m.KEY.SPACE]="\u2423",b[m.KEY.TAB]="\u21e5");return{getUserKeyString:function(a){var b="";a=a.getKeys();for(var h=0;h<a.length;h++)0!==h&&(b+=" "),b+=c(a[h]);return b},getUserText:function(a){var b=a.id,h=a.refNode,d=a.hideRefNode,r=a.initialText,c=a.onComplete,f=a.onEditDestroy,g=a.selectTo,l=
a.isInitialValid;a=a.insertAsChild;var n=!1,e=function(a){return function(g){if(!n){var s=m.node(b),x=s.value;s&&(a&&g.keyCode===m.KEY.ESCAPE?(d&&(h.style.display="inline"),n=!0,s.parentNode.removeChild(s),f&&f()):a&&g.keyCode!==m.KEY.ENTER||(0===x.length||!l&&x===r?d&&(h.style.display="inline"):(c(x),d&&h.parentNode&&(h.style.display="inline")),n=!0,s.parentNode&&s.parentNode.removeChild(s),f&&f()))}}},k=document.createElement("input");k.id=b;k.value=r||"";a?h.appendChild(k):h.parentNode.insertBefore(k,
h.nextSibling);k.classList.add("userEditBoxPrompt");d&&(h.style.display="none");k.addEventListener("keydown",e(!0),!1);k.addEventListener("blur",e(!1),!1);window.setTimeout(function(){k.focus();if(r){var a=m.node(b),h=g?r.indexOf(g):-1;0<h?a.createTextRange?(a=a.createTextRange(),a.collapse(!0),a.moveStart("character",0),a.moveEnd("character",h),a.select()):a.setSelectionRange?a.setSelectionRange(0,h):void 0!==a.selectionStart&&(a.selectionStart=0,a.selectionEnd=h):a.select()}},0)},openInNewWindow:g,
followLink:function(a,b){b&&g(b)?window.open(a):window.location=a},createButton:function(a,b){var h=document.createElement("button");h.className="orionButton commandButton commandMargins";h.addEventListener("click",function(a){b();m.stop(a)},!1);a&&h.appendChild(document.createTextNode(a));return h},createDropdownButton:function(a,b,h){},isFormElement:d,path2FolderName:function(a,b,h){return a.substring(0,a.length-encodeURIComponent(b).length-(h?0:1))},timeElapsed:n,displayableTimeElapsed:function(a){return(a=
n(a))?e.formatMessage(k.timeAgo,a):k.justNow}}});define("text!orion/webui/submenutriggerbutton.html",[],function(){return'\x3cli class\x3d"dropdownSubMenu"\x3e\x3cspan class\x3d"dropdownTrigger dropdownMenuItem" role\x3d"menuitem" tabindex\x3d"0"\x3e\x3cspan class\x3d"dropdownCommandName"\x3e${ButtonText}\x3c/span\x3e\x3cspan class\x3d"dropdownArrowRight core-sprite-closedarrow"\x3e\x3c/span\x3e\x3c/span\x3e\x3cul class\x3d"dropdownMenu"\x3e\x3c/ul\x3e\x3c/li\x3e'});
define("orion/commandRegistry","orion/commands orion/explorers/navigationUtils orion/PageUtil orion/uiUtils orion/webui/littlelib orion/webui/dropdown orion/webui/tooltip text!orion/webui/submenutriggerbutton.html orion/metrics".split(" "),function(k,m,e,c,g,d,f,n,l){function b(a){this._commandList={};this._contributionsByScopeId={};this._activeBindings={};this._urlBindings={};this._pendingBindings={};this._init(a||{});this._parameterCollector=null}function a(a,b){this.token=a;this.parameterName=
b}function q(a,b,h){this.event=a;this.handler=b;this.capture=h||!1}function h(a,b,h,d,c,p,q){this.name=a;this.type=b;this.label=h;this.value=d;this.lines=c||1;this.validator=q;this.eventListeners=Array.isArray(p)?p:p?[p]:[]}function p(a,b,h){this._storeParameters(a);this._hasOptionalParameters=b&&b.hasOptionalParameters;this._options=b;this.optionsRequested=!1;this.getParameters=h;this.clientCollect=b&&b.clientCollect;this.getParameterElement=b&&b.getParameterElement;this.getSubmitName=b&&b.getSubmitName;
this.getCancelName=b&&b.getCancelName;this.message=b&&b.message}b.prototype={_init:function(a){this._selectionService=a.selection;var b=this;k.setKeyBindingProvider(function(){return b._activeBindings})},processURL:function(a){for(var b in this._urlBindings)if(this._urlBindings[b]&&this._urlBindings[b].urlBinding&&this._urlBindings[b].command){var h=this._urlBindings[b].urlBinding.match(a);if(h){var d=this._urlBindings[b],c=d.command,p=d.invocation;if(p&&p.parameters&&c.callback){p.parameters.setValue(h.parameterName,
h.parameterValue);var q=this;window.setTimeout(function(){q._invoke(p)},0);break}}}},findCommand:function(a){return this._commandList[a]},runCommand:function(a,b,h,d,c,p){if(b){if((a=this._commandList[a])&&(a.visibleWhen?a.visibleWhen(b):1)&&a.callback)return b=new k.CommandInvocation(h,b,c,a,this),b.domParent=p,this._invoke(b,d)}else if((p=this._urlBindings[a])&&p.command&&p.command.callback)return this._invoke(p.invocation,d)},getSelectionService:function(){return this._selectionService},setParameterCollector:function(a){this._parameterCollector=
a},openParameterCollector:function(a,b,h){this._parameterCollector&&(this._parameterCollector.close(),this._parameterCollector.open(a,b,h))},confirm:function(a,b,h,d,c,p){var q=!1;if(this._parameterCollector&&!c){var g=this,l=function(){g._parameterCollector.close()};c=function(s,a){var x=document.createElement("span");x.classList.add("parameterPrompt");x.textContent=b;s.appendChild(x);x=document.createElement("button");x.addEventListener("click",function(s){q=!0;p(q);l()},!1);a.appendChild(x);x.appendChild(document.createTextNode(h));
x.className="dismissButton";var y=document.createElement("button");y.addEventListener("click",function(s){q=!1;l()},!1);a.appendChild(y);y.appendChild(document.createTextNode(d));y.className="dismissButton";return x};this._parameterCollector.close();if(!this._parameterCollector.open(a,c,function(){})){var n=new f.Tooltip({node:a,afterHiding:function(){this.destroy()},trigger:"click",position:["below","right","above","left"]});a=n.contentContainer();a.classList.add("parameterPopup");var s=window.document.activeElement,
l=function(){s&&s.focus();n.destroy()},x=document.createElement("div");x.classList.add("parameterMessage");a.appendChild(x);var y=document.createElement("div");a.appendChild(y);y.classList.add("layoutRight");y.classList.add("parametersDismiss");var D=c(x,y);n.show();D&&window.setTimeout(function(){D.focus();D.select&&D.select()},0)}}else q=window.confirm(b),p(q)},closeParameterCollector:function(){this._parameterCollector&&this._parameterCollector.close()},collectsParameters:function(){return this._parameterCollector},
_invoke:function(a,b){return this._collectAndInvoke(a.makeCopy(b),!1)},_collectAndInvoke:function(a,b,h){if(a)if(this._parameterCollector&&a.parameters&&a.parameters.hasParameters()&&(b||a.parameters.shouldCollectParameters())){b=!1;a.parameters.updateParameters(a);if(a.parameters.shouldCollectParameters()&&(b=this._parameterCollector.collectParameters(a,h),!b)){var d=new f.Tooltip({node:a.domNode||a.domParent,afterHiding:function(){this.destroy()},trigger:"click",position:["below","right","above",
"left"]});b=d.contentContainer();b.classList.add("parameterPopup");var c=window.document.activeElement,p=this._parameterCollector.getFillFunction(a,function(){c&&c.focus();d.destroy()},h)(b);d.show();p&&window.setTimeout(function(){p.focus();p.select&&p.select()},0);b=!0}if(!b)return l.logEvent("command","invoke",a.command.id),a.command.callback.call(a.handler||window,a)}else return l.logEvent("command","invoke",a.command.id),a.command.callback.call(a.handler||window,a);else window.console.log("Client attempted to invoke command without an available (rendered) command invocation")},
collectParameters:function(a,b){this._collectAndInvoke(a,!0,b)},showKeyBindings:function(a){function b(a){return function(){k.executeBinding(a)}}var h={},d,p,q=[],f;for(f in this._activeBindings)(p=this._activeBindings[f])&&(p.keyBinding&&p.command&&(p.command.name||p.command.tooltip))&&q.push(p);q.sort(function(a,b){return(a.command.name||a.command.tooltip).localeCompare(b.command.name||b.command.tooltip)});for(f=0;f<q.length;f++)p=q[f],p.keyBinding.scopeName?(h[p.keyBinding.scopeName]||(h[p.keyBinding.scopeName]=
[]),h[p.keyBinding.scopeName].push(p)):(d=c.getUserKeyString(p.keyBinding),a.createItem(d,p.command.name||p.command.tooltip,b(p)));for(var g in h)h[g].length&&0<h[g].length&&(a.createHeader(g),h[g].forEach(function(h){d=c.getUserKeyString(h.keyBinding);a.createItem(d,h.command.name||h.command.tooltip,b(h))}))},addCommand:function(a){this._commandList[a.id]=a;var b=this._pendingBindings[a.id];if(b){var h=this;b.forEach(function(b){h._addBinding(a,b.type,b.binding,b.bindingOnly)});delete this._pendingBindings[a.id]}},
addCommandGroup:function(a,b,h,d,c,p,q,f,g,l,s){this._contributionsByScopeId[a]||(this._contributionsByScopeId[a]={});a=this._contributionsByScopeId[a];c&&(a=this._createEntryForPath(a,c));a[b]?(d&&(a[b].title=d),h&&(a[b].position=h),q&&(a[b].imageClass=q),f&&(a[b].tooltip=f),g&&(a[b].selectionClass=g),s&&(a[b].extraClass=s),!0===l?a[b].pretendDefaultActionId=!0:a[b].defaultActionId=l,a[b].emptyGroupMessage=p):(a[b]={title:d,position:h,emptyGroupMessage:p,imageClass:q,tooltip:f,selectionClass:g,defaultActionId:!0===
l?null:l,pretendDefaultActionId:!0===l,children:{},extraClasses:s},a.sortedContributions=null)},_createEntryForPath:function(a,b){b&&b.split("/").forEach(function(b){1<b.length&&(a[b]||(a[b]={position:0,children:{}},a.sortedContributions=null),a=a[b].children)});return a},registerSelectionService:function(a,b){this._contributionsByScopeId[a]||(this._contributionsByScopeId[a]={});this._contributionsByScopeId[a].localSelectionService=b},registerCommandContribution:function(a,b,h,d,c,p,q,f){this._contributionsByScopeId[a]||
(this._contributionsByScopeId[a]={});a=this._contributionsByScopeId[a];d&&(a=this._createEntryForPath(a,d));a[b]={position:h,handler:f};p&&((h=this._commandList[b])?this._addBinding(h,"key",p,c):this._addPendingBinding(b,"key",p,c));q&&((h=this._commandList[b])?this._addBinding(h,"url",q,c):this._addPendingBinding(b,"url",q,c));a.sortedContributions=null},unregisterCommandContribution:function(a,b,h){if(this._contributionsByScopeId[a]){delete this._commandList[b];delete this._activeBindings[b];delete this._urlBindings[b];
delete this._pendingBindings[b];var d=this._contributionsByScopeId[a];h&&h.split("/").forEach(function(a){1<a.length&&d[a]&&(d=d[a].children)});delete d[b];d.sortedContributions=null}},_addBinding:function(a,b,h,d){if(!a.id)throw Error("No command id: "+a);"key"===b?this._activeBindings[a.id]={command:a,keyBinding:h,bindingOnly:d}:"url"===b&&(this._urlBindings[a.id]={command:a,urlBinding:h,bindingOnly:d})},_addPendingBinding:function(a,b,h,d){this._pendingBindings[a]=this._pendingBindings[a]||[];
this._pendingBindings[a].push({type:b,binding:h,bindingOnly:d})},_checkForTrailingSeparator:function(a,b,h){var d;if("tool"===b||"button"===b)if((d=0<a.childNodes.length?a.childNodes[a.childNodes.length-1]:null)&&d.classList.contains("commandSeparator"))return h?(a.removeChild(d),!1):!0;if("menu"===b&&(a=g.$$array("li \x3e *",a),0<a.length&&a[a.length-1].classList.contains("dropdownSeparator")))if(d=a[a.length-1],h)d.parentNode.parentNode.removeChild(d.parentNode);else return!0;return!1},renderCommands:function(a,
b,h,d,c,p,q){if("string"!==typeof a)throw"a scope id for rendering must be specified";b=g.node(b);if(!b)throw"no parent";var f=this._contributionsByScopeId[a];if(!h&&f){h=f.localSelectionService||this._selectionService;var l=this;h&&h.getSelections(function(h){l.renderCommands(a,b,h,d,c,p)})}else f&&(this._render(f,b,h,d,c||"button",p,q),this._checkForTrailingSeparator(b,c,!0))},destroy:function(a){a=g.node(a);if(!a)throw"no parent";for(;a.hasChildNodes();){var b=a.firstChild;b.commandTooltip&&b.commandTooltip.destroy();
b.emptyGroupTooltip&&b.emptyGroupTooltip.destroy();this.destroy(b);a.removeChild(b)}},_render:function(a,b,h,d,p,q,g,l){l=a.sortedContributions;if(!l){l=[];var n=!1,e;for(e in a)if(Object.prototype.hasOwnProperty.call(a,e)){var s=a[e];s&&"number"===typeof s.position&&(s.id=e,l.push(s),n=!0)}n&&(l.sort(function(s,a){return s.position-a.position}),a.sortedContributions=l)}var x=0,y=this;l.forEach(function(s){var a,r;s.imageClass||(s.imageClass=null);if(s.children&&0<Object.getOwnPropertyNames(s.children).length)if(a=
s.children,"tool"===p||"button"===p)if(s.title){var l;s.defaultActionId&&(s.pretendDefaultActionId=!0===s.defaultActionId,(a=y._commandList[s.defaultActionId])&&(a.visibleWhen?a.visibleWhen(h):1)?(l=new k.CommandInvocation(d,h,q,a,y),l.domParent=b):s.pretendDefaultActionId=!0);a=y._createDropdownMenu(b,s.title,null,null,s.imageClass,s.tooltip,s.selectionClass,null,l,s.pretendDefaultActionId,s.extraClasses);g&&m.generateNavGrid(g,a.menuButton);a&&(y._render(s.children,a.menu,h,d,"menu",q,g),y._checkForTrailingSeparator(a.menu,
"menu",!0),0===a.menu.childNodes.length?s.emptyGroupMessage?a.menuButton.emptyGroupTooltip||(a.menuButton.emptyGroupTooltip=new f.Tooltip({node:a.menuButton,text:s.emptyGroupMessage,trigger:"click",position:["below","right","above","left"]})):(g&&m.removeNavGrid(g,a.menuButton),s=function(s){s&&s.parentNode&&s.parentNode.removeChild(s)},s(a.menu),s(a.menuButton),s(a.destroyButton)):a.menuButton.style.visibility="visible")}else{var n;0<b.childNodes.length&&!y._checkForTrailingSeparator(b,p)&&(n=y.generateSeparatorImage(b));
y._render(a,b,h,d,p,q,g);0<b.childNodes.length&&b.childNodes[b.childNodes.length-1]!==n&&(n=y.generateSeparatorImage(b))}else if(s.title){if(s=y._createDropdownMenu(b,s.title,!0,null,null,s.imageClass))y._render(a,s.menu,h,d,"menu",q,g),y._checkForTrailingSeparator(s.menu,"menu",!0),0===s.menu.childNodes.length&&s.destroyButton&&b.removeChild(s.destroyButton)}else 0<b.childNodes.length&&y._generateMenuSeparator(b),y._render(a,b,h,d,p,q,g),0<b.childNodes.length&&y._generateMenuSeparator(b);else{var e=
y._commandList[s.id];l=e?!0:!1;n=a=null;if(e){r=new k.CommandInvocation(s.handler||d,h,q,e,y);r.domParent=b;s=!1;try{s=l&&(e.visibleWhen?e.visibleWhen(h,r):!0)}catch(G){throw console.log(G),G;}y._activeBindings[e.id]&&y._activeBindings[e.id].keyBinding&&(a=y._activeBindings[e.id],a.invocation=s?r:null,a.bindingOnly&&(l=!1));y._urlBindings[e.id]&&y._urlBindings[e.id].urlBinding&&(n=y._urlBindings[e.id],n.invocation=s?r:null,n.bindingOnly&&(l=!1));l=l&&s}l&&(e.choiceCallback?("tool"===p||"button"===
p?(s=b,a=!1,"ul"===b.nodeName.toLowerCase()&&(s=document.createElement("li"),b.appendChild(s))):(s=b,a=!0),y._createDropdownMenu(s,e.name,a,function(s){e.populateChoicesMenu(s,h,d,q,y)}.bind(e),e.imageClass,e.tooltip||e.title,e.selectionClass,e.positioningNode)):(r.handler=r.handler||this,r.domParent=b,s=function(s){y._invoke(r)},"menu"===p?(l=null,a&&a.keyBinding&&(l=c.getUserKeyString(a.keyBinding)),s=k.createCommandMenuItem(b,e,r,null,s,l)):"quickfix"===p?(a=p+e.id+x,l=document.createElement("div"),
b.appendChild(l),s=k.createCommandItem(l,e,r,a,null,"button"===p,s)):(a=p+e.id+x,s=k.createCommandItem(b,e,r,a,null,"tool"===p,s)),m.generateNavGrid(g,s),r.domNode=s,x++))}})},_createDropdownMenu:function(a,b,h,c,p,q,l,e,m,B,s){a=g.node(a);if(!a||!g.contains(document.body,a))return null;var x,y,D=a;if(h)y=document.createRange(),y.selectNode(a),y=y.createContextualFragment(n),g.processTextNodes(y,{ButtonText:b}),a.appendChild(y),y=a.lastChild,p=y.lastChild,b=p.previousSibling,b.dropdown=new d.Dropdown({dropdown:p,
populate:c,parentDropdown:a.dropdown}),p.dropdown=b.dropdown;else{"ul"===a.nodeName.toLowerCase()&&(D=document.createElement("li"),a.appendChild(D),y=D);a=null;p&&(a="dropdownButtonWithIcon",q=q||b);q=p?q||b:q;var J=k.createDropdownMenu(D,b,c,a,p,!1,l,e,m||B,s);x=J.dropdownArrow;b=J.menuButton;if(x){m&&(m.domNode=J.menuButton);var F=this;b.onclick=function(s){var a=g.bounds(x);(s.clientX>=a.left||!0===B)&&J.dropdown?J.dropdown.toggle(s):F._invoke(m)};J.dropdown&&(b.onkeydown=function(s){g.KEY.DOWN===
s.keyCode&&(J.dropdown.toggle(s),g.stop(s))})}p=J.menu;if(c=m&&m.command&&(m.command.tooltip||m.command.name)?m.command.tooltip||m.command.name:q)b.commandTooltip=new f.Tooltip({node:b,text:c,position:["above","below","right","left"]})}return{menuButton:b,menu:p,dropdown:b.dropdown,destroyButton:y,dropdownArrow:x}},_generateMenuSeparator:function(a){if(!this._checkForTrailingSeparator(a,"menu")){var b=document.createElement("li");b.classList.add("dropdownSeparator");var h=document.createElement("span");
h.classList.add("dropdownSeparator");b.appendChild(h);a.appendChild(b)}},generateSeparatorImage:function(a){var b;b="ul"===a.nodeName.toLowerCase()?document.createElement("li"):document.createElement("span");a.appendChild(b);b.classList.add("core-sprite-sep");b.classList.add("imageSprite");b.classList.add("commandSeparator");return b}};b.prototype.constructor=b;a.prototype={match:function(a){a=e.matchResourceParameters(a);return"undefined"!==typeof a[this.token]?(this.parameterValue=a[this.token],
this):null}};a.prototype.constructor=a;q.prototype.constructor=q;h.prototype={optionsRequested:function(){return this.optionsRequested}};h.prototype.constructor=h;p.prototype={_storeParameters:function(a){this.parameterTable=null;if(a){var b=this.parameterTable={};a.forEach(function(a){b[a.name]=a})}},updateParameters:function(a){"function"===typeof this.getParameters&&this._storeParameters(this.getParameters(a))},hasParameters:function(){return null!==this.parameterTable},shouldCollectParameters:function(){return!this.clientCollect&&
this.hasParameters()},parameterNamed:function(a){return this.parameterTable[a]},valueFor:function(a){return(a=this.parameterTable[a])?a.value:null},setValue:function(a,b){var h=this.parameterTable[a];h&&(h.value=b)},forEach:function(a){for(var b in this.parameterTable)this.parameterTable[b].type&&this.parameterTable[b].name&&a(this.parameterTable[b])},validate:function(a,b){var h=this.parameterTable[a];return h&&h.validator?h.validator(b):!0},makeCopy:function(){var a=[];this.forEach(function(b){b=
new h(b.name,b.type,b.label,b.value,b.lines,b.eventListeners,b.validator);a.push(b)});var b=new p(a,this._options,this.getParameters);b.clientCollect=this.clientCollect;b.message=this.message;return b},hasOptionalParameters:function(){return this._hasOptionalParameters}};p.prototype.constructor=p;return{CommandRegistry:b,URLBinding:a,ParametersDescription:p,CommandParameter:h,CommandEventListener:q}});
(function(k,m){"function"===typeof define&&define.amd?define("orion/Deferred",m):"object"===typeof exports?module.exports=m():(k.orion=k.orion||{},k.orion.Deferred=m())})(this,function(){function k(){for(var c;c=g.shift();)c();d=!1}function m(c){g.push(c);d||(d=!0,f())}function e(d){return function(c){d(c)}}function c(){function d(){for(var a;a=p.shift();){var b=a.deferred,c="fulfilled"===h?"resolve":"reject";a=a[c];if("function"===typeof a)try{var r=a(q),f=r&&("object"===typeof r||"function"===typeof r)&&
r.then;if("function"===typeof f)if(r===b.promise)b.reject(new TypeError);else{var g=r.cancel;"function"===typeof g?b._parentCancel=g.bind(r):delete b._parentCancel;f.call(r,e(b.resolve),e(b.reject),e(b.progress))}else b.resolve(r)}catch(l){b.reject(l)}else b[c](q)}}function f(a){delete r._parentCancel;h="rejected";q=a;p.length&&m(d)}function b(a){function g(a){return function(b){(!h||"assumed"===h)&&a(b)}}delete r._parentCancel;try{var e=a&&("object"===typeof a||"function"===typeof a)&&a.then;if("function"===
typeof e)if(a===r)f(new TypeError);else{h="assumed";var t=a&&a.cancel;if("function"!==typeof t){var k=new c;a=k.promise;try{e(k.resolve,k.reject,k.progress)}catch(z){k.reject(z)}t=a.cancel;e=a.then}q=a;e.call(a,g(b),g(f));r._parentCancel=t.bind(a)}else h="fulfilled",q=a,p.length&&m(d)}catch(C){g(f)(C)}}function a(){var a=r._parentCancel;a?(delete r._parentCancel,a()):h||(a=Error("Cancel"),a.name="Cancel",f(a))}var q,h,p=[],r=this;this.resolve=function(a){h||b(a);return r};this.reject=function(a){h||
f(a);return r};this.progress=function(a){h||p.forEach(function(b){if(b.progress)try{b.progress(a)}catch(h){}});return r.promise};this.cancel=function(){r._parentCancel?setTimeout(a,0):a();return r};this.then=function(a,b,q){var f=new c;f._parentCancel=r.promise.cancel;p.push({resolve:a,reject:b,progress:q,deferred:f});("fulfilled"===h||"rejected"===h)&&m(d);return f.promise};this.promise={then:r.then,cancel:r.cancel}}var g=[],d=!1,f=function(){if("undefined"!==typeof process&&"function"===typeof process.nextTick){var d=
process.nextTick;return function(){d(k)}}if("function"===typeof MutationObserver){var c=document.createElement("div");(new MutationObserver(k)).observe(c,{attributes:!0});return function(){c.setAttribute("class","_tick")}}return function(){setTimeout(k,0)}}();c.all=function(d,f){function b(a,b){p||(h[a]=b,0===--q&&r.resolve(h))}function a(a,h){if(!p){if(f)try{b(a,f(h));return}catch(d){h=d}r.reject(h)}}var q=d.length,h=[],p=!1,r=new c;r.then(void 0,function(){p=!0;d.forEach(function(a){a.cancel&&a.cancel()})});
0===q?r.resolve(h):d.forEach(function(h,d){h.then(b.bind(void 0,d),a.bind(void 0,d))});return r.promise};c.when=function(d,f,b,a){var q;d&&"function"===typeof d.then||(q=new c,q.resolve(d),d=q.promise);return d.then(f,b,a)};return c});define("orion/editor/nls/messages",{root:!0});
define("orion/editor/nls/root/messages",{multipleAnnotations:"Multiple annotations:",line:"Line: ${0}",breakpoint:"Breakpoint",bookmark:"Bookmark",task:"Task",error:"Error",warning:"Warning",currentSearch:"Current Search",currentLine:"Current Line",matchingBracket:"Matching Bracket",currentBracket:"Current Bracket",diffAdded:"Diff Added Lines",diffDeleted:"Diff Deleted Lines",diffModified:"Diff Modified Lines",lineUp:"Line Up",lineDown:"Line Down",lineStart:"Line Start",lineEnd:"Line End",charPrevious:"Previous Character",
charNext:"Next Character",pageUp:"Page Up",pageDown:"Page Down",scrollPageUp:"Scroll Page Up",scrollPageDown:"Scroll Page Down",scrollLineUp:"Scroll Line Up",scrollLineDown:"Scroll Line Down",wordPrevious:"Previous Word",wordNext:"Next Word",textStart:"Document Start",textEnd:"Document End",scrollTextStart:"Scroll Document Start",scrollTextEnd:"Scroll Document End",centerLine:"Center Line",selectLineUp:"Select Line Up",selectLineDown:"Select Line Down",selectWholeLineUp:" Select Whole Line Up",selectWholeLineDown:"Select Whole Line Down",
selectLineStart:"Select Line Start",selectLineEnd:"Select Line End",selectCharPrevious:"Select Previous Character",selectCharNext:"Select Next Character",selectPageUp:"Select Page Up",selectPageDown:"Select Page Down",selectWordPrevious:"Select Previous Word",selectWordNext:"Select Next Word",selectTextStart:"Select Document Start",selectTextEnd:"Select Document End",deletePrevious:"Delete Previous Character",deleteNext:"Delete Next Character",deleteWordPrevious:"Delete Previous Word",deleteWordNext:"Delete Next Word",
deleteLineStart:"Delete Line Start",deleteLineEnd:"Delete Line End",tab:"Insert Tab",enter:"Insert Line Delimiter",enterNoCursor:"Insert Line Delimiter",escape:"Escape",selectAll:"Select All",copy:"Copy",cut:"Cut",paste:"Paste",uppercase:"To Upper Case",lowercase:"To Lower Case",capitalize:"Capitalize",reversecase:"Reverse Case",toggleWrapMode:"Toggle Wrap Mode",toggleTabMode:"Toggle Tab Mode",toggleOverwriteMode:"Toggle Overwrite Mode",committerOnTime:"${0} on ${1}",emacs:"Emacs",exchangeMarkPoint:"Exchange Mark and Point",
setMarkCommand:"Set Mark",clearMark:"Clear Mark",digitArgument:"Digit Argument ${0}",negativeArgument:"Negative Argument",Comment:"Comment","Flat outline":"Flat outline",incrementalFindStr:"Incremental find: ${0}",incrementalFindStrNotFound:"Incremental find: ${0} (not found)",incrementalFindReverseStr:"Reverse Incremental find: ${0}",incrementalFindReverseStrNotFound:"Reverse Incremental find: ${0} (not found)",find:"Find...",undo:"Undo",redo:"Redo",cancelMode:"Cancel Current Mode",findNext:"Find Next Occurrence",
findPrevious:"Find Previous Occurrence",incrementalFind:"Incremental Find",incrementalFindReverse:"Incremental Find Reverse",indentLines:"Indent Lines",unindentLines:"Unindent Lines",moveLinesUp:"Move Lines Up",moveLinesDown:"Move Lines Down",copyLinesUp:"Copy Lines Up",copyLinesDown:"Copy Lines Down",deleteLines:"Delete Lines",gotoLine:"Goto Line...",gotoLinePrompty:"Goto Line:",nextAnnotation:"Next Annotation",prevAnnotation:"Previous Annotation",expand:"Expand",collapse:"Collapse",expandAll:"Expand All",
collapseAll:"Collapse All",lastEdit:"Last Edit Location",trimTrailingWhitespaces:"Trim Trailing Whitespaces",toggleLineComment:"Toggle Line Comment",addBlockComment:"Add Block Comment",removeBlockComment:"Remove Block Comment",linkedModeEntered:"Linked Mode: Enter or ESC to exit",linkedModeExited:"Linked Mode exited",syntaxError:"Syntax Error",contentAssist:"Content Assist",lineColumn:"Line ${0} : Column ${1}",multiSelections:"${0} selection regions",vi:"vi",vimove:"(Move)",viyank:"(Yank)",videlete:"(Delete)",
vichange:"(Change)",viLeft:"${0} Left",viRight:"${0} Right",viUp:"${0} Up",viDown:"${0} Down",viw:"${0} Next Word",vib:"${0} Beginning of Word",viW:"${0} Next Word (ws stop)",viB:"${0} Beginning of Word (ws stop)",vie:"${0} End of Word",viE:"${0} End of Word (ws stop)",vi$:"${0} End of the line","vi^_":"${0} First non-blank Char Current Line","vi+":"${0} First Char Next Line","vi-":"${0} First Char Previous Line","vi|":"${0} nth Column in Line",viH:"${0} Top of Page",viM:"${0} Middle of Page",viL:"${0} Bottom of Page",
"vi/":"${0} Search Forward","vi?":"${0} Search Backward",vin:"${0} Next Search",viN:"${0} Previous Search",vif:"${0} Search Char Fwd",viF:"${0} Search Char Bckwd",vit:"${0} Search Before Char Fwd",viT:"${0} Search Before Char Bckwd","vi,":"${0} Repeat Reverse Char Search","vi;":"${0} Repeat Char Search",viG:"${0} Go to Line",viycd:"${0} Current Line",via:"Append After Cursor",viA:"Append to End of Line",vii:"Insert Before Cursor",viI:"Insert at Beginning of Line",viO:"Insert Line Above",vio:"Insert Line Below",
viR:"Begin Overwriting Text",vis:"Substitute a Character",viS:"Substitute Entire Line",viC:"Change Text Until Line End",vip:"Paste After Char or Line",viP:"Paste Before Char or Line",viStar:"Search Word Under Cursor",next:"Next",previous:"Previous",replace:"Replace",replaceAll:"Replace All",findWith:"Find With",replaceWith:"Replace With",caseInsensitive:"Aa",regex:"/.*/",wholeWord:"\\b",caseInsensitiveTooltip:"Toggle Case Insensitive",regexTooltip:"Toggle Regex",wholeWordTooltip:"Toggle Whole Word",
closeTooltip:"Close",replacingAll:"Replacing all...",replacedMatches:"Replaced ${0} matches",nothingReplaced:"Nothing replaced",notFound:"Not found"});
define("orion/editor/eventTarget",[],function(){function k(){}k.addMixin=function(m){var e=k.prototype,c;for(c in e)e.hasOwnProperty(c)&&(m[c]=e[c])};k.prototype={addEventListener:function(k,e,c){this._eventTypes||(this._eventTypes={});var g=this._eventTypes[k];g||(g=this._eventTypes[k]={level:0,listeners:[]});g.listeners.push({listener:e,useCapture:c})},dispatchEvent:function(k){var e=k.type;this._dispatchEvent("pre"+e,k);this._dispatchEvent(e,k);this._dispatchEvent("post"+e,k)},_dispatchEvent:function(k,
e){var c=this._eventTypes?this._eventTypes[k]:null;if(c){var g=c.listeners;try{if(c.level++,g)for(var d=0,f=g.length;d<f;d++)if(g[d]){var n=g[d].listener;"function"===typeof n?n.call(this,e):n.handleEvent&&"function"===typeof n.handleEvent&&n.handleEvent(e)}}finally{if(c.level--,c.compact&&0===c.level){for(d=g.length-1;0<=d;d--)g[d]||g.splice(d,1);0===g.length&&delete this._eventTypes[k];c.compact=!1}}}},isListening:function(k){return!this._eventTypes?!1:void 0!==this._eventTypes[k]},removeEventListener:function(k,
e,c){if(this._eventTypes){var g=this._eventTypes[k];if(g){for(var d=g.listeners,f=0,n=d.length;f<n;f++){var l=d[f];if(l&&l.listener===e&&l.useCapture===c){0!==g.level?(d[f]=null,g.compact=!0):d.splice(f,1);break}}0===d.length&&delete this._eventTypes[k]}}}};return{EventTarget:k}});
define("orion/editor/annotations",["i18n!orion/editor/nls/messages","orion/editor/eventTarget"],function(k,m){function e(){}function c(a,b,h){this.start=a;this.end=b;this._projectionModel=h;this.html=this._expandedHTML;this.style=this._expandedStyle;this.expanded=!0}function g(a,b){var h=a.lastIndexOf("."),h=a.substring(h+1),d={title:k[h],style:{styleClass:"annotation "+h},html:"\x3cdiv class\x3d'annotationHTML "+h+"'\x3e\x3c/div\x3e",overviewStyle:{styleClass:"annotationOverview "+h}};b?d.lineStyle=
{styleClass:"annotationLine "+h}:d.rangeStyle={styleClass:"annotationRange "+h};e.registerType(a,d)}function d(){}function f(a,b,h,d,c){var f;void 0===d&&(d=-1);void 0===c&&(c=a.length);for(;1<c-d;)if(f=Math.floor((c+d)/2),b<=a[f].start)c=f;else if(h&&b<a[f].end){c=f;break}else d=f;return c}function n(a){this._annotations=[];var b=this;this._listener={onChanged:function(a){b._onChanged(a)}};this.setTextModel(a)}function l(a,b){this._view=a;this._annotationModel=b;var h=this;this._listener={onDestroy:function(a){h._onDestroy(a)},
onLineStyle:function(a){h._onLineStyle(a)},onChanged:function(a){h._onAnnotationModelChanged(a)}};a.addEventListener("Destroy",this._listener.onDestroy);a.addEventListener("postLineStyle",this._listener.onLineStyle);b.addEventListener("Changed",this._listener.onChanged)}c.prototype={_expandedHTML:"\x3cdiv class\x3d'annotationHTML expanded'\x3e\x3c/div\x3e",_expandedStyle:{styleClass:"annotation expanded"},_collapsedHTML:"\x3cdiv class\x3d'annotationHTML collapsed'\x3e\x3c/div\x3e",_collapsedStyle:{styleClass:"annotation collapsed"},
_collapse:function(){if(!this.expanded)return!1;this.expanded=!1;this.html=this._collapsedHTML;this.style=this._collapsedStyle;this._annotationModel&&this._annotationModel.modifyAnnotation(this);return!0},_expand:function(){if(this.expanded)return!1;this.expanded=!0;this.html=this._expandedHTML;this.style=this._expandedStyle;this._annotationModel&&this._annotationModel.modifyAnnotation(this);return!0},_collapseImpl:function(a){if(this._collapse()){a&&this._forEachOverlaping(function(a){a.expanded||
(a._expandImpl(!1),a._recollapse=!0)});a=this._projectionModel;var b=a.getBaseModel();this._projection={annotation:this,start:b.getLineStart(b.getLineAtOffset(this.start)+1),end:b.getLineEnd(b.getLineAtOffset(this.end),!0)};a.addProjection(this._projection)}},_expandImpl:function(a){this._expand()&&(this._projectionModel._removeProjection(this._projection,!this._annotationModel),a&&this._forEachOverlaping(function(a){a._recollapse&&(a._collapseImpl(!1),a._recollapse=!1)}))},_forEachOverlaping:function(a){if(this._annotationModel)for(var b=
this._annotationModel.getAnnotations(this.start,this.end);b.hasNext();){var h=b.next();h!==this&&h.type===e.ANNOTATION_FOLDING&&a.call(this,h)}},collapse:function(){this._recollapse=!1;this._collapseImpl(!0)},expand:function(){this._recollapse=!1;this._expandImpl(!0)}};e.ANNOTATION_ERROR="orion.annotation.error";e.ANNOTATION_WARNING="orion.annotation.warning";e.ANNOTATION_TASK="orion.annotation.task";e.ANNOTATION_BREAKPOINT="orion.annotation.breakpoint";e.ANNOTATION_BOOKMARK="orion.annotation.bookmark";
e.ANNOTATION_FOLDING="orion.annotation.folding";e.ANNOTATION_CURRENT_BRACKET="orion.annotation.currentBracket";e.ANNOTATION_MATCHING_BRACKET="orion.annotation.matchingBracket";e.ANNOTATION_CURRENT_LINE="orion.annotation.currentLine";e.ANNOTATION_CURRENT_SEARCH="orion.annotation.currentSearch";e.ANNOTATION_MATCHING_SEARCH="orion.annotation.matchingSearch";e.ANNOTATION_READ_OCCURRENCE="orion.annotation.readOccurrence";e.ANNOTATION_WRITE_OCCURRENCE="orion.annotation.writeOccurrence";e.ANNOTATION_SELECTED_LINKED_GROUP=
"orion.annotation.selectedLinkedGroup";e.ANNOTATION_CURRENT_LINKED_GROUP="orion.annotation.currentLinkedGroup";e.ANNOTATION_LINKED_GROUP="orion.annotation.linkedGroup";e.ANNOTATION_BLAME="orion.annotation.blame";e.ANNOTATION_CURRENT_BLAME="orion.annotation.currentBlame";e.ANNOTATION_DIFF_ADDED="orion.annotation.diffAdded";e.ANNOTATION_DIFF_DELETED="orion.annotation.diffDeleted";e.ANNOTATION_DIFF_MODIFIED="orion.annotation.diffModified";var b={};e.registerType=function(a,d){var h=d;"function"!==typeof h&&
(h=function(a,b,h){this.start=a;this.end=b;void 0!==h&&(this.title=h)},h.prototype=d);h.prototype.type=a;b[a]=h;return a};e.createAnnotation=function(a,b,h,d){return new (this.getType(a))(b,h,d)};e.getType=function(a){return b[a]};g(e.ANNOTATION_ERROR);g(e.ANNOTATION_WARNING);g(e.ANNOTATION_TASK);g(e.ANNOTATION_BREAKPOINT);g(e.ANNOTATION_BOOKMARK);g(e.ANNOTATION_CURRENT_BRACKET);g(e.ANNOTATION_MATCHING_BRACKET);g(e.ANNOTATION_CURRENT_SEARCH);g(e.ANNOTATION_MATCHING_SEARCH);g(e.ANNOTATION_READ_OCCURRENCE);
g(e.ANNOTATION_WRITE_OCCURRENCE);g(e.ANNOTATION_SELECTED_LINKED_GROUP);g(e.ANNOTATION_CURRENT_LINKED_GROUP);g(e.ANNOTATION_LINKED_GROUP);g(e.ANNOTATION_CURRENT_LINE,!0);g(e.ANNOTATION_BLAME,!0);g(e.ANNOTATION_CURRENT_BLAME,!0);g(e.ANNOTATION_DIFF_ADDED);g(e.ANNOTATION_DIFF_DELETED);g(e.ANNOTATION_DIFF_MODIFIED);e.registerType(e.ANNOTATION_FOLDING,c);d.addMixin=function(a){var b=d.prototype,h;for(h in b)b.hasOwnProperty(h)&&(a[h]=b[h])};d.prototype={addAnnotationType:function(a,b){this._annotationTypes||
(this._annotationTypes=[]);var h=b-1;void 0==b||!(0<=h&&h<this._annotationTypes.length)?this._annotationTypes.push(a):this._annotationTypes.splice(h,0,a)},getAnnotationTypePriority:function(a){if(this._annotationTypes)for(var b=0;b<this._annotationTypes.length;b++)if(this._annotationTypes[b]===a)return b+1;return 0},getAnnotationsByType:function(a,b,h){a=a.getAnnotations(b,h);for(h=[];a.hasNext();)b=a.next(),0!==this.getAnnotationTypePriority(b.type)&&h.push(b);var d=this;h.sort(function(a,b){return d.getAnnotationTypePriority(a.type)-
d.getAnnotationTypePriority(b.type)});return h},isAnnotationTypeVisible:function(a){return 0!==this.getAnnotationTypePriority(a)},removeAnnotationType:function(a){if(this._annotationTypes)for(var b=0;b<this._annotationTypes.length;b++)if(this._annotationTypes[b]===a){this._annotationTypes.splice(b,1);break}}};n.prototype={addAnnotation:function(a){if(a){var b=this._annotations,h=f(b,a.start);b.splice(h,0,a);a._annotationModel=this;this.onChanged({type:"Changed",added:[a],removed:[],changed:[]})}},
getTextModel:function(){return this._model},getAnnotations:function(a,b){var h=this._annotations,d,c=0,f;f=void 0===a&&void 0===b?function(){return c<h.length?h[c++]:null}:function(){for(;c<h.length;){var d=h[c++];if(a===d.start||(a>d.start?a<d.end:d.start<b))return d;if(d.start>=b)break}return null};d=f();return{next:function(){var a=d;a&&(d=f());return a},hasNext:function(){return null!==d}}},modifyAnnotation:function(a){if(a&&!(0>this._getAnnotationIndex(a)))this.onChanged({type:"Changed",added:[],
removed:[],changed:[a]})},onChanged:function(a){return this.dispatchEvent(a)},removeAnnotations:function(a){var b=this._annotations,d,c;if(a){d=[];for(c=b.length-1;0<=c;c--){var r=b[c];r.type===a&&(b.splice(c,1),d.splice(0,0,r),r._annotationModel=null)}}else d=b;this.onChanged({type:"Changed",removed:d,added:[],changed:[]})},removeAnnotation:function(a){if(a){var b=this._getAnnotationIndex(a);0>b||(a._annotationModel=null,a={type:"Changed",removed:this._annotations.splice(b,1),added:[],changed:[]},
this.onChanged(a))}},replaceAnnotations:function(a,b){var d=this._annotations,c,r,g,l=[];if(a)for(c=a.length-1;0<=c;c--)g=a[c],r=this._getAnnotationIndex(g),0>r||(g._annotationModel=null,d.splice(r,1),l.splice(0,0,g));b||(b=[]);for(c=0;c<b.length;c++)g=b[c],r=f(d,g.start),g._annotationModel=this,d.splice(r,0,g);this.onChanged({type:"Changed",removed:l,added:b,changed:[]})},setTextModel:function(a){this._model&&this._model.removeEventListener("Changed",this._listener.onChanged);(this._model=a)&&this._model.addEventListener("Changed",
this._listener.onChanged)},_getAnnotationIndex:function(a){for(var b=this._annotations,d=f(b,a.start);d<b.length&&b[d].start===a.start;){if(b[d]===a)return d;d++}return-1},_onChanged:function(a){var b=a.start,d=a.addedCharCount,c=a.removedCharCount,r=this._annotations,f=b+c;if(0<r.length){a={type:"Changed",added:[],removed:[],changed:[],textModelChangedEvent:a};d-=c;for(c=0;c<r.length;c++){var g=r[c];g.start>=f?(g._oldStart=g.start,g._oldEnd=g.end,g.start+=d,g.end+=d,a.changed.push(g)):g.end<=b||
(g.start<b&&f<g.end?(g._oldStart=g.start,g._oldEnd=g.end,g.end+=d,a.changed.push(g)):(r.splice(c,1),a.removed.push(g),g._annotationModel=null,g.expand&&g.expand(),c--))}if(0<a.added.length||0<a.removed.length||0<a.changed.length)this.onChanged(a)}}};m.EventTarget.addMixin(n.prototype);l.prototype={destroy:function(){var a=this._view;a&&(a.removeEventListener("Destroy",this._listener.onDestroy),a.removeEventListener("LineStyle",this._listener.onLineStyle),this.view=null);(a=this._annotationModel)&&
a.removeEventListener("Changed",this._listener.onChanged)},_mergeStyle:function(a,b){if(b){a||(a={});a.styleClass=a.styleClass&&b.styleClass&&a.styleClass!==b.styleClass?a.styleClass+(" "+b.styleClass):b.styleClass;var d;b.tagName&&!a.tagName&&(a.tagName=b.tagName);if(b.style)for(d in a.style||(a.style={}),b.style)a.style[d]||(a.style[d]=b.style[d]);if(b.attributes)for(d in a.attributes||(a.attributes={}),b.attributes)a.attributes[d]||(a.attributes[d]=b.attributes[d])}return a},_mergeStyleRanges:function(a,
b){a||(a=[]);for(var d,c=f(a,b.start,!0);c<a.length&&b;c++){var r=a[c];if(b.end<=r.start)break;if(!(b.start>=r.end)){d=this._mergeStyle({},r.style);d=this._mergeStyle(d,b.style);var g=[];g.push(c,1);b.start<r.start&&g.push({start:b.start,end:r.start,style:b.style});b.start>r.start&&g.push({start:r.start,end:b.start,style:r.style});g.push({start:Math.max(r.start,b.start),end:Math.min(r.end,b.end),style:d});b.end<r.end&&g.push({start:b.end,end:r.end,style:r.style});b=b.end>r.end?{start:r.end,end:b.end,
style:b.style}:null;Array.prototype.splice.apply(a,g)}}b&&(d=this._mergeStyle({},b.style),a.splice(c,0,{start:b.start,end:b.end,style:d}));return a},_onAnnotationModelChanged:function(a){function b(a,d){g.getBaseModel&&(a=g.mapOffset(a,!0),d=g.mapOffset(d,!0));-1!==a&&-1!==d&&c.redrawRange(a,d)}function d(a,h){for(var c=0;c<a.length;c++)if(r.isAnnotationTypeVisible(a[c].type)){var p=a[c];b(p.start,p.end);h&&(void 0!==p._oldStart&&p._oldEnd)&&b(p._oldStart,p._oldEnd)}}var c=this._view;if(c){var r=
this,g=c.getModel();d(a.added);d(a.removed);d(a.changed,!0)}},_onDestroy:function(a){this.destroy()},_onLineStyle:function(a){var b=this._annotationModel,d=a.textView.getModel(),c=b.getTextModel(),g=a.lineStart,f=a.lineStart+a.lineText.length;c!==d&&(g=d.mapOffset(g),f=d.mapOffset(f));for(b=b.getAnnotations(g,f);b.hasNext();)if(g=b.next(),this.isAnnotationTypeVisible(g.type)){if(g.rangeStyle){var f=g.start,l=g.end;c!==d&&(f=d.mapOffset(f,!0),l=d.mapOffset(l,!0));a.ranges=this._mergeStyleRanges(a.ranges,
{start:f,end:l,style:g.rangeStyle})}g.lineStyle&&(a.style=this._mergeStyle({},a.style),a.style=this._mergeStyle(a.style,g.lineStyle))}}};d.addMixin(l.prototype);return{FoldingAnnotation:c,AnnotationType:e,AnnotationTypeList:d,AnnotationModel:n,AnnotationStyler:l}});
define("orion/editor/textStyler",["orion/editor/annotations","orion/editor/eventTarget","orion/metrics"],function(k,m,e){function c(b,a,d){this._patternManager=new g(b,a);this._contentType=d}function g(b,a){this._unnamedCounter=0;this._patterns=[];this._rootId=a;b.forEach(function(a){this._addRepositoryPatterns(a.repository||{},a.id);this._addPatterns(a.patterns||[],a.id)}.bind(this))}function d(b,a,d,h,c,g,f){this.start=b.start;this.end=b.end;this.contentStart=b.contentStart;this.contentEnd=b.contentEnd;
this.name=a;this.typeId=d;this.styler=h;this.parent=g;f&&f(this);this._subBlocks=h.computeBlocks(c,c.getText(this.contentStart,this.end),this,this.contentStart,null,null,null)}function f(b){this._styler=b}function n(b,a,d){this._highlightCaretLine=this._whitespacesVisible=!1;this._detectTasks=this._foldingEnabled=!0;this._annotationProviders=[];this._view=b;this._annotationModel=a;this._stylerAdapter=d;this._stylerAdapter.setStyler(this);this._accessor=new f(this);this._bracketAnnotations;var h=this;
this._listener={onChanged:function(a){h._onModelChanged(a)},onDestroy:function(a){h._onDestroy(a)},onLineStyle:function(a){h._onLineStyle(a)},onMouseDown:function(a){h._onMouseDown(a)},onSelection:function(a){h._onSelection(a)}};var c=b.getModel();c.getBaseModel&&(c=c.getBaseModel());c.addEventListener("Changed",this._listener.onChanged);b.addEventListener("MouseDown",this._listener.onMouseDown);b.addEventListener("Selection",this._listener.onSelection);b.addEventListener("Destroy",this._listener.onDestroy);
b.addEventListener("LineStyle",this._listener.onLineStyle);var g=c.getCharCount(),l={start:0,contentStart:0,end:g,contentEnd:g};if(5E4<=g)var n=(new Date).getTime();this._rootBlock=this._stylerAdapter.createBlock(l,this,c,null);n&&(l=(new Date).getTime()-n,10<l&&e.logTiming("editor","styler compute blocks (ms/50000 chars)",5E4*l/g,d.getContentType()));a&&(d=[],a.removeAnnotations(k.AnnotationType.ANNOTATION_FOLDING),this._computeFolding(this._rootBlock.getBlocks(),b.getModel(),d),this._detectTasks&&
(a.removeAnnotations(k.AnnotationType.ANNOTATION_TASK),this._computeTasks(this._rootBlock,c,d)),a.replaceAnnotations([],d));b.redrawLines()}var l=function(b,a,d,h,c){var g;void 0===h&&(h=-1);void 0===c&&(c=b.length);for(;1<c-h;)if(g=Math.floor((c+h)/2),a<=b[g].start)c=g;else if(d&&a<b[g].end){c=g;break}else h=g;return c};c.prototype={blockSpansBeyondEnd:function(b){return b.pattern.regexEnd===this._eolRegex},computeBlocks:function(b,a,d,h,c,g,f){if(!a)return[];var l=[],e=[],n;c=c||0;g=g||Infinity;
f=f||Infinity;d.blockPatterns.forEach(function(s){(n=this._findMatch(s.regexBegin||s.regex,a,c))&&e.push({result:n,pattern:s})}.bind(this));if(!e.length)return l;e.sort(function(s,a){return s.result.index<a.result.index?-1:s.result.index>a.result.index?1:s.pattern.pattern.index<a.pattern.pattern.index?-1:1});for(var k=0;0<e.length;){var m=e[0];e.splice(0,1);if(g<m.result.index)break;if(!(m.result.index<k)){var k=h+m.result.index,C=m.result.index,E=null,B=m.pattern.regexEnd;if(B){var C=C+m.result[0].length,
s=m.pattern,x=this._substituteCaptureValues(B,m.result);x!==B&&(s={pattern:s.pattern,regexBegin:s.regexBegin,regexEnd:x},B=x);for(x=C;!E;){n=this._findMatch(B,a,x);n||(this._eolRegex.lastIndex=0,n=this._eolRegex.exec(a),s={pattern:s.pattern,regexBegin:s.regexBegin,regexEnd:this._eolRegex});var x=this.createBlock({start:k,end:h+n.index+n[0].length,contentStart:h+C,contentEnd:h+n.index},d.styler,b,d,s),y=x.getBlocks();if(!y.length||y[y.length-1].end<=n.index+h)E=x;x=n.index+n[0].length}}else E=this.createBlock({start:k,
end:k+m.result[0].length,contentStart:k,contentEnd:k+m.result[0].length},d.styler,b,d,m.pattern);l.push(E);if(l.length===f||g<=E.end)break;k=E.end-h}this._updateMatch(m,a,e,k,g)}return l},computeStyle:function(b,a,d){if(!b.pattern)return null;var h={start:b.start,end:b.end,style:b.pattern.pattern.name};if(b.contentStart<=d&&d<b.contentEnd)return b.pattern.pattern.contentName?{start:b.contentStart,end:b.contentEnd,style:b.pattern.pattern.contentName}:h;var c,g;if(d<b.contentStart){g=b.pattern.pattern.beginCaptures||
b.pattern.pattern.captures;if(!g)return h;c=b.pattern.regexBegin;a=a.getText(b.start,b.contentStart);b=b.start}else{g=b.pattern.pattern.endCaptures||b.pattern.pattern.captures;if(!g)return h;c=b.pattern.regexEnd;a=a.getText(b.contentEnd,b.end);b=b.contentEnd}c.lastIndex=0;if(c=c.exec(a))if(a=[],this._getCaptureStyles(c,g,b,a),(g=a[l(a,d,!0)])&&g.start<=d&&d<g.end)return g;return h},createBlock:function(b,a,c,h,p){return new d(b,p?p.pattern.name:null,p?p.pattern.id:null,a,c,h,function(a){a.pattern=
p;a.linePatterns=[];a.blockPatterns=[];a.enclosurePatterns={};this._initPatterns(this._patternManager,a)}.bind(this))},getBlockContentStyleName:function(b){return b.pattern.pattern.contentName||b.pattern.pattern.name},getBlockEndStyle:function(b,a,d,h){var c;if(b.pattern.regexEnd&&(c=this._findMatch(b.pattern.regexEnd,a,0)))(a=b.pattern.pattern.endCaptures||b.pattern.pattern.captures)?this._getCaptureStyles(c,a,d-c[0].length,h):b.pattern.pattern.name&&h.push({start:d-c[0].length,end:d,style:b.pattern.pattern.name});
return c?c[0]:null},getBlockFoldBounds:function(b,a){return{start:b.start,end:b.end}},getBlockStartStyle:function(b,a,d,h){var c;if(b.pattern.regexBegin&&(c=this._findMatch(b.pattern.regexBegin,a,0)))(a=b.pattern.pattern.beginCaptures||b.pattern.pattern.captures)?this._getCaptureStyles(c,a,d,h):h.push({start:d,end:d+c[0].length,style:b.pattern.pattern.name});return c?c[0]:null},getBracketMatch:function(b,a){for(var d,h=Object.keys(b.enclosurePatterns),c=0;c<h.length;c++){var g=b.enclosurePatterns[h[c]],
f=this._findMatch(g.regex,a,0);if(f&&0===f.index){d=g;break}}if(!d)return null;c=!1;-1!==d.pattern.name.indexOf(this._PUNCTUATION_SECTION_BEGIN)?(c=!0,h=d.pattern.name.replace(this._PUNCTUATION_SECTION_BEGIN,this._PUNCTUATION_SECTION_END)):h=d.pattern.name.replace(this._PUNCTUATION_SECTION_END,this._PUNCTUATION_SECTION_BEGIN);return!b.enclosurePatterns[h]?null:{beginName:d.pattern.name,endName:h,atStart:c}},getContentType:function(){return this._contentType},parse:function(b,a,d,h,c,g){if(b&&(h=h.linePatterns)){var f=
[],l;h.forEach(function(a){var h=a.regex||a.regexBegin;h.oldLastIndex=h.lastIndex;(l=this._findMatch(h,b,d))&&f.push({result:l,pattern:a})}.bind(this));f.sort(function(a,b){return a.result.index<b.result.index?-1:a.result.index>b.result.index?1:a.pattern.pattern.index<b.pattern.pattern.index?-1:1});for(var e=d;0<f.length;){var n=f[0];f.splice(0,1);if(!(n.result.index<e)){var k=n.result.index,m,e=[];if(n.pattern.regex){l=n.result;m=k+l[0].length;m={start:a+k,end:a+m,style:n.pattern.pattern.name};if(!g){n.pattern.pattern.captures&&
this._getCaptureStyles(l,n.pattern.pattern.captures,a+k,e);e.sort(function(a,b){return a.start<b.start?-1:a.start>b.start?1:0});for(k=0;k<e.length-1;k++)if(e[k+1].start<e[k].end){var C={start:e[k+1].end,end:e[k].end,style:e[k].style};e[k].end=e[k+1].start;e.splice(k+2,0,C)}}this._mergeStyles(m,e,c)}else e=n.pattern.regexEnd,e=this._substituteCaptureValues(e,n.result),l=this._findMatch(e,b,n.result.index+n.result[0].length),l||(this._eolRegex.lastIndex=0,l=this._eolRegex.exec(b)),m=l.index+l[0].length,
c.push({start:a+k,end:a+m,style:n.pattern.pattern.name});e=l.index+l[0].length}this._updateMatch(n,b,f,e)}h.forEach(function(a){a=a.regex||a.regexBegin;a.lastIndex=a.oldLastIndex})}},setStyler:function(b){},verifyBlock:function(b,a,d,h){var c=null,g=[],f;d.parent.blockPatterns.forEach(function(b){(f=this._findMatch(b.regexBegin||b.regex,a,0))&&g.push({result:f,pattern:b})}.bind(this));g.sort(function(a,b){return!a.result.index&&b.result.index?-1:a.result.index&&!b.result.index?1:!a.result.index&&
!b.result.index?a.pattern.pattern.index<b.pattern.pattern.index?-1:1:0});if(!g.length||0!==g[0].result.index||g[0].pattern.pattern.id!==d.pattern.pattern.id)c=!1;else{f=g[0];var l=f.pattern.regexEnd;if(l){for(var l=this._substituteCaptureValues(l,f.result),e=f.result[0].length,n=this._findMatch(l,a,e);null===c&&n&&d.start+n.index!==d.contentEnd+h;){var k=this.computeBlocks(b,a,d,d.start,e,n.index+1,null);!k.length||k[k.length-1].end<=d.start+n.index?c=!1:k.length?(e=k[k.length-1].end-d.start,n=this._findMatch(l,
a,e)):n=null}n||(this._eolRegex.lastIndex=0,n=this._eolRegex.exec(a),c=d.start+n.index===d.end+h)}else c=d.start+f.result[0].length===d.end+h}return null!==c?c:!0},_findMatch:function(b,a,d,h){var c=d,g=b.lastIndex;this._linebreakRegex.lastIndex=d;d=this._linebreakRegex.exec(a);var f,l;b.lastIndex=0;if(d){for(l=d.index;0<=--l&&!(f=a.charAt(l),f===this._NEWLINE||f===this._CR););f=a.substring(l+1,d.index+d[1].length);b.lastIndex=l=d.index-l-1}for(;d&&d.index<a.length;){var e;if(h){var n=b.lastIndex;
b.test(f)&&(b.lastIndex=n,e=b.exec(f))}else e=b.exec(f);if(e)return e.index+=c,e.index-=l,b.lastIndex=g,e;l=0;c+=d[0].length;if(d=this._linebreakRegex.exec(a))f=d[1],b.lastIndex=0}b.lastIndex=g;return null},_getCaptureStyles:function(b,a,d,h){if(a[0])h.push({start:d,end:d+b[0].length,style:a[0].name});else for(var c=0,g=1;g<b.length;g++)if(b[g]){var f=a[g];if(f){var l=d+c;h.push({start:l,end:l+b[g].length,style:f.name})}c+=b[g].length}},_initPatterns:function(b,a){if(a.pattern&&a.pattern.pattern.linePatterns)a.linePatterns=
a.pattern.pattern.linePatterns,a.blockPatterns=a.pattern.pattern.blockPatterns,a.enclosurePatterns=a.pattern.pattern.enclosurePatterns;else{var d=b.getPatterns(a.pattern?a.pattern.pattern:null),c=function(a){a="string"===typeof a?a:a.match;var b=this._ignoreCaseRegex.exec(a),d=this._FLAGS;b&&(a=a.substring(b[0].length),d+="i");return RegExp(a,d)}.bind(this),g=-1,f=0;d.forEach(function(b){var d;if(b.match&&!b.begin&&!b.end){if(d={regex:c(b.match),pattern:b},a.linePatterns.push(d),b.name&&0===b.name.indexOf("punctuation.section")&&
(-1!==b.name.indexOf(this._PUNCTUATION_SECTION_BEGIN)||-1!==b.name.indexOf(this._PUNCTUATION_SECTION_END)))a.enclosurePatterns[b.name]=d}else!b.match&&(b.begin&&b.end)&&(g=f,d={regexBegin:c(b.begin),regexEnd:c(b.end),pattern:b},a.linePatterns.push(d));f++}.bind(this));a.blockPatterns=a.linePatterns.slice(0,g+1);a.pattern&&(a.pattern.pattern.enclosurePatterns=a.enclosurePatterns,a.pattern.pattern.linePatterns=a.linePatterns,a.pattern.pattern.blockPatterns=a.blockPatterns)}},_mergeStyles:function(b,
a,d){var c=b.start;a.forEach(function(a){c<=a.start&&d.push({start:c,end:a.start,style:b.style});d.push(a);c=a.end});c<b.end&&d.push({start:c,end:b.end,style:b.style})},_substituteCaptureValues:function(b,a){var d=b.toString();this._captureReferenceRegex.lastIndex=0;if(!this._captureReferenceRegex.test(d))return b;this._captureReferenceRegex.lastIndex=0;for(var c=this._captureReferenceRegex.exec(d);c;)d=d.replace(c[0],a[c[1]]||""),this._captureReferenceRegex.lastIndex=0,c=this._captureReferenceRegex.exec(d);
return RegExp(d.substring(1,d.length-1-this._FLAGS.length),this._FLAGS)},_updateMatch:function(b,a,d,c,g){var f=b.pattern.regex?b.pattern.regex:b.pattern.regexBegin;g=g||Infinity;if((a=this._findMatch(f,a,c,!0))&&a.index<g){b.result=a;for(g=0;g<d.length;g++)if(a.index<d[g].result.index||a.index===d[g].result.index&&b.pattern.pattern.index<d[g].pattern.pattern.index){d.splice(g,0,b);return}d.push(b)}},_captureReferenceRegex:/\\(\d)/g,_eolRegex:/$/,_ignoreCaseRegex:/^\(\?i\)\s*/,_linebreakRegex:/(.*)(?:[\r\n]|$)/g,
_CR:"\r",_FLAGS:"g",_NEWLINE:"\n",_PUNCTUATION_SECTION_BEGIN:".begin",_PUNCTUATION_SECTION_END:".end"};g.prototype={getPatterns:function(b){b?(b="string"===typeof b?b:b.qualifiedId,b+="#"):b=this._rootId+"#"+this._NO_ID;var a=[0],d={},c=RegExp("^"+b+"[^#]+$");this._patterns.forEach(function(b){if(c.test(b.qualifiedId))if(b.include)this._processInclude(b,a,d);else{var g=JSON.parse(JSON.stringify(b));g.index=a[0]++;d[b.qualifiedId]=g}}.bind(this));var g=[];Object.keys(d).forEach(function(a){g.push(d[a])});
return g},_addPattern:function(b,a,d){b.parentId=d;b.id=a;b.qualifiedId=b.parentId+"#"+b.id;this._patterns.push(b);b.patterns&&!b.include&&this._addPatterns(b.patterns,b.qualifiedId)},_addPatterns:function(b,a){b.forEach(function(b){this._addPattern(b,this._NO_ID+this._unnamedCounter++,a)}.bind(this))},_addRepositoryPatterns:function(b,a){Object.keys(b).forEach(function(d){this._addPattern(b[d],d,a)}.bind(this))},_processInclude:function(b,a,d){var c,g=b.include.indexOf("#");c=0===g?RegExp("^"+b.qualifiedId.substring(0,
b.qualifiedId.indexOf("#"))+b.include+"$"):-1===g?RegExp("^"+b.include+"#"+this._NO_ID+"[^#]+$"):RegExp("^"+b.include+"$");this._patterns.forEach(function(b){if(c.test(b.qualifiedId))if(b.include)this._processInclude(b,a,d);else if(!d[b.qualifiedId]){var g=JSON.parse(JSON.stringify(b));g.index=a[0]++;d[b.qualifiedId]=g}}.bind(this))},_NO_ID:"NoID"};d.prototype={adjustBounds:function(b,a){b<this.start&&(this.start+=a);b<this.contentStart&&(this.contentStart+=a);b<=this.end&&(this.end+=a);b<=this.contentEnd&&
(this.contentEnd+=a);this._subBlocks.forEach(function(d){b<=d.end&&d.adjustBounds(b,a)})},getBlocks:function(){return this._subBlocks},getBlockAtIndex:function(b){return l(this.getBlocks(),b,!0)},isRenderingWhitespace:function(){return this.styler._isRenderingWhitespace()}};f.prototype={getStyles:function(b){return this._styler.getStyles(b)}};n.prototype={addAnnotationProvider:function(b){"function"===typeof b&&this._annotationProviders.push(b)},computeBlocks:function(b,a,d,c,g,f,l){return this._stylerAdapter.computeBlocks(b,
a,d,c,g,f,l)},destroy:function(){if(this._view){var b=this._view.getModel();b.getBaseModel&&(b=b.getBaseModel());b.removeEventListener("Changed",this._listener.onChanged);this._view.removeEventListener("MouseDown",this._listener.onMouseDown);this._view.removeEventListener("Selection",this._listener.onSelection);this._view.removeEventListener("Destroy",this._listener.onDestroy);this._view.removeEventListener("LineStyle",this._listener.onLineStyle);this._view=null}},getAnnotationModel:function(){return this._annotationModel},
getBlockAtIndex:function(b){return this._findBlock(this._rootBlock,b)},getRootBlock:function(){return this._rootBlock},getStyleAccessor:function(){return this._accessor},getStyles:function(b){var a=[],d=this._view.getModel();d.getBaseModel&&(d=d.getBaseModel());var c=this._findBlock(this._rootBlock,b),g=d.getLineAtOffset(b),f=d.getLine(g),e=[];this._stylerAdapter.parse(f,d.getLineStart(g),0,c,e);for((g=e[l(e,b,!0)])&&(g.start<=b&&b<g.end)&&a.push(g);c;)(g=this._stylerAdapter.computeStyle(c,d,b))&&
a.splice(0,0,g),c=c.parent;return a},getTextModel:function(){var b=this._view.getModel();b.getBaseModel&&(b=b.getBaseModel());return b},removeAnnotationProvider:function(b){"function"===typeof b&&(b=this._annotationProviders.indexOf(b),-1!==b&&this._annotationProviders.splice(b,1))},setDetectHyperlinks:function(){},setDetectTasks:function(b){this._detectTasks=b},setFoldingEnabled:function(b){this._foldingEnabled=b},setHighlightCaretLine:function(b){this._highlightCaretLine=b},setWhitespacesVisible:function(b,
a){this._whitespacesVisible!==b&&(this._whitespacesVisible=b,a&&this._view.redraw())},_computeFolding:function(b,a,d){if(a.getBaseModel){var c=a.getBaseModel();b.forEach(function(b){var g=this._stylerAdapter.getBlockFoldBounds(b,c);(g=this._createFoldingAnnotation(a,c,g.start,g.end))&&d.push(g);this._computeFolding(b.getBlocks(),a,d)}.bind(this))}},_computeTasks:function(b,a,d,c,g){c=c||b.start;g=g||b.end;if(b.start<=g&&c<=b.end&&this._annotationModel){var f=k.AnnotationType.ANNOTATION_TASK;if(b.name&&
0===b.name.indexOf("comment")){var l=[],e=a.getLineAtOffset(b.contentStart),e=a.getLineStart(e);this._stylerAdapter.parse(a.getText(e,b.end),e,b.contentStart-e,b,l,!0);for(e=0;e<l.length;e++)"meta.annotation.task.todo"===l[e].style&&(c<=l[e].start&&l[e].end<=g)&&d.push(k.AnnotationType.createAnnotation(f,l[e].start,l[e].end,a.getText(l[e].start,l[e].end)))}b.getBlocks().forEach(function(b){this._computeTasks(b,a,d,c,g)}.bind(this))}},_createFoldingAnnotation:function(b,a,d,c){var g=a.getLineAtOffset(d),
f=a.getLineAtOffset(c);return g===f||g+1===f&&a.getLineStart(f)===a.getLineEnd(f)?null:new (k.AnnotationType.getType(k.AnnotationType.ANNOTATION_FOLDING))(d,c,b)},_findBlock:function(b,a){var d=b.getBlocks();if(!d.length)return b;var c=l(d,a,!0);return c<d.length&&d[c].start<=a&&a<d[c].end?this._findBlock(d[c],a):b},_findBrackets:function(b,a,d,c,g,f){for(var e=[],n=[],k=g,t=d.getBlocks(),m=l(t,g,!0);m<t.length&&!(t[m].start>=f);m++){var z=t[m].start,C=t[m].end;if(k<z){var E=b.getLineAtOffset(k),
E=b.getLineStart(E);this._stylerAdapter.parse(c.substring(E-g,z-g),E,k-E,d,n);n.forEach(function(b){b.style&&(0===b.style.indexOf(a.beginName)?e.push(b.start+1):0===b.style.indexOf(a.endName)&&e.push(-(b.start+1)))});n=[]}k=C}k<f&&(E=b.getLineAtOffset(k),E=b.getLineStart(E),this._stylerAdapter.parse(c.substring(E-g,f-g),E,k-E,d,n),n.forEach(function(b){b.style&&(0===b.style.indexOf(a.beginName)?e.push(b.start+1):0===b.style.indexOf(a.endName)&&e.push(-(b.start+1)))}));return e},_findMatchingBracket:function(b,
a,d){var c=b.getLineAtOffset(d),g=b.getLineEnd(c),f=b.getText(d,g),f=this._stylerAdapter.getBracketMatch(a,f);if(!f)return-1;for(var l=b.getLine(c),e=b.getLineStart(c),g=this._findBrackets(b,f,a,l,e,g),n=0;n<g.length;n++)if(l=0<=g[n]?1:-1,g[n]*l-1===d){d=1;if(f.atStart){for(n++;n<g.length;n++)if(l=0<=g[n]?1:-1,d+=l,0===d)return g[n]*l-1;c+=1;for(n=b.getLineCount();c<n;){l=b.getLine(c);e=b.getLineStart(c);g=b.getLineEnd(c);g=this._findBrackets(b,f,a,l,e,g);for(e=0;e<g.length;e++)if(l=0<=g[e]?1:-1,
d+=l,0===d)return g[e]*l-1;c++}}else{for(n--;0<=n;n--)if(l=0<=g[n]?1:-1,d+=l,0===d)return g[n]*l-1;for(c-=1;0<=c;){l=b.getLine(c);e=b.getLineStart(c);g=b.getLineEnd(c);g=this._findBrackets(b,f,a,l,e,g);for(n=g.length-1;0<=n;n--)if(l=0<=g[n]?1:-1,d+=l,0===d)return g[n]*l-1;c--}}break}return-1},_getLineStyle:function(b){if(this._highlightCaretLine){var a=this._view,d=a.getModel(),c=!1;if(!a.getSelections().some(function(a){return a.start===a.end?(c=c||d.getLineAtOffset(a.start)===b,!1):!0})&&c)return this._caretLineStyle}return null},
_getStyles:function(b,a,d,c,g){var f=c+d.length,e=[],n=c+g;g=b.getBlocks();for(var k=l(g,n,!0);k<g.length&&!(g[k].start>=f);k++){var t=g[k].start,m=g[k].end;if(n<t){var z=a.getLineAtOffset(n),z=a.getLineStart(z);this._stylerAdapter.parse(d.substring(z-c,t-c),z,n-z,b,e)}var C=Math.max(n,t);C===t&&(t=this._stylerAdapter.getBlockStartStyle(g[k],d.substring(C-c),C,e))&&(C+=t.length);var t=Math.min(f,m),E=[];t===m&&(n=d.substring(t-n-(g[k].end-g[k].contentEnd)),(n=this._stylerAdapter.getBlockEndStyle(g[k],
n,t,E))&&(t-=n.length));var z=a.getLineAtOffset(C),z=a.getLineStart(z),n=this._getStyles(g[k],a,d.substring(z-c,t-c),z,C-z),B=this._stylerAdapter.getBlockContentStyleName(g[k]);if(B){var s=C;n.forEach(function(a){a.start-s&&e.push({start:s,end:a.start,style:B});a.mergeable&&(a.style+=","+B);e.push(a);s=a.end});t-s&&e.push({start:s,end:t,style:B})}else e=e.concat(n);e=e.concat(E);n=m}n<f&&(z=a.getLineAtOffset(n),z=a.getLineStart(z),this._stylerAdapter.parse(d.substring(z-c,f-c),z,n-z,b,e));return e},
_isRenderingWhitespace:function(){return this._whitespacesVisible},_onDestroy:function(){this.destroy()},_onLineStyle:function(b){b.textView===this._view&&(b.style=this._getLineStyle(b.lineIndex));var a=b.lineStart,d=b.textView.getModel();if(d.getBaseModel)var a=d.mapOffset(a),c=d.getBaseModel();b.ranges=this._getStyles(this._rootBlock,c||d,b.lineText,a,0);for(a=b.ranges.length-1;0<=a;a--){var g=b.ranges[a];if(g.style){if(g.style={styleClass:g.style.replace(/\./g," ")},c){var f=g.end-g.start;g.start=
d.mapOffset(g.start,!0);g.end=g.start+f}}else b.ranges.splice(a,1)}this._isRenderingWhitespace()&&(this._spliceStyles(this._spacePattern,b.ranges,b.lineText,b.lineStart),this._spliceStyles(this._tabPattern,b.ranges,b.lineText,b.lineStart))},_onModelChanged:function(b){var a=b.start,d=b.removedCharCount;b=b.addedCharCount-d;var c=this._view.getModel(),g=c.getBaseModel?c.getBaseModel():c,d=a+d,f=g.getCharCount(),e=g.getLineStart(g.getLineAtOffset(a)),n=this._findBlock(this._rootBlock,a),w,t,m,z,C,E,
B;do{m=n.parent;if(!w&&m){if(0>b&&n.end-a<=-b){n=m;continue}C=g.getText(n.start,Math.min(f,n.end+b+1));if(!this._stylerAdapter.verifyBlock(g,C,n,b)){n=m;continue}}t=n.getBlocks();var s=t.length,x=l(t,e,!0),y=l(t,d,!1,x-1,s);w=!1;if(x&&t.length&&t[x-1].end===a){C=g.getText(t[x-1].start,Math.min(f,a+1));var D=this.computeBlocks(g,C,n,t[x-1].start,null,null,null);D.length&&D[0].end!==t[x-1].end&&(x--,w=!0)}x<s&&t[x].start<=e&&(e<t[x].end||w)?(B=t[x].start,B>a&&(B+=b)):x===s&&0<s&&n.end-b===t[s-1].end?
(B=t[--x].start,B>a&&(B+=b)):B=Math.max(e,n.contentStart);E=y<s?t[y].end:n.contentEnd;a<=E&&(E+=b);E=Math.min(E,f-1);C=g.getText(B,E+1);D=this.computeBlocks(g,C,n,B,null,null,null);if(y<s){if(D.length&&D[D.length-1].end===E&&D[D.length-1].typeId===t[y].typeId)break;if(D.length&&this._stylerAdapter.blockSpansBeyondEnd(D[D.length-1])){y++;for(var J=D[D.length-1].getBlocks(),J=(J.length?J[J.length-1]:D[D.length-1]).typeId;y<s;){if(t[y].typeId===J){var F=t[y].end+b,F=Math.min(F,f-1);C=g.getText(B,F+1);
C=this.computeBlocks(g,C,n,B,null,null,null);if(C.length&&C[C.length-1].end===F){E=F;D=C;break}}y++}if(y<s)break}}else if(!D.length||D[D.length-1].end<=n.contentEnd+b)break;if(!m){E=f;y=s;C=g.getText(B,E);D=this.computeBlocks(g,C,n,B,null,null,null);break}n=m;z=!0}while(1);this._rootBlock.adjustBounds(a,b);y=Math.min(y+1,s);z||(z=y-x!==D.length);if(!z)for(s=0;s<D.length;s++)if(w=t[x+s],f=D[s],w.start!==f.start||w.end!==f.end||w.typeId!==f.typeId){z=!0;break}!t.length&&!D.length?(w=[n],this.dispatchEvent({type:"BlocksChanged",
oldBlocks:[n],newBlocks:w}),n=w[0]):this.dispatchEvent({type:"BlocksChanged",oldBlocks:t.slice(x,y),newBlocks:D});x=[x,y-x].concat(D);Array.prototype.splice.apply(t,x);z&&(t=B,z=E,c!==g&&(t=c.mapOffset(t,!0),z=c.mapOffset(z,!0)),this._view.redrawRange(t,z));if(this._annotationModel){var K=[],H=[],L=[];t=this._annotationModel.getAnnotations(B,E);z=this._foldingEnabled&&g!==c;for(x=n.parent||n;t.hasNext();)if(y=t.next(),z&&y.type===k.AnnotationType.ANNOTATION_FOLDING){L.push(y);for(w=this._findBlock(x,
y.start);w;){var G=this._stylerAdapter.getBlockFoldBounds(w,g);if(y.start===G.start&&y.end===G.end)break;w=w.parent}w&&y.start===G.start&&y.end===G.end?(D=y.start,w=y.end,D>a&&(D-=b),w>a&&(w-=b),D<=a&&(a<w&&D<=d&&d<w)&&(D=g.getLineAtOffset(y.start),w=g.getLineAtOffset(y.end),D!==w?y.expanded||y.expand():K.push(y))):(K.push(y),y.expand())}else y.type===k.AnnotationType.ANNOTATION_TASK&&n.start<=y.start&&y.end<=n.end&&K.push(y);z&&x.getBlocks().forEach(function(s){this._updateFolding(s,g,c,L,H,B,E)}.bind(this));
this._detectTasks&&this._computeTasks(n,g,H,B,E);this._annotationProviders.forEach(function(s){var a=[],b=[];s(this._annotationModel,g,n,B,E,a,b);K=K.concat(a);H=H.concat(b)}.bind(this));this._annotationModel.replaceAnnotations(K,H)}},_onMouseDown:function(b){if(2===b.clickCount){var a=this._view.getModel(),d=this._view.getOffsetAtLocation(b.x,b.y);if(0<d){var c=d-1,g=a;a.getBaseModel&&(c=a.mapOffset(c),g=a.getBaseModel());var f=this._findBlock(this._rootBlock,c),c=this._findMatchingBracket(g,f,c);
-1!==c&&(b.preventDefault(),b=c,a.getBaseModel&&(b=a.mapOffset(b,!0)),d>b&&(d--,b++),this._view.setSelection(b,d))}}},_onSelection:function(b){var a=Array.isArray(b.oldValue)?b.oldValue:[b.oldValue];b=Array.isArray(b.newValue)?b.newValue:[b.newValue];var d=this._view,c=d.getModel(),g;if(this._highlightCaretLine){var f=function(a){var b={};return a.some(function(a){if(a.isEmpty())b[c.getLineAtOffset(a.start).toString()]=!0;else return!0;return!1})?{}:b},a=f(a),f=f(b),l=function(a,b){for(var c in a)b[c]||
(g=c>>0,d.redrawLines(g,g+1))};l(a,f);l(f,a)}if(this._annotationModel){var a=this._bracketAnnotations,e,n;if(1===b.length&&b[0].isEmpty()&&0<(n=b[0].getCaret()))n-=1,c.getBaseModel&&(n=c.mapOffset(n),c=c.getBaseModel()),b=this._findBlock(this._rootBlock,n),b=this._findMatchingBracket(c,b,n),-1!==b&&(e=[k.AnnotationType.createAnnotation(k.AnnotationType.ANNOTATION_MATCHING_BRACKET,b,b+1),k.AnnotationType.createAnnotation(k.AnnotationType.ANNOTATION_CURRENT_BRACKET,n,n+1)]);this._bracketAnnotations=
e;this._annotationModel.replaceAnnotations(a,e)}},_spliceStyles:function(b,a,d,c){for(var g=b.regex,f=g.lastIndex=0,l=g.exec(d);l;){for(l=c+l.index;f<a.length&&!(l<a[f].end);)f++;var e={start:l,end:l+1,style:JSON.parse(JSON.stringify(b.style))};if(f<a.length&&a[f].start<=l){var n={start:l+1,end:a[f].end,style:a[f].style};a[f].end=l;a.splice(f+1,0,n);a.splice(f+1,0,e);f+=2;e.style.styleClass+=" "+a[f].style.styleClass}else a.splice(f,0,e),f++;l=g.exec(d)}},_updateFolding:function(b,a,d,c,g,f,e){f=
f||b.start;e=e||b.end;var n=this._stylerAdapter.getBlockFoldBounds(b,a);if(!b.doNotFold&&n.start<=e&&f<=n.end){var k=l(c,n.start,!0);k<c.length&&c[k].start===n.start&&c[k].end===n.end||(n=this._createFoldingAnnotation(d,a,n.start,n.end))&&g.push(n);b.getBlocks().forEach(function(b){this._updateFolding(b,a,d,c,g,f,e)}.bind(this))}},_caretLineStyle:{styleClass:"meta annotation currentLine"},_spacePattern:{regex:/[ ]/g,style:{styleClass:"punctuation separator space",unmergeable:!0}},_tabPattern:{regex:/\t/g,
style:{styleClass:"punctuation separator tab",unmergeable:!0}}};m.EventTarget.addMixin(n.prototype);return{TextStyler:n,Block:d,createPatternBasedAdapter:function(b,a,d){return new c(b,a,d)}}});
define("orion/editor/stylers/lib/syntax",[],function(){return{id:"orion.lib",grammars:[{id:"orion.lib",repository:{brace_open:{match:"{",name:"punctuation.section.block.begin"},brace_close:{match:"}",name:"punctuation.section.block.end"},bracket_open:{match:"\\[",name:"punctuation.section.bracket.begin"},bracket_close:{match:"\\]",name:"punctuation.section.bracket.end"},parenthesis_open:{match:"\\(",name:"punctuation.section.parens.begin"},parenthesis_close:{match:"\\)",name:"punctuation.section.parens.end"},
operator:{match:"(\\+|-|!|\x3d|\x3e|\x3c|\x26|(\\|\\|))+",name:"punctuation.operator"},doc_block:{begin:{match:"/\\*\\*",literal:"/**"},end:{match:"\\*/",literal:"*/"},name:"comment.block.documentation",patterns:[{match:"@(?:(?!\\*/)\\S)*",name:"meta.documentation.annotation"},{match:"\x3c[^\\s\x3e]*\x3e",name:"meta.documentation.tag"},{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},number_decimal:{match:"\\b-?(?:\\.\\d+|\\d+\\.?\\d*)(?:[eE][+-]?\\d+)?\\b",
name:"constant.numeric.number"},number_hex:{match:"\\b0[xX][0-9A-Fa-f]+\\b",name:"constant.numeric.hex"},string_doubleQuote:{match:'"(?:\\\\.|[^"])*"?',name:"string.quoted.double"},string_singleQuote:{match:"'(?:\\\\.|[^'])*'?",name:"string.quoted.single"},todo_comment_singleLine:{match:"(\\b)(TODO)(\\b)(.*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.line"}}}}},{id:"orion.c-like",repository:{comment_singleLine:{match:{match:"//.*",literal:"//"},
name:"comment.line.double-slash",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},comment_block:{begin:{match:"/\\*",literal:"/*"},end:{match:"\\*/",literal:"*/"},name:"comment.block",patterns:[{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]}}}],keywords:[]}});
define("orion/editor/stylers/application_javascript/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="class const debugger delete enum export extends function implements import in instanceof interface let new package private protected public static super typeof var void with".split(" "),e="break case catch continue default do else finally for if return switch throw try while yield".split(" "),c=["this"],g=["false","null","true","undefined"],d=[];d.push.apply(d,k.grammars);d.push({id:"orion.js",
contentTypes:["application/javascript"],patterns:[{begin:"'(?:\\\\.|[^\\\\'])*\\\\$",end:"^(?:$|(?:\\\\.|[^\\\\'])*('|[^\\\\]$))",name:"string.quoted.single.js"},{begin:'"(?:\\\\.|[^\\\\"])*\\\\$',end:'^(?:$|(?:\\\\.|[^\\\\"])*("|[^\\\\]$))',name:"string.quoted.double.js"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_singleLine"},{match:"/(?![\\s\\*])(?:\\\\.|[^/])+/(?:[gim]{0,3})",name:"string.regexp.js"},{include:"orion.lib#doc_block"},
{include:"orion.c-like#comment_block"},{include:"#jsFunctionDef"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.js"},{match:"\\b(?:"+e.join("|")+")\\b",name:"keyword.control.js"},
{match:"\\b(?:"+g.join("|")+")\\b",name:"constant.language.js"},{match:"\\b(?:"+c.join("|")+")\\b",name:"variable.language.js"}],repository:{jsFunctionDef:{begin:"(function)(\\s+[_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*)?\\s*\\(",end:"\\)",captures:{1:{name:"keyword.operator.js"},2:{name:"entity.name.function.js"}},patterns:[{include:"orion.c-like#comment_singleLine"},{include:"orion.c-like#comment_block"},{match:"[^\\s,]+",name:"variable.parameter.js"}]}}});return{id:d[d.length-1].id,grammars:d,
keywords:m.concat(e).concat(c).concat(g)}});
define("orion/editor/stylers/text_x-java-source/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="abstract boolean byte char class double extends final float implements import instanceof int interface long native new package private protected public short static synchronized throws transient void volatile".split(" "),e="break case catch continue default do else finally for if return switch throw try while".split(" "),c=["false","null","true"],g=["this","super"],d=[];d.push.apply(d,k.grammars);
d.push({id:"orion.java",contentTypes:["text/x-java-source"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_singleLine"},{include:"orion.lib#doc_block"},{include:"orion.c-like#comment_block"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},
{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.java"},{match:"\\b(?:"+e.join("|")+")\\b",name:"keyword.control.java"},{match:"\\b(?:"+c.join("|")+")\\b",name:"constant.language.java"},{match:"\\b(?:"+g.join("|")+")\\b",name:"variable.language.java"}]});return{id:d[d.length-1].id,grammars:d,keywords:m.concat(e).concat(c).concat(g)}});
define("orion/editor/stylers/text_css/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="alignment-adjust alignment-baseline animation-delay animation-direction animation-duration animation-iteration-count animation-name animation-play-state animation-timing-function animation appearance azimuth backface-visibility background-attachment background-clip background-color background-image background-origin background-position background-repeat background-size background baseline-shift binding bleed bookmark-label bookmark-level bookmark-state bookmark-target border-bottom-color border-bottom-left-radius border-bottom-right-radius border-bottom-style border-bottom-width border-bottom border-collapse border-color border-image-outset border-image-repeat border-image-slice border-image-source border-image-width border-image border-left-color border-left-style border-left-width border-left border-radius border-right-color border-right-style border-right-width border-right border-spacing border-style border-top-color border-top-left-radius border-top-right-radius border-top-style border-top-width border-top border-width border bottom box-align box-decoration-break box-direction box-flex-group box-flex box-lines box-ordinal-group box-orient box-pack box-shadow box-sizing break-after break-before break-inside caption-side clear clip color-profile color column-count column-fill column-gap column-rule-color column-rule-style column-rule-width column-rule column-span column-width columns content counter-increment counter-reset crop cue-after cue-before cue cursor direction display dominant-baseline drop-initial-after-adjust drop-initial-after-align drop-initial-before-adjust drop-initial-before-align drop-initial-size drop-initial-value elevation empty-cells fit-position fit flex-align flex-flow flex-inline-pack flex-order flex-pack float-offset float font-family font-size-adjust font-size font-stretch font-style font-variant font-weight font grid-columns grid-rows hanging-punctuation height hyphenate-after hyphenate-before hyphenate-character hyphenate-lines hyphenate-resource hyphens icon image-orientation image-rendering image-resolution inline-box-align left letter-spacing line-height line-stacking-ruby line-stacking-shift line-stacking-strategy line-stacking list-style-image list-style-position list-style-type list-style margin-bottom margin-left margin-right margin-top margin mark-after mark-before mark marker-offset marks marquee-direction marquee-loop marquee-play-count marquee-speed marquee-style max-height max-width min-height min-width move-to nav-down nav-index nav-left nav-right nav-up opacity orphans outline-color outline-offset outline-style outline-width outline overflow-style overflow-x overflow-y overflow padding-bottom padding-left padding-right padding-top padding page-break-after page-break-before page-break-inside page-policy page pause-after pause-before pause perspective-origin perspective phonemes pitch-range pitch play-during position presentation-level punctuation-trim quotes rendering-intent resize rest-after rest-before rest richness right rotation-point rotation ruby-align ruby-overhang ruby-position ruby-span size speak-header speak-numeral speak-punctuation speak speech-rate stress string-set table-layout target-name target-new target-position target text-align-last text-align text-decoration text-emphasis text-height text-indent text-justify text-outline text-shadow text-transform text-wrap top transform-origin transform-style transform transition-delay transition-duration transition-property transition-timing-function transition unicode-bidi vertical-align visibility voice-balance voice-duration voice-family voice-pitch-range voice-pitch voice-rate voice-stress voice-volume volume white-space-collapse white-space widows width word-break word-spacing word-wrap z-index".split(" "),
e=[];e.push.apply(e,k.grammars);e.push({id:"orion.css",contentTypes:["text/css"],patterns:[{begin:"'(?:\\\\.|[^\\\\'])*\\\\$",end:"^(?:$|(?:\\\\.|[^\\\\'])*('|[^\\\\]$))",name:"string.quoted.single.css"},{begin:'"(?:\\\\.|[^\\\\"])*\\\\$',end:'^(?:$|(?:\\\\.|[^\\\\"])*("|[^\\\\]$))',name:"string.quoted.double.css"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_block"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},
{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#number_decimal"},{include:"#number_hex"},{match:"(?i)\\b-?(?:\\.\\d+|\\d+\\.?\\d*)(?:%|em|ex|ch|rem|vw|vh|vmin|vmax|in|cm|mm|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?\\b",name:"constant.numeric.value.css"},{match:"(?:-webkit-|-moz-|-ms-|-o-|\\b)(?:"+m.join("|")+")\\b",name:"support.type.propertyName.css"}],repository:{number_hex:{match:"#[0-9A-Fa-f]+\\b",
name:"constant.numeric.hex.css"}}});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/application_xml/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m=[];m.push.apply(m,k.grammars);m.push({id:"orion.xml",contentTypes:["application/xml","application/xhtml+xml"],patterns:[{include:"#comment"},{include:"#doctype"},{include:"#xmlDeclaration"},{include:"#tag"},{include:"#ampersandEscape"}],repository:{ampersandEscape:{match:"\x26lt;|\x26gt;|\x26amp;",name:"constant.character"},comment:{begin:{match:"\x3c!--",literal:"\x3c!--"},end:{match:"--\x3e",
literal:"--\x3e"},name:"comment.block.xml",patterns:[{match:"(\\b)(TODO)(\\b)(((?!--\x3e).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.line"}}}]},doctype:{begin:"\x3c!(?:doctype|DOCTYPE)",end:"\x3e",name:"meta.tag.doctype.xml",captures:{0:{name:"meta.tag.doctype.xml"}},patterns:[{include:"#comment"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}]},tag:{begin:"\x3c/?[A-Za-z0-9]+",end:"/?\x3e",captures:{0:{name:"meta.tag.xml"}},
patterns:[{include:"#comment"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}]},xmlDeclaration:{begin:"\x3c\\?xml",end:"\\?\x3e",captures:{0:{name:"meta.tag.declaration.xml"}},patterns:[{include:"#comment"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}],name:"meta.tag.declaration.xml"}}});return{id:m[m.length-1].id,grammars:m,keywords:[]}});
define("orion/editor/stylers/text_html/syntax",["orion/editor/stylers/application_javascript/syntax","orion/editor/stylers/text_css/syntax","orion/editor/stylers/application_xml/syntax"],function(k,m,e){var c=[];c.push.apply(c,k.grammars);c.push.apply(c,m.grammars);c.push.apply(c,e.grammars);c.push({id:"orion.html",contentTypes:["text/html"],patterns:[{begin:"(?i)(\x3cstyle)([^\x3e]*)(\x3e)",end:"(?i)(\x3c/style\x3e)",captures:{1:{name:"meta.tag.html"},3:{name:"meta.tag.html"}},contentName:"source.css.embedded.html",
patterns:[{include:"orion.css"}]},{begin:"(?i)\x3cscript\\s*\x3e|\x3cscript\\s.*?(?:language\\s*\x3d\\s*(['\"])javascript\\1|type\\s*\x3d\\s*(['\"])(?:text|application)/(?:javascript|ecmascript)\\2).*?\x3e",end:"(?i)\x3c/script\x3e",captures:{0:{name:"meta.tag.html"}},contentName:"source.js.embedded.html",patterns:[{include:"orion.js"}]},{begin:"\x3c/?[A-Za-z0-9]+",end:"/?\x3e",captures:{0:{name:"meta.tag.html"}},patterns:[{include:"orion.xml#comment"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},
{include:"#attribute"}]},{include:"orion.xml#comment"},{include:"orion.xml#doctype"},{include:"orion.xml#ampersandEscape"}],repository:{attribute:{match:"\\b(?:accept-charset|accept|accesskey|action|align|alt|async|autocomplete|autoplay|autosave|bgcolor|border|buffered|challenge|charset|checked|cite|class|codebase|code|color|colspan|cols|contenteditable|content|contextmenu|controls|coords|data-[A-Za-z_:][\\w.:-]*|data|datetime|default|defer|dirname|dir|disabled|download|draggable|dropzone|enctype|formaction|form|for|headers|height|hidden|high|hreflang|href|http-equiv|icon|id|ismap|itemprop|keytype|kind|label|language|lang|list|loop|low|manifest|maxlength|max|media|method|min|multiple|name|novalidate|open|optimum|pattern|ping|placeholder|poster|preload|pubdate|radiogroup|readonly|rel|required|reversed|rowspan|rows|sandbox|scoped|scope|seamless|selected|shape|sizes|size|span|spellcheck|srcdoc|srclang|srcset|src|start|step|style|summary|tabindex|target|title|type|usemap|value|width|wrap)\\b",
name:"meta.tag.attribute.html"}}});return{id:c[c.length-1].id,grammars:c,keywords:[]}});
define("orion/editor/stylers/application_x-jsp/syntax",["orion/editor/stylers/lib/syntax","orion/editor/stylers/text_x-java-source/syntax","orion/editor/stylers/text_html/syntax"],function(k,m,e){var c=[];c.push.apply(c,k.grammars);c.push.apply(c,m.grammars);c.push.apply(c,e.grammars);c.push({id:"orion.jsp",contentTypes:["application/x-jsp"],patterns:[{include:"orion.html"},{include:"#jspComment"},{include:"#jspJavaFragment"},{include:"#jspDirectiveInclude"},{include:"#jspDirectivePage"},{include:"#jspDirectiveTaglib"}],
repository:{jspComment:{begin:{match:"\x3c%--",literal:"\x3c%--"},end:{match:"--%\x3e",literal:"\x3c%--"},name:"comment.block.jsp",patterns:[{match:"(\\b)(TODO)(\\b)(((?!--%\x3e).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.line"}}}]},jspDirectiveInclude:{begin:"\x3c%@\\s+include(?:\\s|$)",end:"%\x3e",captures:{0:{name:"entity.name.directive.include.jsp"}},patterns:[{match:"\\bfile\\b",name:"entity.other.attribute-name.jsp"},{include:"orion.lib#string_doubleQuote"},
{include:"orion.lib#string_singleQuote"}]},jspDirectivePage:{begin:"\x3c%@\\s+page(?:\\s|$)",end:"%\x3e",captures:{0:{name:"entity.name.directive.page.jsp"}},patterns:[{match:"\\b(?:autoFlush|buffer|contentType|errorPage|extends|import|info|isErrorPage|isThreadSafe|language|pageEncoding|session)\\b",name:"entity.other.attribute-name.jsp"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}]},jspDirectiveTaglib:{begin:"\x3c%@\\s+taglib(?:\\s|$)",end:"%\x3e",captures:{0:{name:"entity.name.directive.taglib.jsp"}},
patterns:[{match:"\\b(?:uri|prefix)\\b",name:"entity.other.attribute-name.jsp"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}]},jspJavaFragment:{begin:"\x3c%(?:\x3d|!)?(?:\\s|$)",end:"%\x3e",captures:{0:{name:"entity.name.declaration.java"}},contentName:"source.java.embedded.jsp",patterns:[{include:"orion.java"}]}}});return{id:c[c.length-1].id,grammars:c,keywords:[]}});
define("orion/editor/stylers/application_xquery/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="zero-digit xquery window where when version variable validate unordered union typeswitch type tumbling try treat to then text switch strip strict start stable some sliding self schema-element schema-attribute schema satisfies return processing-instruction previous preserve preceding-sibling preceding percent per-mille pattern-separator parent ordering order or option only of node no-preserve no-inherit next ne NaN namespace-node namespace module mod minus-sign lt let least le lax item is intersect instance inherit infinity in import if idiv gt grouping-separator group greatest ge function for following-sibling following external except every eq end encoding empty-sequence empty else element document-node div digit descending descendant-or-self descendant default declare decimal-separator decimal-format count copy-namespaces context construction comment collation child catch castable cast case by boundary-space base-uri attribute at ascending as and ancestor-or-self ancestor allowing".split(" "),
e=[];e.push.apply(e,k.grammars);e.push({id:"orion.xquery",contentTypes:["application/xquery"],patterns:[{include:"#comment"},{include:"#variable"},{include:"#multiLineDoubleQuote"},{include:"#multiLineSingleQuote"},{include:"orion.xml#tag"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.js"}],
repository:{comment:{begin:{match:"\\(:",literal:"(:"},end:{match:":\\)",literal:":)"},name:"comment.block.xquery",patterns:[{match:"(\\b)(TODO)(\\b)(((?!:\\)).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},variable:{match:"\\$[a-zA-z0-9_]+",name:"variable.other.xquery"},multiLineDoubleQuote:{begin:'"',end:'"',name:"string.quoted.double"},multiLineSingleQuote:{begin:"'",end:"'",name:"string.quoted.single"}}});return{id:e[e.length-
1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/application_json/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m=["false","true"],e=[];e.push.apply(e,k.grammars);e.push({id:"orion.json",contentTypes:["application/json"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},
{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.json"}]});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-csrc/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="auto break case char const continue default double do else enum extern float for goto if inline int long register return short signed sizeof static struct switch typedef union unsigned void volatile while _Bool _Complex _Imaginary".split(" "),e="define elif else endif error ifdef ifndef if include line pragma undef".split(" "),c=[];c.push.apply(c,k.grammars);c.push({id:"orion.c",contentTypes:["text/x-csrc",
"text/x-c"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_singleLine"},{include:"orion.lib#doc_block"},{include:"orion.c-like#comment_block"},{include:"#directive"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},
{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.c"}],repository:{directive:{match:"#\\s*(?:"+e.join("|")+")\\b[^$]*",name:"meta.preprocessor.c"}}});return{id:c[c.length-1].id,grammars:c,keywords:m.concat(e)}});
define("orion/editor/stylers/text_x-csharp/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="abstract as base bool break byte by case catch char checked class const continue decimal default delegate descending double do else enum event explicit extern false finally fixed float foreach for from goto group if implicit int interface internal into in is lock long namespace new null object operator orderby out override params private protected public readonly ref return sbyte sealed select short sizeof stackalloc static string struct switch this throw true try typeof uint ulong unchecked unsafe ushort using var virtual volatile void while where yield".split(" "),e=
[];e.push.apply(e,k.grammars);e.push({id:"orion.csharp",contentTypes:["text/x-csharp"],patterns:[{match:"^\\s*#(?:define|elif|else|endif|endregion|error|if|line|pragma checksum|pragma warning|pragma|region|undef|warning)\\b[^$]*",name:"meta.preprocessor.csharp"},{include:"#string_verbatim"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"#doc_line"},{include:"orion.c-like#comment_singleLine"},{include:"#doc_block"},{include:"orion.c-like#comment_block"},
{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.csharp"}],repository:{doc_block:{begin:{match:"/\\*\\*",literal:"/**"},end:{match:"\\*/",literal:"*/"},name:"comment.block.documentation.csharp",
patterns:[{match:"\x3c[^\\s\x3e]*\x3e",name:"meta.documentation.tag"},{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},doc_line:{match:{match:"// /.*",literal:"// /"},name:"comment.line.documentation.csharp",patterns:[{match:"\x3c[^\\s\x3e]*\x3e",name:"meta.documentation.tag"},{include:"orion.lib#todo_comment_singleLine"}]},string_verbatim:{begin:'@"',end:'^(?:""|[^"])*"(?!")',name:"string.quoted.verbatim.csharp"}}});
return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-cshtml/syntax",["orion/editor/stylers/application_xml/syntax","orion/editor/stylers/text_html/syntax","orion/editor/stylers/text_x-csharp/syntax"],function(k,m,e){var c=[];c.push.apply(c,k.grammars);c.push.apply(c,m.grammars);c.push.apply(c,e.grammars);c.push({id:"orion.cshtml",contentTypes:["text/x-cshtml"],patterns:[{include:"#comment"},{include:"#codeBlock"},{include:"#expression"},{include:"#reference"},{include:"orion.html"}],repository:{comment:{begin:{match:"@\\*",
literal:"@*"},end:{match:"\\*@",literal:"*@"},name:"comment.block.cshtml"},codeBlock:{begin:"(^\\s*)(@)(?\x3d([^{]*){)",end:"}",captures:{2:{name:"entity.name.declaration.csharp"}},contentName:"source.csharp.embedded.cshtml",patterns:[{include:"orion.xml#tag"},{include:"#reference"},{include:"orion.csharp"}]},expression:{match:"^\\s*@[^{]*$",patterns:[{include:"#reference"},{include:"orion.csharp"}]},reference:{match:"@",name:"entity.name.declaration.csharp"}}});return{id:c[c.length-1].id,grammars:c,
keywords:[]}});
define("orion/editor/stylers/text_x-c__src/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="alignas alignof asm and_eq and auto bitand bitor bool break case catch char16_t char32_t char class compl constexpr const_cast const continue decltype default delete double do dynamic_cast else enum explicit export extern false float for friend goto if inline int long mutable namespace new noexcept not_eq not nullptr operator or_eq or private protected public register reinterpret_cast return short signed sizeof static_assert static_cast static struct switch template this thread_local throw true try typedef typeid typename union unsigned using virtual void volatile wchar_t while xor_eq xor _Bool _Complex _Imaginary".split(" "),e=
[];e.push.apply(e,k.grammars);e.push({id:"orion.cpp",contentTypes:["text/x-c++src","text/x-c++"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_singleLine"},{include:"orion.lib#doc_block"},{include:"orion.c-like#comment_block"},{include:"#directive"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},
{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.cpp"}],repository:{directive:{match:"#\\s*(?:define|elif|else|endif|error|ifdef|ifndef|if|include|line|pragma|undef)\\b[^$]*",name:"meta.preprocessor.cpp"}}});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-dockerfile/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="add cmd copy entrypoint env expose from maintainer onbuild run user volume workdir".split(" "),e=[];e.push.apply(e,k.grammars);e.push({id:"orion.dockerfile",contentTypes:["text/x-dockerfile"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"#numberSignComment"},{match:"\\b-?[0-9]+(\\.[0-9]+)?\\b",name:"constant.numeric.dockerfile"},{match:"(?i)^\\s*(?:"+m.join("|")+")\\b",name:"keyword.operator.dockerfile"}],
repository:{numberSignComment:{begin:{match:"^\\s*#",literal:"#"},end:{match:"$",literal:""},name:"comment.line.number-sign.dockerfile",patterns:[{include:"orion.lib#todo_comment_singleLine"}]}}});return{id:"orion.dockerfile",grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-erlang/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="xor when try rem receive query orelse or of not let if fun end div cond catch case bxor bsr bsl bor bnot begin band andalso and after".split(" "),e=[];e.push.apply(e,k.grammars);e.push({id:"orion.erlang",contentTypes:["text/x-erlang"],patterns:[{include:"#comment"},{include:"#stringSingleLine"},{include:"#stringMultiLine"},{include:"#method"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},
{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.erlang"},{match:"^\\s*-(?:vsn|undef|type|spec|record|on_load|opaque|module|include_lib|include|import|ifndef|ifdef|file|export_type|export|endif|else|define|callback|compile|behaviour)\\b",name:"keyword.operator.erlang"}],repository:{comment:{match:"%.*",
name:"comment.line.erlang",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},method:{match:"(^|\\s)[a-zA-Z0-9_.]+(?\x3d\\(|\\s\\()",name:"entity.name.function.erlang"},stringMultiLine:{begin:'"(?:\\\\.|[^\\\\"])*$',end:'^(?:\\\\.|[^\\\\"])*"',name:"string.quoted.double.erlang"},stringSingleLine:{match:'"(?:\\\\.|[^\\\\"])*"',name:"string.quoted.double.erlang"}}});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-ruby/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="alias_method alias attr_accessor attr_reader attr_writer attr BEGIN class defined? def END extend gem include initialize in load lambda module_function module new not public prepend private protected require_relative require undef __ENCODING__ __END__ __FILE__ __LINE__".split(" "),e="and begin break case catch do else elsif end ensure fail for if loop next or raise redo rescue retry return then throw unless until when while yield".split(" "),
c=["false","nil","true"],g=["self","super"],d=[];d.push.apply(d,k.grammars);d.push({id:"orion.ruby",contentTypes:["text/x-ruby"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"#symbol_quoted_single"},{include:"#symbol_quoted_double"},{include:"#symbol"},{include:"#classRef"},{match:"/(?![\\s])(?:\\\\.|[^/])+/(?:[ioxmuesn]\\b)?",name:"string.regexp.ruby"},{match:{match:"#.*",literal:"#"},name:"comment.line.number-sign.ruby",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},
{begin:{match:"^\x3dbegin\\b",literal:"\x3dbegin"},end:{match:"^\x3dend\\b",literal:"\x3dend"},name:"comment.block.ruby",patterns:[{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},
{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{include:"#variable"},{match:"\\b0[bB][01]+\\b",name:"constant.numeric.binary.ruby"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.ruby"},{match:"\\b(?:"+e.join("|")+")\\b",name:"keyword.control.ruby"},{match:"\\b(?:"+c.join("|")+")\\b",name:"constant.language.ruby"},{match:"\\b(?:"+g.join("|")+")\\b",name:"variable.language.ruby"}],repository:{classRef:{match:"\\w+::\\w+"},symbol:{match:":\\w+",
name:"entity.name.symbol.ruby"},symbol_quoted_single:{match:":'[^']*'",name:"entity.name.symbol.quoted.single.ruby"},symbol_quoted_double:{match:':"[^"]*"',name:"entity.name.symbol.quoted.double.ruby"},variable:{match:"@\\w+",name:"entity.name.variable.ruby"}}});return{id:d[d.length-1].id,grammars:d,keywords:m.concat(e).concat(c).concat(g)}});
define("orion/editor/stylers/text_x-haml/syntax",["orion/editor/stylers/lib/syntax","orion/editor/stylers/text_x-ruby/syntax"],function(k,m){var e=[];e.push.apply(e,k.grammars);e.push.apply(e,m.grammars);e.push({id:"orion.haml",contentTypes:["text/x-haml"],patterns:[{include:"#inlineRuby"},{include:"#interpolatedRuby"},{include:"#tagWithRubySymbols"},{include:"#tagWithHTMLAttributes"},{include:"#doctype"},{include:"#tag"},{include:"#htmlComment"},{include:"#hamlComment"}],repository:{doctype:{match:"^!!!.*$",
name:"meta.tag.doctype.haml"},hamlComment:{match:{match:"\\-#.*$",literal:"-#"},name:"comment.line.haml",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},htmlComment:{match:"/[^[].*$",name:"comment.line.html.haml"},inlineRuby:{begin:"(?:^|[^\\\\])(?:\x3d|-|~|\x26\x3d\x3d?|!\x3d\x3d?)",end:"(?:^|[^,])$",patterns:[{include:"orion.ruby"}]},interpolatedRuby:{begin:"#{",end:"}",patterns:[{include:"orion.ruby"}]},tag:{match:"^\\s*%[^\\b]+?\\b",name:"meta.tag.haml"},tagWithHTMLAttributes:{begin:"(^\\s*)(%[^\\s(]+?)\\(",
end:"\\)\\s*$",beginCaptures:{2:{name:"meta.tag.haml"}},patterns:[{match:"[^\\s\x3d]+(?\x3d\x3d)",name:"entity.name.attribute.html.haml"},{include:"orion.ruby#variable"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}]},tagWithRubySymbols:{begin:"(^\\s*)(%[^\\b]+?)\\b{",end:"}\\s*$",beginCaptures:{2:{name:"meta.tag.haml"}},patterns:[{include:"orion.ruby#symbol"},{include:"orion.ruby#variable"},{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"}]}}});
return{id:e[e.length-1].id,grammars:e,keywords:[]}});
define("orion/editor/stylers/text_x-jade/syntax",["orion/editor/stylers/lib/syntax","orion/editor/stylers/application_javascript/syntax"],function(k,m){var e=[];e.push.apply(e,k.grammars);e.push.apply(e,m.grammars);e.push({id:"orion.jade",contentTypes:["text/x-jade"],patterns:[{include:"#comment_singleLine"},{include:"#code"},{include:"#control"},{include:"#caseBranch"},{include:"#mixinWithParameters"},{include:"#mixinRefWithArguments"},{include:"#tagWithAttributes"},{include:"#interpolatedJS"},{include:"#interpolatedTag"},
{include:"#mixin"},{include:"#mixinRef"},{include:"#doctype"},{include:"#filter"},{include:"#case"},{include:"#andAttributes"},{include:"#otherKeywords"},{include:"#tag"}],repository:{andAttributes:{match:"\x26attributes\\b",name:"keyword.operator.jade"},"case":{match:"(^\\s*)(case)\\b",captures:{2:{name:"keyword.control.jade"}}},caseBranch:{begin:"(^\\s*)(when|default)\\s*",end:":|$",patterns:[{include:"orion.js"}],beginCaptures:{2:{name:"keyword.control.jade"}}},code:{match:"(^\\s*- |\x3d |!\x3d ).*$",
patterns:[{include:"orion.js"}]},comment_singleLine:{match:{match:"^\\s*//.*",literal:"//"},name:"comment.line.double-slash.jade",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},control:{begin:"(^\\s*)(if|else( if)?|each|for|unless|while)\\b",end:"$",beginCaptures:{2:{name:"keyword.control.jade"}},patterns:[{include:"orion.js"}]},doctype:{match:"(^\\s*)(doctype.+$)",captures:{2:{name:"meta.tag.doctype.jade"}}},filter:{match:"(^\\s*)(:\\w+)",captures:{2:{name:"entity.other.filter.jade"}}},
interpolatedJS:{begin:"(#{)",end:"(})",captures:{1:{name:"string.interpolated.js.jade"}},patterns:[{include:"orion.js"}]},interpolatedTag:{begin:"(#\\[)",end:"(\\])",captures:{1:{name:"string.interpolated.tag.jade"}},patterns:[{begin:"(\\.|\\w+)\\s*\\(",end:"(\\))(/)?",beginCaptures:{1:{name:"meta.tag.jade"}},endCaptures:{2:{name:"meta.tag.jade"}},patterns:[{include:"orion.js"}]}]},mixin:{match:"(^\\s*)(mixin)(\\s+)(\\w+)",captures:{2:{name:"keyword.operator.jade"},4:{name:"entity.name.mixin.jade"}}},
mixinRef:{match:"(^\\s*)(\\+\\w+)",captures:{2:{name:"entity.name.mixin.jade"}}},mixinRefWithArguments:{begin:"(^\\s*)(\\+\\w+)\\s*\\(",end:"\\)|$",captures:{2:{name:"entity.name.mixin.jade"}},patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.lib#number_decimal"}]},mixinWithParameters:{begin:"(^\\s*)(mixin)(\\s+)(\\w+)\\s*\\(",end:"\\)|$",beginCaptures:{2:{name:"keyword.operator.jade"},4:{name:"entity.name.mixin.jade"}},patterns:[{match:"[^\\s,]+",
name:"variable.parameter.jade"}]},otherKeywords:{match:"(^\\s*)(block|extends|include)\\b",captures:{2:{name:"keyword.operator.jade"}}},tag:{match:"(^\\s*)(\\w+|(?\x3d\\.)|(?\x3d#))(#\\w*|\\.\\w*)*(/?)",captures:{2:{name:"meta.tag.jade"},4:{name:"meta.tag.jade"}}},tagWithAttributes:{begin:"(^\\s*)(\\w+|(?\x3d\\.)|(?\x3d#))(#\\w*|\\.\\w*)*\\s*\\(",end:"(\\))(/)?",beginCaptures:{2:{name:"meta.tag.jade"}},endCaptures:{2:{name:"meta.tag.jade"}},patterns:[{include:"orion.js"}]}}});return{id:e[e.length-
1].id,grammars:e,keywords:"\x26attributes block case default doctype each else extends for if include mixin unless when while".split(" ")}});
define("orion/editor/stylers/text_x-lua/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="and break do else elseif end false for function if in local nil not or repeat return then true until while".split(" "),e=[];e.push.apply(e,k.grammars);e.push({id:"orion.lua",contentTypes:["text/x-luasrc","text/x-lua"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_singleLine"},{include:"#comment_block_dash_dash"},{include:"#comment_singleLine_dash_dash"},
{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{include:"#base_functions"},{include:"#base_variables"},{include:"#reserved_underscore_capital"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.lua"}],repository:{comment_block_dash_dash:{begin:{match:"--\\[\\[",
literal:"--[["},end:{match:"\\]\\]",literal:"]]"},name:"comment.block.dash-dash.lua",patterns:[{match:"(\\b)(TODO)(\\b)(((?!\\]\\]).)*)",name:"meta.annotation.task.todo",captures:{2:{name:"keyword.other.documentation.task"},4:{name:"comment.block"}}}]},comment_singleLine_dash_dash:{begin:{match:"--",literal:"--"},end:{match:"$",literal:""},name:"comment.line.dash-dash.lua",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},base_functions:{match:"\\b(?:assert|arg|collectgarbage|dofile|error|getfenv|getmetatable|ipairs|load|loadfile|loadstring|next|pairs|pcall|print|rawequal|rawget|rawset|require|select|setfenv|setmetatable|tonumber|tostring|type|unpack|xpcall)\\b",
name:"support.function.lua"},base_variables:{match:"\\b(?:_G|LUA_INIT|LUA_PATH|LUA_CPATH|_VERSION)\\b",name:"support.variable.lua"},reserved_underscore_capital:{match:"\\b_[A-Z]*\\b",name:"constant.other.userdefined.lua"}}});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-php/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="abstract and array as callable class clone const declare echo empty eval extends final function global implements include include_once insteadof interface instanceof isset list namespace new or parent print private protected public require require_once static trait unset use var xor __halt_compiler __CLASS__ __DIR__ __FILE__ __FUNCTION__ __LINE__ __METHOD__ __NAMESPACE__ __TRAIT__".split(" "),e=
"break case catch continue default die do else elseif enddeclare endfor endforeach endif endswitch endwhile exit finally for foreach goto if return switch throw try while yield".split(" "),c="false FALSE null NULL true TRUE".split(" "),g=["self"],d=[];d.push.apply(d,k.grammars);d.push({id:"orion.php",contentTypes:["text/x-php"],patterns:[{begin:"(?i)\x3c(\\?|%(?!php))(?:\x3d|php)?(?:\\s|$)",end:"[\\1]\x3e",captures:{0:{name:"entity.name.declaration.php"}},contentName:"source.php.embedded",patterns:[{include:"orion.lib#string_doubleQuote"},
{include:"orion.lib#string_singleQuote"},{include:"orion.c-like#comment_singleLine"},{include:"orion.lib#doc_block"},{include:"orion.c-like#comment_block"},{match:{match:"#.*",literal:"#"},name:"comment.line.number-sign.php",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},{begin:"\x3c\x3c\x3c(\\w+)$",end:"^\\1;$",name:"string.unquoted.heredoc.php"},{begin:"\x3c\x3c\x3c'(\\w+)'$",end:"^\\1;$",name:"string.unquoted.heredoc.nowdoc.php"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},
{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{match:"\\b0[bB][01]+\\b",name:"constant.numeric.binary.php"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.php"},{match:"\\b(?:"+e.join("|")+")\\b",name:"keyword.control.php"},{match:"\\b(?:"+c.join("|")+")\\b",name:"constant.language.php"},
{match:"\\b(?:"+g.join("|")+")\\b",name:"variable.language.php"}]},{include:"orion.html"}]});return{id:d[d.length-1].id,grammars:d,keywords:m.concat(e).concat(c).concat(g)}});
define("orion/editor/stylers/text_x-python/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="and as assert break class continue def del exec elif else except Ellipsis False finally for from global if import in is lambda not None NotImplemented or pass print raise return try True while with yield".split(" "),e=[];e.push.apply(e,k.grammars);e.push({id:"orion.python",contentTypes:["text/x-python"],patterns:[{begin:"(['\"])\\1\\1",end:"\\1\\1\\1",name:"string.quoted.triple.python"},{include:"orion.lib#string_doubleQuote"},
{include:"orion.lib#string_singleQuote"},{begin:{match:"#",literal:"#"},end:{match:"$",literal:""},name:"comment.line.number-sign.python",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"#number_decimal"},{include:"orion.lib#number_hex"},
{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.python"}],repository:{number_decimal:{match:"\\b-?(?:\\.\\d+|\\d+\\.?\\d*)[lL]?\\b",name:"constant.numeric.number.python"}}});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-go/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="break case const continue default defer else fallthrough false for func goto go if import nil package range return select switch true type var".split(" "),e=[];e.push.apply(e,k.grammars);e.push({id:"orion.go",contentTypes:["text/x-go"],patterns:[{include:"orion.lib#string_doubleQuote"},{include:"orion.lib#string_singleQuote"},{begin:"`",end:"`",name:"string.quoted.raw.go"},{include:"orion.c-like#comment_singleLine"},
{include:"orion.c-like#comment_block"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},{include:"orion.lib#number_decimal"},{include:"orion.lib#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.go"},{match:"\\b(?:len|cap|new|make|append|close|copy|delete|complex|real|imag|panic|recover)\\b",
name:"support.function.go"},{match:"\\b(?:bool|chan|uint8|uint16|uint32|uint64|int8|int16|int32|int64|float32|float64|complex64|complex128|byte|map|rune|uint|interface|int|uintptr|string|struct|error)\\b",name:"support.function.type"}]});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-objective-c/syntax",["orion/editor/stylers/text_x-csrc/syntax"],function(k){var m="atomic BOOL bycopy byref Class id IMP inout in nil nonatomic NO NULL oneway out Protocol retain SEL self super YES".split(" "),e="@catch @class @dynamic @end @finally @implementation @interface @private @property @protected @protocol @public @selector @synthesize @throw @try".split(" "),c=["import"],g=[];g.push.apply(g,k.grammars);g.push({id:"orion.objectiveC",contentTypes:["text/x-objective-c"],
patterns:[{include:"#objectiveCString"},{include:"orion.c"},{include:"#objectiveCDirective"},{include:"#objectiveCKeyword"}],repository:{objectiveCDirective:{match:"#\\s*(?:"+c.join("|")+")\\b[^$]*",name:"meta.preprocessor.objective-c"},objectiveCKeyword:{match:"(\\b(?:"+m.join("|")+")|(?:"+e.join("|")+"))\\b",name:"keyword.operator.objective-c"},objectiveCString:{match:'@"(?:\\\\.|[^"])*"?',name:"string.quoted.double.objective-c"}}});return{id:g[g.length-1].id,grammars:g,keywords:k.keywords.concat(m).concat(c).concat(e)}});
define("orion/editor/stylers/text_x-swift/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="associativity as class convenience deinit didSet dynamicType dynamic enum extension final func get import infix init inout internal in is lazy left let mutating none nonmutating operator optional override postfix precedence prefix private protocol Protocol public required right Self set static struct subscript typealias Type unowned var weak willSet @objc".split(" "),e="break case continue default do else fallthrough for if return switch where while".split(" "),
c=["false","nil","true"],g=["self","super"],d=["__COLUMN__","__FILE__","__FUNCTION__","__LINE__"],f=[];f.push.apply(f,k.grammars);f.push({id:"orion.swift",contentTypes:["text/x-swift"],patterns:[{include:"#string_doubleQuote"},{include:"orion.c-like#comment_singleLine"},{include:"#comment_block"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},
{include:"orion.lib#operator"},{include:"#number_binary"},{include:"#number_hex"},{include:"#number_octal"},{include:"#number_decimal"},{include:"#keywords_operator"},{include:"#keywords_control"},{include:"#constants"},{include:"#languageVars1"},{include:"#languageVars2"}],repository:{comment_block:{begin:{match:"/\\*",literal:"/*"},end:{match:"\\*/",literal:"*/"},name:"comment.block.swift",patterns:[{include:"#comment_block"},{match:"(\\b)(TODO)(\\b)(((?!\\*/).)*)",name:"meta.annotation.task.todo",
captures:{2:{name:"keyword.other.documentation.task.swift"},4:{name:"comment.block.swift"}}}]},constants:{match:"(^|[^\\w`])("+c.join("|")+")\\b",captures:{2:{name:"constant.language.swift"}}},keywords_operator:{match:"(^|[^\\w`])("+m.join("|")+")\\b",captures:{2:{name:"keyword.operator.swift"}}},keywords_control:{match:"(^|[^\\w`])("+e.join("|")+")\\b",captures:{2:{name:"keyword.control.swift"}}},languageVars1:{match:"(^|[^\\w`])("+g.join("|")+")\\b",captures:{2:{name:"variable.language.swift"}}},
languageVars2:{match:"(^|[^\\w`])("+d.join("|")+")(?:$|[^\\w])",captures:{2:{name:"variable.language.swift"}}},number_binary:{match:"\\b0b[01]+\\b",name:"constant.numeric.binary.swift"},number_decimal:{match:"\\b-?(?:\\.\\d[\\d_]*|\\d[\\d_]*\\.?[\\d_]*)(?:[eE][+-]?\\d[\\d_]*)?\\b",name:"constant.numeric.decimal.swift"},number_hex:{match:"\\b0[xX](?:\\.[0-9A-Fa-f][0-9A-Fa-f_]*|[0-9A-Fa-f][0-9A-Fa-f_]*\\.?[0-9A-Fa-f_]*)(?:[pP][+-]?\\d[\\d_]*)?\\b",name:"constant.numeric.hex.swift"},number_octal:{match:"\\b0o[01234567][01234567_]*\\b",
name:"constant.numeric.octal.swift"},segment:{begin:"\\(",end:"\\)",patterns:[{include:"#segment"},{include:"#comment_block"},{include:"#number_binary"},{include:"#number_hex"},{include:"#number_octal"},{include:"#number_decimal"},{include:"#keywords_operator"},{include:"#keywords_control"},{include:"#constants"},{include:"#languageVars1"},{include:"#languageVars2"}]},string_doubleQuote:{match:'"(?:\\\\.|[^"])*"?',name:"string.quoted.double.swift",patterns:[{begin:"\\\\\\(",end:"\\)",name:"string.interpolated.swift",
patterns:[{include:"#segment"},{include:"#comment_block"},{include:"#number_binary"},{include:"#number_hex"},{include:"#number_octal"},{include:"#number_decimal"},{include:"#keywords_operator"},{include:"#keywords_control"},{include:"#constants"},{include:"#languageVars1"},{include:"#languageVars2"}]}]}}});return{id:f[f.length-1].id,grammars:f,keywords:m.concat(e).concat(c).concat(g).concat(d)}});
define("orion/editor/stylers/text_x-vb/syntax",["orion/editor/stylers/lib/syntax"],function(k){var m="AddHandler;AddressOf;Aggregate;Alias;AndAlso;And;Ansi;Assembly;Async;As;Auto;Await;Binary;Boolean;ByRef;Byte;ByVal;Call;Case;Catch;CBool;CByte;CChar;CDate;CDbl;CDec;Char;CInt;Class;CLng;CObj;Compare;Const;CShort;CSng;CStr;CType;Custom;Date;Decimal;Declare;Default;Delegate;Dim;DirectCast;Distinct;Double;Do;Each;ElseIf;Else;EndIf;End;Enum;Equals;Erase;Error;Event;Exit;Explicit;False;Finally;For;Friend;From;Function;GetType;Get;GoSub;GoTo;Group By;Group Join;Handles;If;Implements;Imports;Inherits;Integer;Interface;Into;In;IsFalse;IsTrue;Is;Iterator;Join;Key;Let;Lib;Like;Long;Loop;Me;Mid;Module;Mod;MustInherit;MustOverride;MyBase;MyClass;Namespace;New;Next;Nothing;NotInheritable;NotOverridable;Not;Object;Off;On;Optional;Option;Order By;OrElse;Or;Overloads;Overridable;Overrides;ParamArray;Preserve;Private;Property;Protected;Public;RaiseEvent;ReadOnly;ReDim;REM;RemoveHandler;Resume;Return;Select;Set;Shadows;Shared;Short;Single;Skip While;Skip;Static;Step;Stop;Strict;String;Structure;Sub;SyncLock;Take While;Take;Text;Then;Throw;To;True;Try;TypeOf;Unicode;Until;Variant;Wend;When;Where;While;WithEvents;With;WriteOnly;Xor;Yield".split(";"),
e=[];e.push.apply(e,k.grammars);e.push({id:"orion.vb",contentTypes:["text/x-vb"],patterns:[{match:"^\\s*#(?:Const|ElseIf|Else|End|ExternalSource|If|Region)\\b[^$]*",name:"meta.preprocessor.vb"},{include:"orion.lib#string_doubleQuote"},{include:"#doc"},{include:"#comment"},{include:"orion.lib#brace_open"},{include:"orion.lib#brace_close"},{include:"orion.lib#bracket_open"},{include:"orion.lib#bracket_close"},{include:"orion.lib#parenthesis_open"},{include:"orion.lib#parenthesis_close"},{include:"orion.lib#operator"},
{include:"orion.lib#number_decimal"},{include:"#number_hex"},{match:"\\b(?:"+m.join("|")+")\\b",name:"keyword.operator.vb"}],repository:{comment:{begin:{match:"'",literal:"'"},end:{match:"$",literal:""},name:"comment.line.vb",patterns:[{include:"orion.lib#todo_comment_singleLine"}]},doc:{match:{match:"'''.*",literal:"'''"},name:"comment.line.documentation.vb",patterns:[{match:"\x3c[^\\s\x3e]*\x3e",name:"meta.documentation.tag"},{include:"orion.lib#todo_comment_singleLine"}]},number_hex:{match:"\x26[hH][0-9A-Fa-f]+\\b",
name:"constant.numeric.hex.vb"}}});return{id:e[e.length-1].id,grammars:e,keywords:m}});
define("orion/editor/stylers/text_x-vbhtml/syntax",["orion/editor/stylers/application_xml/syntax","orion/editor/stylers/text_html/syntax","orion/editor/stylers/text_x-vb/syntax"],function(k,m,e){var c=[];c.push.apply(c,k.grammars);c.push.apply(c,m.grammars);c.push.apply(c,e.grammars);c.push({id:"orion.vbhtml",contentTypes:["text/x-vbhtml"],patterns:[{include:"#vbhtmlComment"},{include:"#codeBlock"},{include:"#expression"},{include:"#reference"},{include:"orion.html"}],repository:{vbhtmlComment:{begin:{match:"@\\*",
literal:"@*"},end:{match:"\\*@",literal:"*@"},name:"comment.block.vbhtml"},codeBlock:{begin:"(?i)^\\s*@code",end:"(?i)end code",captures:{0:{name:"entity.name.declaration.vb"}},contentName:"source.vb.embedded.vbhtml",patterns:[{include:"orion.xml#tag"},{include:"#reference"},{include:"orion.vb"}]},expression:{match:"(?i)^\\s*@(?!code)[^$]*",patterns:[{include:"#reference"},{include:"orion.vb"}]},reference:{match:"@",name:"entity.name.declaration.vb"}}});return{id:c[c.length-1].id,grammars:c,keywords:[]}});
define("orion/editor/stylers/application_x-ejs/syntax",["orion/editor/stylers/application_javascript/syntax","orion/editor/stylers/application_xml/syntax"],function(k,m){var e=[];e.push.apply(e,k.grammars);e.push.apply(e,m.grammars);e.push({id:"orion.ejs",contentTypes:["application/x-ejs"],patterns:[{include:"orion.xml#comment"},{include:"orion.xml#doctype"},{begin:"\x3c%\x3d?(?:\\s|$)",end:"%\x3e",captures:{0:{name:"entity.name.declaration.js"}},contentName:"source.js.embedded.ejs",patterns:[{include:"orion.js"}]},
{include:"orion.xml#tag"},{include:"orion.xml#ampersandEscape"}]});return{id:e[e.length-1].id,grammars:e,keywords:[]}});
define("orion/editor/stylers/text_x-yaml/syntax",[],function(){var k=["false","null","true"],m="!!bool !!float !!int !!map !!null !!omap !!seq !!str".split(" ");return{id:"orion.yaml",grammars:[{id:"orion.yaml",contentTypes:["text/x-yaml"],patterns:[{include:"#numberSignComment"},{match:"^%(?:YAML|TAG)\\s.*",name:"meta.directive.yaml"},{begin:"^.*?:(?:[\\t ]|$)",end:"$",contentName:"string.unquoted.yaml",beginCaptures:{0:{name:"entity.name.key.yaml"}},patterns:[{include:"#numberSignComment"},{match:"^\\s*[\x26*]\\s*$",
name:"entity.name.tag.yaml"},{match:"(?i)^\\s*(?:"+k.join("|")+")\\s*$",name:"keyword.operator.yaml"},{match:"(?i)^\\s*(?:"+m.join("|")+")\\b",name:"keyword.operator.yaml"},{match:"(?i)^\\s*(?:-?[0-9]*(?:\\.[0-9]+)?(?:e[-+][1-9][0-9]*)?)\\s*$",name:"constant.numeric.yaml"},{match:"(?i)^\\s*(?:-?[1-9][0-9]*|0|-?\\.inf|\\.nan)\\s*$",name:"constant.numeric.yaml"}]},{match:"---|\\.\\.\\.",name:"meta.separator.yaml"}],repository:{numberSignComment:{begin:{match:"(?:^|\\s)#",literal:"#"},end:{match:"$",
literal:""},name:"comment.line.number-sign.yaml",patterns:[{include:"orion.lib#todo_comment_singleLine"}]}}}],keywords:m.concat(k)}});
define("orion/staticDataSource","orion/Deferred orion/editor/textStyler orion/editor/stylers/application_javascript/syntax orion/editor/stylers/application_x-jsp/syntax orion/editor/stylers/application_xquery/syntax orion/editor/stylers/text_css/syntax orion/editor/stylers/text_html/syntax orion/editor/stylers/application_json/syntax orion/editor/stylers/text_x-csrc/syntax orion/editor/stylers/text_x-csharp/syntax orion/editor/stylers/text_x-cshtml/syntax orion/editor/stylers/text_x-c__src/syntax orion/editor/stylers/text_x-dockerfile/syntax orion/editor/stylers/text_x-erlang/syntax orion/editor/stylers/text_x-haml/syntax orion/editor/stylers/text_x-java-source/syntax orion/editor/stylers/text_x-jade/syntax orion/editor/stylers/text_x-lua/syntax orion/editor/stylers/text_x-php/syntax orion/editor/stylers/text_x-python/syntax orion/editor/stylers/text_x-ruby/syntax orion/editor/stylers/text_x-go/syntax orion/editor/stylers/text_x-objective-c/syntax orion/editor/stylers/text_x-swift/syntax orion/editor/stylers/text_x-vb/syntax orion/editor/stylers/text_x-vbhtml/syntax orion/editor/stylers/application_x-ejs/syntax orion/editor/stylers/application_xml/syntax orion/editor/stylers/text_x-yaml/syntax".split(" "),function(k,
m,e,c,g,d,f,n,l,b,a,q,h,p,r,u,v,w,t,A,z,C,E,B,s,x,y,D,J){function F(){this.styler=null}F.prototype={setup:function(s,a,b,d,x){this.styler&&(this.styler.destroy&&this.styler.destroy(),this.styler=null);return this._highlight(s,a,b)},highlight:function(s,a,b){s=b.getTextView();b=b.getAnnotationModel();return this._highlight(a,s,b)},_highlight:function(F,H,L){this.styler&&(this.styler.destroy(),this.styler=null);var G=null;if(F)switch(F.id){case "application/javascript":G=new m.createPatternBasedAdapter(e.grammars,
"orion.js",F.id);break;case "application/x-ejs":G=new m.createPatternBasedAdapter(y.grammars,"orion.ejs",F.id);break;case "text/css":G=new m.createPatternBasedAdapter(d.grammars,"orion.css",F.id);break;case "text/html":G=new m.createPatternBasedAdapter(f.grammars,"orion.html",F.id);break;case "text/x-java-source":G=new m.createPatternBasedAdapter(u.grammars,"orion.java",F.id);break;case "application/x-jsp":G=new m.createPatternBasedAdapter(c.grammars,"orion.jsp",F.id);break;case "application/json":case "text/x-launch":G=
new m.createPatternBasedAdapter(n.grammars,"orion.json",F.id);break;case "text/x-jade":G=new m.createPatternBasedAdapter(v.grammars,"orion.jade",F.id);break;case "text/x-python":G=new m.createPatternBasedAdapter(A.grammars,"orion.python",F.id);break;case "text/x-ruby":G=new m.createPatternBasedAdapter(z.grammars,"orion.ruby",F.id);break;case "text/x-go":G=new m.createPatternBasedAdapter(C.grammars,"orion.go",F.id);break;case "text/x-objective-c":G=new m.createPatternBasedAdapter(E.grammars,"orion.objectiveC",
F.id);break;case "text/x-php":G=new m.createPatternBasedAdapter(t.grammars,"orion.php",F.id);break;case "text/x-swift":G=new m.createPatternBasedAdapter(B.grammars,"orion.swift",F.id);break;case "application/xml":case "application/xhtml+xml":G=new m.createPatternBasedAdapter(D.grammars,"orion.xml",F.id);break;case "text/x-yaml":G=new m.createPatternBasedAdapter(J.grammars,"orion.yaml",F.id);break;case "text/x-arduino":case "text/x-csrc":case "text/x-c":G=new m.createPatternBasedAdapter(l.grammars,
"orion.c",F.id);break;case "text/x-csharp":G=new m.createPatternBasedAdapter(b.grammars,"orion.csharp",F.id);break;case "text/x-cshtml":G=new m.createPatternBasedAdapter(a.grammars,"orion.cshtml",F.id);break;case "text/x-c++src":G=new m.createPatternBasedAdapter(q.grammars,"orion.cpp",F.id);break;case "text/x-dockerfile":G=new m.createPatternBasedAdapter(h.grammars,"orion.dockerfile",F.id);break;case "text/x-erlang":G=new m.createPatternBasedAdapter(p.grammars,"orion.erlang",F.id);break;case "text/x-haml":G=
new m.createPatternBasedAdapter(r.grammars,"orion.haml",F.id);break;case "text/x-lua":G=new m.createPatternBasedAdapter(w.grammars,"orion.lua",F.id);break;case "application/xquery":G=new m.createPatternBasedAdapter(g.grammars,"orion.xquery",F.id);break;case "text/x-vb":G=new m.createPatternBasedAdapter(s.grammars,"orion.vb",F.id);break;case "text/x-vbhtml":G=new m.createPatternBasedAdapter(x.grammars,"orion.vbhtml",F.id)}G&&(this.styler=new m.TextStyler(H,L,G));return(new k).resolve()},getStyler:function(){return this.styler}};
return{ContentTypes:[{id:"text/plain",name:"Text",extension:["txt"],imageClass:"file-sprite-text modelDecorationSprite"},{id:"application/javascript","extends":"text/plain",name:"JavaScript",extension:["js"],imageClass:"file-sprite-javascript modelDecorationSprite"},{id:"text/html","extends":"text/plain",name:"HTML",extension:["html","htm"],imageClass:"file-sprite-html modelDecorationSprite"},{id:"text/css","extends":"text/plain",name:"CSS",extension:["css"],imageClass:"file-sprite-css modelDecorationSprite"},
{id:"application/json","extends":"text/plain",name:"JSON",extension:["json"],imageClass:"file-sprite-text modelDecorationSprite"},{id:"application/xml","extends":"text/plain",name:"XML",extension:["xml"],imageClass:"file-sprite-xml modelDecorationSprite"},{id:"application/x-ejs","extends":"text/plain",name:"Embedded Javascript",extension:["ejs"],imageClass:"file-sprite-javascript modelDecorationSprite"},{id:"text/x-java-source","extends":"text/plain",name:"Java",extension:["java"]},{id:"application/x-jsp",
"extends":"text/plain",name:"Java Server Page",extension:["jsp"]},{id:"text/x-jade","extends":"text/plain",name:"Jade",extension:["jade"]},{id:"text/x-python","extends":"text/plain",name:"Python",extension:"py rpy pyw cpy SConstruct Sconstruct sconstruct SConscript gyp gypi".split(" ")},{id:"text/x-ruby","extends":"text/plain",name:"Ruby",extension:"rb rbx rjs Rakefile rake cgi fcgi gemspec irbrc capfile ru prawn Gemfile Guardfile Vagrantfile Appraisals Rantfile".split(" ")},{id:"text/x-go",name:"Go",
extension:["go"],"extends":"text/plain"},{id:"text/x-launch","extends":"application/json",name:"Launch file",extension:["launch"]},{id:"text/x-objective-c","extends":"text/plain",name:"Objective-C",extension:["m","mm","h"]},{id:"text/x-php","extends":"text/plain",name:"PHP",extension:"php php3 php4 php5 phpt phtml aw ctp".split(" ")},{id:"text/x-swift","extends":"text/plain",name:"Swift",extension:["swift"]},{id:"text/x-markdown","extends":"text/plain",name:"Markdown",extension:["md"]},{id:"text/x-yaml",
"extends":"text/plain",name:"YAML",extension:["yaml","yml"]},{id:"text/conf","extends":"text/plain",name:"Conf",extension:["conf"]},{id:"text/sh","extends":"text/plain",name:"sh",extension:["sh"]},{id:"application/browser-renderable",name:"browser-renderable"},{id:"application/pdf","extends":"application/browser-renderable",name:"PDF",extension:["pdf"]},{id:"application/octet-stream",name:"octet-stream",extension:["exe","bin","doc","ppt"]},{id:"application/zip","extends":"application/octet-stream",
name:"ZIP",extension:["war","jar","zip","rar"]},{id:"text/x-arduino","extends":"text/x-csrc",name:"Arduino",extension:["ino","pde"]},{id:"text/x-csrc","extends":"text/plain",name:"C",extension:["c","h"]},{id:"text/x-csharp","extends":"text/plain",name:"C#",extension:["cs"]},{id:"text/x-cshtml","extends":"text/plain",name:"cshtml",extension:["cshtml"]},{id:"text/x-c++src","extends":"text/plain",name:"C++",extension:["cpp","hpp"]},{id:"text/x-dockerfile","extends":"text/plain",name:"dockerfile",filename:["dockerfile"]},
{id:"text/x-erlang","extends":"text/plain",name:"Erlang",extension:["erl","hrl"]},{id:"text/x-haml","extends":"text/plain",name:"Haml",extension:["haml"]},{id:"text/x-lua","extends":"text/plain",name:"Lua",extension:["lua"]},{id:"application/xquery","extends":"text/plain",name:"XQuery",extension:["xq","xqy","xquery"]},{id:"text/x-vb","extends":"text/plain",name:"VB.NET",extension:["vb"]},{id:"text/x-vbhtml","extends":"text/plain",name:"vbhtml",extension:["vbhtml"]},{id:"image/gif",name:"GIF",extension:["gif"],
imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/jpeg",name:"JPG",extension:["jpg","jpeg","jpe"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/ico",name:"ICO",extension:["ico"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/png",name:"PNG",extension:["png"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/tiff",name:"TIFF",extension:["tif","tiff"],imageClass:"file-sprite-image modelDecorationSprite"},{id:"image/svg",name:"SVG",extension:["svg"],
imageClass:"file-sprite-image modelDecorationSprite"}],SyntaxHighlighter:F}});
define("orion/contentTypes",[],function(){function k(b,a){if("string"!==typeof b)return null;var d=null,c;c=b.indexOf(".");c++;for(var g=b.substring(c).toLowerCase(),f=0;f<a.length;f++){c=a[f];if(0<=c.filename.indexOf(b)){d=c;break}-1!==c.extension.indexOf(g)&&(d=c)}if(!d)for(c=g.indexOf(".");!d&&0<=c;){c++;g=g.substring(c);for(f=0;f<a.length;f++)if(c=a[f],-1!==c.extension.indexOf(g)){d=c;break}c=g.indexOf(".")}return d}function m(b){return null===b||"undefined"===typeof b?[]:Array.isArray(b)?b:[b]}
function e(b){return m(b).map(function(a){return String.prototype.toLowerCase.call(a)})}function c(b){return{id:b.id,name:b.name,image:b.image,imageClass:b.imageClass,"extends":b["extends"],extension:e(b.extension),filename:m(b.filename)}}function g(b){var a=Object.create(null);b.map(c).forEach(function(b){Object.prototype.hasOwnProperty.call(a,b.id)||(a[b.id]=b)});return a}function d(b){if(b&&b.registerService){this.serviceRegistry=b;for(var a=b.getServiceReferences(n).concat(b.getServiceReferences(l)),
d=[],c=0;c<a.length;c++)for(var p=m(a[c].getProperty("contentTypes")),e=0;e<p.length;e++)d.push(p[e]);this.map=g(d);b.registerService(f,this)}else if(Array.isArray(b))this.serviceRegistry=null,this.map=g(b);else throw Error("Invalid parameter");}var f="orion.core.contentTypeRegistry",n="orion.core.contenttype",l="orion.file.contenttype";d.prototype={getContentTypes:function(){var b=this.getContentTypesMap(),a=[],d;for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&a.push(b[d]);return a},getContentTypesMap:function(){return this.map},
getFileContentType:function(b){return k(b.Name,this.getContentTypes())},getFilenameContentType:function(b){return k(b,this.getContentTypes())},getContentType:function(b){return this.map[b]||null},isExtensionOf:function(b,a){b="string"===typeof b?this.getContentType(b):b;a="string"===typeof a?this.getContentType(a):a;if(!b||!a)return!1;if(b.id===a.id)return!0;for(var d=b,c={};d&&(d=this.getContentType(d["extends"]));){if(d.id===a.id)return!0;if(c[d.id])throw Error("Cycle: "+d.id);c[d.id]=!0}return!1},
isSomeExtensionOf:function(b,a){for(var d=0;d<a.length;d++)if(this.isExtensionOf(b,a[d]))return!0;return!1}};return{ContentTypeRegistry:d,isImage:function(b){switch(b&&b.id){case "image/jpeg":case "image/png":case "image/gif":case "image/ico":case "image/tiff":case "image/svg":return!0}return!1},isBinary:function(b){return!b?!1:"application/octet-stream"===b.id||"application/octet-stream"===b["extends"]},getFilenameContentType:k}});define("orion/compare/nls/messages",{root:!0});
define("orion/compare/nls/root/messages",{CpCurChangeRightToLeft:"Copy current change from right to left",CpCurChangeLeftToRight:"Copy current change from left to right","Switch to unified diff":"Switch to unified diff",Unified:"Unified","Switch to side by side diff":"Switch to side by side diff","Side by side":"Side by side",GenerateCurDiffLink:"Generate link of the current diff","Generate Link":"Generate Link","Next diff block":"Next diff block","Previous diff block":"Previous diff block","Next diff change":"Next diff change",
"Previous diff change":"Previous diff change","Copy the link URL:":"Copy the link URL:",Compare:"Compare","Open the compare page":"Open the compare page","fetching...":"fetching...","There are unsaved changes.":"There are unsaved changes.","ERROR: ":"ERROR: ","Compare...":"Compare...","n of t files changed":"${0} of ${1} files changed",Location:"Location",Options:"Options","Sort by folders":"Sort by folders","Line 0 : Col 0":"Line 0 : Col 0",NoDiffServiceLocationMatched:"No Matching DiffService for location:",
NoFoldersIdentical:"${0} files compared. The two folders are identical.",generatingTreeResult:"Generating compare result...",fetchingFolder:"Fetching folder: ${0}...",readingFile:"Reading file: ${0}...",readingFileMetadata:"Reading file metadata: ${0}...",comparingFile:"Comparing: ${0}...",compareTreeTitle:"Compare Folders",IgnoreWhitespace:"Ignore white space",IgnoreWhitespaceTooltip:"Ignore white space where applicable",UseWhitespace:"Use white space",UseWhitespaceTooltip:"Compare white space where applicable",
confirmUnsavedChanges:"There are unsaved changes. Do you want to save them?","word added":"word added","word deleted":"word deleted"});
define("orion/compare/diffParser",[],function(){var k=k||{};k.DiffParser=function(){function k(c,g){this._lineDelimiter=c?c:e?"\r\n":"\n";this._diffLineDelimiter=g?g:this._lineDelimiter;this._DEBUG=!1}var e=-1!==window.navigator.platform.indexOf("Win");k.prototype={_init:function(){this._oFileContents=[];this._diffContents=[];this._oBlocks=[];this._nBlocks=[];this._hunkRanges=[];this._lastToken=" ";this._deltaMap=[];this._nFileContents=[];this._nNewLineAtEnd=this._oNewLineAtEnd=!0;this._diffContentIndex=
1},getOriginalBlocks:function(){return this._oBlocks},getNewBlocks:function(){return this._nBlocks},setLineDelim:function(c){this._diffLineDelimiter=this._lineDelimiter=c},getDiffArray:function(){return{array:this._diffContents,index:this._diffContentIndex}},parse:function(c,g,d,f){this._init();if(""===g)return{outPutFile:c,mapper:[]};this._oFileContents=""===c?[]:c.split(this._lineDelimiter);this._diffContents=g.split(this._diffLineDelimiter);g=this._diffContents.length;this._hunkRanges=[];for(var e=
0;e<g;e++){var l=this._parseHunkRange(e);l&&this._hunkRanges.push(l)}if(0===this._hunkRanges.length)return{outPutFile:c,mapper:[]};this._DEBUG&&(console.log("***Diff contents: \n"),this._diffContents.forEach(function(b){console.log(b)}),console.log("***Hunk ranges: \n"),console.log(JSON.stringify(this._hunkRanges)));for(c=0;c<this._hunkRanges.length;c++)this._parseHunkBlock(c);this._DEBUG&&(console.log("***Original Hunk range blocks: \n"),console.log(JSON.stringify(this._oBlocks)),console.log("***New Hunk range blocks: \n"),
console.log(JSON.stringify(this._nBlocks)));this._buildMap(d);this._DEBUG&&(console.log("***New Line at end of file(original): \n"),console.log(JSON.stringify(this._oNewLineAtEnd)),console.log("***New Line at end of file(new): \n"),console.log(JSON.stringify(this._nNewLineAtEnd)),console.log("***Mapper: \n"),this._logMap(),console.log("***Total line number in original file: "+this._oFileContents.length));f||this._buildNewFile();return{outPutFile:this._nFileContents.join(this._diffLineDelimiter),mapper:this._deltaMap}},
_logMap:function(){for(var c=0;c<this._deltaMap.length;c++)if(console.log(JSON.stringify(this._deltaMap[c])),0<this._deltaMap[c][2]){console.log("    **Diff content on change/add: \n");for(var g=0;g<this._deltaMap[c][0];g++)console.log("    "+this._diffContents[this._deltaMap[c][2]+g-1])}},_logNewFile:function(){for(var c=0;c<this._nFileContents.length;c++)console.log(this._nFileContents[c])},_createBlock:function(c,g,d,f){f===d&&" "===c||(d=[d,f-d,"s"],"-"===c?d[2]="r":"+"===c?d[2]="a":"c"===c&&
(d[2]="c"),g.push(d))},_createMinusBlock:function(c,g,d,f){var e=this._oBlocks.length;0===e||c!==this._oBlocks[e-1][0]?(this._oBlocks.push([0===c?1:c,d,f]),this._nBlocks.push([g,0,-2])):(this._oBlocks[e-1][1]+=d,this._oBlocks[e-1][2]=f)},_createPlusBlock:function(c,g,d,f){var e=this._nBlocks.length;0===e||g!==this._nBlocks[e-1][0]?(this._oBlocks.push([0===c?1:c,0]),this._nBlocks.push([g,d,f])):(this._nBlocks[e-1][1]+=d,this._nBlocks[e-1][2]=f)},_parseHunkBlock:function(c){for(var g=" ",d=this._hunkRanges[c][0]+
1,f=c===this._hunkRanges.length-1?this._diffContents.length:this._hunkRanges[c+1][0],e=0,l=0,b=this._hunkRanges[c][1],a=this._hunkRanges[c][3],k=d,h=d,p=d;p<f;p++)if(0!==this._diffContents[p].length){var r=this._diffContents[p][0];if("\\"===r&&("\\ No newline at end of file"===this._diffContents[p].substring(0,this._diffContents[p].length-1)||"\\ No newline at end of file"===this._diffContents[p]))"-"===g?this._oNewLineAtEnd=!1:" "===g?this._oNewLineAtEnd=this._nNewLineAtEnd=!1:this._nNewLineAtEnd=
!1,p>d&&"\r"===this._diffContents[p-1][this._diffContents[p-1].length-1]&&(this._diffContents[p-1]=this._diffContents[p-1].substring(0,this._diffContents[p-1].length-1));else{switch(r){case "-":case "+":case " ":break;default:continue}if(g!==r){"+"===r&&(k=p);"-"===r&&(h=p);switch(g){case " ":b=this._hunkRanges[c][1]+e;a=this._hunkRanges[c][3]+l;break;case "-":this._createMinusBlock(b,a,this._hunkRanges[c][1]+e-b,h);break;case "+":this._createPlusBlock(b,a,this._hunkRanges[c][3]+l-a,k)}g=r}switch(r){case "-":e++;
break;case "+":l++;break;case " ":e++,l++}}}switch(g){case "-":this._createMinusBlock(b,a,this._hunkRanges[c][1]+e-b,h);break;case "+":this._createPlusBlock(b,a,this._hunkRanges[c][3]+l-a,k)}},_detectConflictes:function(c,g){if(0>c)return!1;for(var d=c+g,f=c;f<d;f++){var e=this._diffContents[f];if(-1<e.indexOf("\x3c\x3c\x3c\x3c\x3c")||-1<e.indexOf("\x3e\x3e\x3e\x3e\x3e"))return!0}return!1},_buildMap:function(c){var g=this._oBlocks.length,d=this._oFileContents.length,f=0,e;e=1;for(var l=0;l<g;l++)e=
this._oBlocks[l][0]-e,0<e&&(this._deltaMap.push([e,e,0]),f+=e),c&&this._detectConflictes(this._nBlocks[l][2],this._nBlocks[l][1])?this._deltaMap.push([this._nBlocks[l][1],this._oBlocks[l][1],this._nBlocks[l][2]+1,1]):this._deltaMap.push([this._nBlocks[l][1],this._oBlocks[l][1],this._nBlocks[l][2]+1]),f+=this._oBlocks[l][1],e=this._oBlocks[l][0]+this._oBlocks[l][1];0<d-e&&(this._deltaMap.push([d-e+1,d-e+1,0]),f+=d-e+1);f<d&&(e=d-f,c=this._deltaMap[this._deltaMap.length-1],0===c[2]?(c[0]+=e,c[1]+=e):
-1===c[2]?this._deltaMap.push([e,e,0]):this._nNewLineAtEnd===this._oNewLineAtEnd?this._deltaMap.push([e,e,0]):(this._nNewLineAtEnd&&(c[0]+=e),this._oNewLineAtEnd&&(c[1]+=e)))},_buildNewFile:function(){var c=1,g=!1,d=this._deltaMap.length,f,e;for(f=0;f<d;f++){g=!1;if(0===this._deltaMap[f][2]){for(e=0;e<this._deltaMap[f][0];e++)this._nFileContents.push(this._oFileContents[c+e-1]);g=!0}else if(0<this._deltaMap[f][2])for(e=0;e<this._deltaMap[f][0];e++)this._nFileContents.push(this._diffContents[this._deltaMap[f][2]+
e-1].substring(1));c+=this._deltaMap[f][1]}this._nNewLineAtEnd&&!g&&this._nFileContents.push("")},_converHRangeBody:function(c,g){if(c){var d=parseInt(c,10);g.push(0<=d?d:1)}else g.push(1)},_parseHunkRange:function(c){var g=this._diffContents[c],d=/^@@\s*\+([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*-([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*@@+/,f=/^@@\s*-([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*\+([\+|\-]*[\d]+)\s*,*\s*([\d]*)\s*@@+/.exec(g),e=null;if(f&&5===f.length)e=[c],this._converHRangeBody(f[1],e),this._converHRangeBody(f[2],
e),this._converHRangeBody(f[3],e),this._converHRangeBody(f[4],e);else if((f=d.exec(g))&&5===f.length)e=[c],this._converHRangeBody(f[3],e),this._converHRangeBody(f[4],e),this._converHRangeBody(f[1],e),this._converHRangeBody(f[2],e);return e}};return k}();return k});
define("orion/URITemplate",[],function(){function k(a){this._text=a}function m(a){return a.replace("%25","%")}function e(a,d){if("U"===d)return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()});if("U+R"===d)return encodeURI(a).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(b,m);if("U+R-,"===d)return encodeURI(a).replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/,/g,"%2C");throw Error("Unknown allowed character set: "+d);}function c(a,b,d){for(var c=
[],g=0;g<a.length;g++)"undefined"!==typeof a[g]&&c.push(e(a[g],b));return c.join(d)}function g(a,b,d,c){for(var g=Object.keys(a),f=[],l=0;l<g.length;l++)"undefined"!==typeof a[g[l]]&&f.push(e(g[l],b)+d+e(a[g[l]],b));return f.join(c)}function d(a){if(0===a.length)throw Error("Invalid Expression: 0 length expression");(this._operator=n[a[0]])?a=a.substring(1):this._operator=n.NUL;for(var b=[],d=a.split(","),c=0;c<d.length;c++){var g=d[c].match(l);if(null===g)throw Error("Bad VarSpec: "+a);b.push({name:g[1],
explode:!!g[2],prefix:g[3]?parseInt(g[3],10):-1})}this._varSpecList=b}function f(a){for(var b=[],c=0,g=a.indexOf("{",c);-1!==g;){b.push(new k(a.substring(c,g)));c=a.indexOf("}",g+1);if(-1===c)throw Error("Invalid template: "+a);b.push(new d(a.substring(g+1,c)));c+=1;g=a.indexOf("{",c)}b.push(new k(a.substring(c)));this._templateComponents=b}var n={NUL:{first:"",sep:",",named:!1,ifemp:"",allow:"U"},"+":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R"},".":{first:".",sep:",",named:!1,ifemp:"",allow:"U"},
"/":{first:"/",sep:"/",named:!1,ifemp:"",allow:"U"},";":{first:";",sep:";",named:!0,ifemp:"",allow:"U"},"?":{first:"?",sep:"\x26",named:!0,ifemp:"\x3d",allow:"U"},"\x26":{first:"\x26",sep:"\x26",named:!0,ifemp:"\x3d",allow:"U"},"#":{first:"#",sep:",",named:!1,ifemp:"",allow:"U+R"},",":{first:"",sep:",",named:!1,ifemp:"",allow:"U+R-,"}},l=/^((?:(?:[a-zA-Z0-9_])|(?:%[0-9A-F][0-9A-F]))(?:(?:[a-zA-Z0-9_.])|(?:%[0-9A-F][0-9A-F]))*)(?:(\*)|:([0-9]+))?$/,b=/%25[0-9A-F][0-9A-F]/g;k.prototype={expand:function(a){return encodeURI(this._text)}};
d.prototype={expand:function(a){for(var b=[],d=0;d<this._varSpecList.length;d++){var f=this._varSpecList[d],l=f.name,n=a[l],k=typeof n;if("undefined"!==k&&null!==n){var m=0===b.length?this._operator.first:this._operator.sep;if("string"===k)this._operator.named&&(m+=e(l,"U+R"),m+=0===n.length?this._operator.ifemp:"\x3d"),-1!==f.prefix&&f.prefix<n.length&&(n=n.substring(0,f.prefix)),m+=e(n,this._operator.allow);else if(Array.isArray(n)){if(0===n.length)continue;f.explode?m+=c(n,this._operator.allow,
this._operator.sep):(f=c(n,this._operator.allow,","),this._operator.named&&(m+=e(l,"U+R"),m+=0===f.length?this._operator.ifemp:"\x3d"),m+=f)}else if("object"===k){if(0===Object.keys(n).length)continue;f.explode?m+=g(n,this._operator.allow,"\x3d",this._operator.sep):(f=g(n,this._operator.allow,",",","),this._operator.named&&(m+=e(l,"U+R"),m+=0===f.length?this._operator.ifemp:"\x3d"),m+=f)}else throw Error("bad param type: "+l+" : "+k);b.push(m)}}return b.join("")}};f.prototype={expand:function(a){for(var b=
[],d=0;d<this._templateComponents.length;d++)b.push(this._templateComponents[d].expand(a));return b.join("")}};return f});
define("orion/compare/compareUtils",["orion/URITemplate"],function(k){var m=m||{};m.compareUtils=m.compareUtils||{};m.compareUtils.lookUpMapper=function(e,c,g){for(var d=0,f=0;f<e.length;f++){var n=e[f][c];0===n&&(n=1);if(g>=d&&g<d+n)return{mapperIndex:f,startFrom:d};if(f===e.length-1)break;d+=e[f][c]}return{mapperIndex:e.length-1,startFrom:d}};m.compareUtils.lookUpLineIndex=function(e,c,g){if(0===g)return 0;for(var d=0,f=0;f<g;f++)d+=e[f][c];return d};m.compareUtils.updateMapper=function(e,c,g,d,
f){if(d!==f&&(0<d||0<f)){var n=m.compareUtils.lookUpMapper(e,c,g);if(!(0>n.mapperIndex)){if(0<d){var l=g-n.startFrom;for(g=n.mapperIndex;g<e.length;g++){l=e[g][c]-l;if(d<=l){e[g][c]-=d;break}e[g][c]-=l;d-=l;l=0}}0<f&&(e[n.mapperIndex][c]+=f)}}};m.compareUtils.overlapMapper=function(e,c,g,d,f){e=g+e[c]-1;e<g&&(e=g);f<d&&(f=d);return e<d||f<g?!1:!0};m.compareUtils.findFirstDiff=function(e,c,g,d){for(var f=0,n=null,l=0;l<e.length&&!(f>d)&&(!m.compareUtils.overlapMapper(e[l],c,f,g,d)||!(n={mapperIndex:l,
startFrom:f},0!==e[l][2]));l++)f+=e[l][c];return n};m.compareUtils.matchMapper=function(e,c,g,d){if(0===e.length)return g;var f=g+Math.round((d-g)/3),n=m.compareUtils.findFirstDiff(e,c,g,d),l=0===e[n.mapperIndex][c]?n.startFrom:n.startFrom+e[n.mapperIndex][c]-1,b=m.compareUtils.lookUpLineIndex(e,1-c,n.mapperIndex),a=n.startFrom-g;return 0===e[n.mapperIndex][2]?b-a:f>=n.startFrom&&f<=l?b-Math.round((d-g)/3):f<n.startFrom?b-a:(0===e[n.mapperIndex][1-c]?b:b+e[n.mapperIndex][1-c]-1)-(l-g)};m.compareUtils.getMapperLineCount=
function(e){for(var c=0,g=0;g<e.length;g++)c+=Math.max(e[g][0],e[g][1]);return c};m.compareUtils.getAnnotationIndex=function(e,c){for(var g=0;g<e.length;g++)if(e[g][0]===c)return g;return-1};m.compareUtils.getAnnotationMapperIndex=function(e,c){return e[c][1]};m.compareUtils.getAnnotationIndexByMapper=function(e,c){for(var g=0;g<e.length;g++)if(e[g][1]===c)return{current:g,prev:g-1,next:g+1};return{current:-1,prev:-1,next:-1}};m.compareUtils.isMapperConflict=function(e,c){return 0>c||!e[c][3]?!1:
1===e[c][3]};m.compareUtils.mergeDiffBlocks=function(e,c,g,d,f,n){for(var l=0;l<c.length;l++){var b=c[l][0],a=g[c[l][1]];if(0<a[0]){for(var k="",h=0;h<a[0];h++)var p=d[a[2]-1+h],k=p?k+p.substring(f)+n:k+n;a=e.getLineCount();b>=a&&(b=e.getLineEnd(a-1),h=e.getLineEnd(a-1,!0),b===h?(e.setText(n,b,b),b=a):b=a-1);b=e.getLineStart(b);e.setText(k,b,b)}}};m.compareUtils.convertMergedLineNumber=function(e,c,g){var d=m.compareUtils.lookUpMapper(e,g?1:0,c);!g&&0!==e[d.mapperIndex][2]&&(c+=e[d.mapperIndex][1]);
if(0>d.mapperIndex)return c;for(var f=0;f<d.mapperIndex;f++)0!==e[f][2]&&(c+=e[f][g?0:1]);return c};m.compareUtils.generateCompareHref=function(e,c){c.conflict||(c.conflict=void 0);c.readonly||(c.readonly=void 0);return(new k("../compare/compare.html#{,resource,params*}")).expand({resource:e,params:c})};m.compareUtils.generateCompareTreeHref=function(e,c){return(new k("../compare-tree/compare-tree.html#{,resource,params*}")).expand({resource:e,params:c})};m.compareUtils.fullNameByMeta=function(e){var c=
e.Parents,g=c.length,d="";if(0<g)for(var f=g-1;-1<f;f--)g=""===d?"":"/",d=d+g+c[f].Name;return d=d+(""===d?"":"/")+e.Name};return m.compareUtils});
define("orion/compare/compareRulers",["orion/compare/compareUtils"],function(k){var m=m||{};m.CompareRuler=function(){function e(c,g,d){this._location=c||"left";this._overview=g||"page";this._rulerStyle=d;this._editor=null;var f=this;this._listener={onModelChanged:function(d){f._onModelChanged(d)}}}e.prototype={setView:function(c){this._onModelChanged&&this._editor&&this._editor.removeEventListener("ModelChanged",this._listener.onModelChanged);this._editor=c;this._onModelChanged&&this._editor&&this._editor.addEventListener("ModelChanged",
this._listener.onModelChanged)},getLocation:function(){return this._location},getOverview:function(c){return this._overview},getAnnotationModel:function(){return null},addAnnotationType:function(c){},isAnnotationTypeVisible:function(c){return!1},removeAnnotationType:function(c){},setAnnotationModel:function(c){},getAnnotations:function(c,g){for(var d=[],f=c;f<g;f++){var e=this.getStyle(f);e&&(d[f]={html:this.getHTML(f),style:e})}return d},getWidestAnnotation:function(){return{html:this.getHTML(-1),
style:this.getStyle(-1)}},getRulerStyle:function(){return this.getStyle(void 0)}};return e}();m.LineNumberCompareRuler=function(){function e(c,g,d,f,e,l){m.CompareRuler.call(this,d,"page",f);this._diffNavigator=c;this._oddStyle=e||{style:{backgroundColor:"white"}};this._evenStyle=l||{style:{backgroundColor:"white"}};this._numOfDigits=0;this._mapperColumnIndex=g}e.prototype=new m.CompareRuler;e.prototype.getStyle=function(c){return void 0===c?this._rulerStyle:this._evenStyle};e.prototype.getHTML=function(c){var g=
this._editor.getModel(),d=this._diffNavigator.getFeeder(0===this._mapperColumnIndex);return!d?"":-1===c?g.getLineCount():d.getLineNumber?(c=d.getLineNumber(c),-1===c?"":c+1):c+1};e.prototype._onModelChanged=function(c){var g=c.start,d=this._editor.getModel();c=d.getLineCount();var f=(c+"").length;this._numOfDigits!==f&&(this._numOfDigits=f,g=d.getLineAtOffset(g),this._editor.redrawLines(g,c,this))};return e}();m.CompareOverviewRuler=function(){function e(c,g,d,f){this._diffNavigator=d;this._onClick=
f;m.CompareRuler.call(this,c,"document",g)}e.prototype=new m.CompareRuler;e.prototype.getStyle=function(c){var g,d;if(void 0===c)g=this._rulerStyle||{},d=g.style||(g.style={}),d.lineHeight="1px",d.fontSize="1px",d.width="14px";else if(g=-1!==c?{styleClass:"annotationOverview breakpoint"}:{},d=g.style||(g.style={}),d.cursor="pointer",d.width="8px",d.left="2px",0<=c){var f;if(this._diffNavigator&&this._diffNavigator.getFeeder())f=this._diffNavigator.getFeeder().getDiffBlocks();else return null;c=k.getAnnotationIndex(f,
c);if(-1===c)return null;f=k.getAnnotationMapperIndex(f,c);var e;e=this._diffNavigator.getMapper();if(f=k.isMapperConflict(e,f))d.border="1px #FF0000 solid";c===this._diffNavigator.getCurrentBlockIndex()&&(d.backgroundColor=f?"red":"blue");c=this._diffNavigator.getFeeder().getDiffBlockH(c);f=this._diffNavigator.getFeeder().getOverviewLineCount();if(0>c)return null;e=this._editor.getClientArea();c=Math.floor(e.height*c/f);2>c&&(c=2);d.height=c+"px"}else return null;return g};e.prototype.setDiffNavigator=
function(c){this._diffNavigator=c};e.prototype.getHTML=function(c){return"\x26nbsp;"};e.prototype.onClick=function(c,g){void 0!==c&&this._onClick(c,this)};e.prototype._onModelChanged=function(c){0<this._editor.getModel().getLineCount()&&this._editor.redrawLines(0,1,this)};return e}();m.CompareCurveRuler=function(){function e(c){this._canvasDiv=c;this._mapper=void 0}e.prototype={init:function(c,g,d,f){this._rightIniting=this._rightIniting=this._leftIniting=!0;this._mapper=c;this._leftEditor=g;this._rightEditor=
d;this._leftTextView=g.getTextView();this._rightTextView=d.getTextView();this._diffNavigator=f;this.render()},matchPositionFrom:function(c){var g=c?this._leftTextView:this._rightTextView,d=c?this._rightTextView:this._leftTextView,f=g.getTopIndex(),g=g.getBottomIndex();c=k.matchMapper(this._mapper,c?0:1,f,g);d.setTopIndex(c)},copyTo:function(c){if(this._diffNavigator.iterator){var g=this._diffNavigator.iterator.cursor();if(g&&("word"===g.type?!g.copied&&!g.parent.copied:!g.copied)){var d=c?this._rightTextView.getText(g.oldA.start,
g.oldA.end):this._leftTextView.getText(g.newA.start,g.newA.end),f=c?g.newA:g.oldA;(c?this._leftTextView:this._rightTextView).setText(d,f.start,f.end);g.copied=!0}}},render:function(){if(this._mapper){var c=this._canvasDiv.getContext("2d");c.clearRect(0,0,this._canvasDiv.width,this._canvasDiv.height);c.strokeStyle="#AAAAAA";c.lineWidth=1;c.beginPath();var g=this._leftTextView.getTopIndex(),d=this._leftTextView.getBottomIndex(),f=this._rightTextView.getTopIndex(),e=this._rightTextView.getBottomIndex();
this._leftLineH=this._leftTextView.getLineHeight();this._rightLineH=this._rightTextView.getLineHeight();for(var l=0,b=0,a=!1,q=0;q<this._mapper.length;q++){if(0!==this._mapper[q][2])if(k.overlapMapper(this._mapper[q],0,l,g,d)||k.overlapMapper(this._mapper[q],1,b,f,e))this._renderCurve(q,l,b,this._canvasDiv,c,g,d,f,e),a=!0;else if(a)break;l+=this._mapper[q][0];b+=this._mapper[q][1]}c.stroke()}},_renderCurve:function(c,g,d,f,e,l,b,a,k){l=this._mapper[c];g=this._leftTextView.getLinePixel(g+l[0]/2)+l[0]%
2*this._leftLineH/3-this._leftTextView.getTopPixel();d=this._rightTextView.getLinePixel(d+l[1]/2)+l[1]%2*this._rightLineH/3-this._rightTextView.getTopPixel();f=f.parentNode.clientWidth;c===this._diffNavigator.getCurrentMapperIndex()?(e.stroke(),e.strokeStyle="#000",e.lineWidth=1,e.beginPath(),e.moveTo(0,g),e.bezierCurveTo(f/3,g,0.666*f,d,f,d),e.stroke(),e.strokeStyle="#AAAAAA",e.lineWidth=1,e.beginPath()):(e.moveTo(0,g),e.bezierCurveTo(f/3,g,0.666*f,d,f,d),e.stroke())},onChanged:function(c,g){var d=
g?this._rightIniting:this._leftIniting;if(c.removedLineCount!==c.addedLineCount){var f=g?this._rightTextView:this._leftTextView;d||k.updateMapper(this._mapper,g?1:0,f.getModel().getLineAtOffset(c.start),c.removedLineCount,c.addedLineCount);(0<c.removedLineCount||0<c.addedLineCount)&&this.render()}g?this._rightIniting=!1:this._leftIniting=!1;return d}};return e}();return m});
define("orion/regex",[],function(){return{escape:function(k){return k.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$\x26")},parse:function(k){return(k=/^\s*\/(.+)\/([gim]{0,3})\s*$/.exec(k))?{pattern:k[1],flags:k[2]}:null}}});
define("orion/editor/textModel",["orion/editor/eventTarget","orion/regex","orion/util"],function(k,m,e){function c(c,d){this._lastLineIndex=-1;this._text=[""];this._lineOffsets=[0];this.setText(c);this.setLineDelimiter(d)}c.prototype={destroy:function(){},find:function(c){1<this._text.length&&(this._text=[this._text.join("")]);var d=c.string,f=c.regex,e=d,l="",b=c.caseInsensitive;if(e)if(f){if(d=m.parse(e))e=d.pattern,l=d.flags}else e=d.replace(/([\\$\^*\/+?\.\(\)|{}\[\]])/g,"\\$\x26"),b&&(e=e.replace(/[iI\u0130\u0131]/g,
"[Ii\u0130\u0131]"));var a=null,k;if(e){var d=c.reverse,h=c.wrap,f=c.wholeWord,p=c.start||0;c=c.end;var r=null!==c&&void 0!==c;-1===l.indexOf("g")&&(l+="g");-1===l.indexOf("m")&&(l+="m");b&&-1===l.indexOf("i")&&(l+="i");f&&(e="\\b"+e+"\\b");var u=this._text[0],v,w,t=0;r&&(b=p<c?p:c,u=u.substring(b,p<c?c:p),t=b);var A=RegExp(e,l);d?k=function(){var a=null;for(A.lastIndex=0;;){w=A.lastIndex;v=A.exec(u);if(w===A.lastIndex)return null;if(v){if(!(v.index+t<p)){if(!h||a)break;p=u.length+t}a={start:v.index+
t,end:A.lastIndex+t}}else break}a&&(p=a.start);return a}:(r||(A.lastIndex=p),k=function(){for(;;){w=A.lastIndex;v=A.exec(u);if(w===A.lastIndex)break;if(v)return{start:v.index+t,end:A.lastIndex+t};if(!(0!==w&&h))break}return null});a=k()}return{next:function(){var b=a;b&&(a=k());return b},hasNext:function(){return null!==a}}},getCharCount:function(){for(var c=0,d=0;d<this._text.length;d++)c+=this._text[d].length;return c},getLine:function(c,d){var f=this.getLineCount();if(!(0<=c&&c<f))return null;
var e=this._lineOffsets[c];if(c+1<f){f=this.getText(e,this._lineOffsets[c+1]);if(d)return f;for(var e=f.length,l;10===(l=f.charCodeAt(e-1))||13===l;)e--;return f.substring(0,e)}return this.getText(e)},getLineAtOffset:function(c){var d=this.getCharCount();if(!(0<=c&&c<=d))return-1;var f=this.getLineCount();if(c===d)return f-1;var e,l,b=this._lastLineIndex;if(0<=b&&b<f&&(e=this._lineOffsets[b],l=b+1<f?this._lineOffsets[b+1]:d,e<=c&&c<l))return b;for(var a=f,k=-1;1<a-k;)if(b=Math.floor((a+k)/2),e=this._lineOffsets[b],
l=b+1<f?this._lineOffsets[b+1]:d,c<=e)a=b;else if(c<l){a=b;break}else k=b;return this._lastLineIndex=a},getLineCount:function(){return this._lineOffsets.length},getLineDelimiter:function(){return this._lineDelimiter},getLineEnd:function(c,d){var f=this.getLineCount();if(!(0<=c&&c<f))return-1;if(c+1<f){f=this._lineOffsets[c+1];if(d)return f;for(var e=this.getText(Math.max(this._lineOffsets[c],f-2),f),l=e.length,b;10===(b=e.charCodeAt(l-1))||13===b;)l--;return f-(e.length-l)}return this.getCharCount()},
getLineStart:function(c){return!(0<=c&&c<this.getLineCount())?-1:this._lineOffsets[c]},getText:function(c,d){void 0===c&&(c=0);void 0===d&&(d=this.getCharCount());if(c===d)return"";for(var f=0,e=0,l;e<this._text.length;){l=this._text[e].length;if(c<=f+l)break;f+=l;e++}for(var b=f,a=e;e<this._text.length;){l=this._text[e].length;if(d<=f+l)break;f+=l;e++}if(a===e)return this._text[a].substring(c-b,d-f);b=this._text[a].substring(c-b);f=this._text[e].substring(0,d-f);return b+this._text.slice(a+1,e).join("")+
f},onChanging:function(c){return this.dispatchEvent(c)},onChanged:function(c){return this.dispatchEvent(c)},setLineDelimiter:function(c,d){"auto"===c&&(c=void 0,1<this.getLineCount()&&(c=this.getText(this.getLineEnd(0),this.getLineEnd(0,!0))));this._lineDelimiter=c?c:e.platformDelimiter;if(d){var f=this.getLineCount();if(1<f){for(var n=Array(f),l=0;l<f;l++)n[l]=this.getLine(l);this.setText(n.join(this._lineDelimiter))}}},setText:function(c,d,f){void 0===c&&(c="");void 0===d&&(d=0);void 0===f&&(f=
this.getCharCount());if(!(d===f&&""===c)){for(var e=this.getLineAtOffset(d),l=this.getLineAtOffset(f),b=d,a=f-d,k=l-e,h=c.length,p=0,r=this.getLineCount(),u=0,v=0,m=0,t=[];;){-1!==u&&u<=m&&(u=c.indexOf("\r",m));-1!==v&&v<=m&&(v=c.indexOf("\n",m));if(-1===v&&-1===u)break;m=-1!==u&&-1!==v?u+1===v?v+1:(u<v?u:v)+1:-1!==u?u+1:v+1;t.push(d+m);p++}this.onChanging({type:"Changing",text:c,start:b,removedCharCount:a,addedCharCount:h,removedLineCount:k,addedLineCount:p});0===t.length&&(m=this.getLineStart(e),
l=l+1<r?this.getLineStart(l+1):this.getCharCount(),d!==m&&(c=this.getText(m,d)+c,d=m),f!==l&&(c+=this.getText(f,l),f=l));m=h-a;for(l=e+k+1;l<r;l++)this._lineOffsets[l]+=m;if(5E4>t.length)e=[e+1,k].concat(t),Array.prototype.splice.apply(this._lineOffsets,e);else{m=e+1;this._lineOffsets.splice(m,k);for(r=0;r<t.length;r+=5E4)e=[m,0].concat(t.slice(r,Math.min(t.length,r+5E4))),Array.prototype.splice.apply(this._lineOffsets,e),m+=5E4}for(m=r=0;m<this._text.length;){l=this._text[m].length;if(d<=r+l)break;
r+=l;m++}e=r;for(t=m;m<this._text.length;){l=this._text[m].length;if(f<=r+l)break;r+=l;m++}l=this._text[m];d=this._text[t].substring(0,d-e);f=l.substring(f-r);t=[t,m-t+1];d&&t.push(d);c&&t.push(c);f&&t.push(f);Array.prototype.splice.apply(this._text,t);0===this._text.length&&(this._text=[""]);this.onChanged({type:"Changed",start:b,removedCharCount:a,addedCharCount:h,removedLineCount:k,addedLineCount:p})}}};k.EventTarget.addMixin(c.prototype);return{TextModel:c}});
define("orion/keyBinding",["orion/util"],function(k){function m(c,g,d,f,e,l){this.type=l||"keydown";this.keyCode="string"===typeof c&&"keydown"===this.type?c.toUpperCase().charCodeAt(0):c;this.mod1=void 0!==g&&null!==g?g:!1;this.mod2=void 0!==d&&null!==d?d:!1;this.mod3=void 0!==f&&null!==f?f:!1;this.mod4=void 0!==e&&null!==e?e:!1}function e(c){this.keys=c}m.prototype={getKeys:function(){return[this]},match:function(c,g){if(void 0!==g){if(0!==g)return!1}else if(c instanceof Array){if(1<c.length)return!1;
c=c[0]}return c.type!==this.type?!1:this.keyCode===c.keyCode||this.keyCode===String.fromCharCode(k.isOpera?c.which:void 0!==c.charCode?c.charCode:c.keyCode)?this.mod1!==(k.isMac?c.metaKey:c.ctrlKey)||"keydown"===this.type&&this.mod2!==c.shiftKey||this.mod3!==c.altKey||k.isMac&&this.mod4!==c.ctrlKey?!1:!0:!1},equals:function(c){return!c||this.keyCode!==c.keyCode||this.mod1!==c.mod1||this.mod2!==c.mod2||this.mod3!==c.mod3||this.mod4!==c.mod4||this.type!==c.type?!1:!0}};e.prototype={getKeys:function(){return this.keys.slice(0)},
match:function(c,g){var d=this.keys;if(void 0!==g)return g>d.length?!1:d[g].match(c)?g===d.length-1?!0:g+1:!1;c instanceof Array||(c=[c]);if(c.length>d.length)return!1;var f;for(f=0;f<c.length;f++)if(!d[f].match(c[f]))return!1;return f===d.length?!0:f},equals:function(c){if(!c.keys||c.keys.length!==this.keys.length)return!1;for(var g=0;g<c.keys.length;g++)if(!c.keys[g].equals(this.keys[g]))return!1;return!0}};return{KeyBinding:m,KeyStroke:m,KeySequence:e}});
define("orion/editor/keyModes",["orion/keyBinding","orion/util"],function(k,m){function e(c){c&&(this._view=c,this._keyBindings=this.createKeyBindings(),this._keyBindingIndex=0)}function c(c){e.call(this,c)}e.prototype={createKeyBindings:function(){return[]},getKeyBindings:function(c){for(var d=[],f=this._keyBindings,e=0;e<f.length;e++)f[e].actionID===c&&d.push(f[e].keyBinding);return d},getView:function(){return this._view},isActive:function(){return-1!==this._view.getKeyModes().indexOf(this)},match:function(c){if("keydown"===
c.type)switch(c.keyCode){case 16:case 17:case 18:case 91:return}for(var d=this._keyBindingIndex,f=this._matchingKeyBindings||this._keyBindings,e=[],l=0;l<f.length;l++){var b=f[l],a=b.keyBinding.match(c,d);if(!0===a)return this._keyBindingIndex=0,this._matchingKeyBindings=null,b.actionID;"number"===typeof a&&e.push(b)}if(0===e.length)this._keyBindingIndex=0,this._matchingKeyBindings=null;else return this._keyBindingIndex++,this._matchingKeyBindings=e,"noop"},setKeyBinding:function(c,d){for(var f=this._keyBindings,
e=0;e<f.length;e++){var l=f[e];if(l.keyBinding.equals(c)){d?l.actionID=d:l.predefined?l.actionID="noop":f.splice(e,1);return}}d&&f.push({keyBinding:c,actionID:d})},setView:function(c){this._view=c}};c.prototype=new e;c.prototype.createKeyBindings=function(){var c=k.KeyBinding,d=[];d.push({actionID:"lineUp",keyBinding:new c(38),predefined:!0});d.push({actionID:"lineDown",keyBinding:new c(40),predefined:!0});d.push({actionID:"charPrevious",keyBinding:new c(37),predefined:!0});d.push({actionID:"charNext",
keyBinding:new c(39),predefined:!0});m.isMac?(d.push({actionID:"scrollPageUp",keyBinding:new c(33),predefined:!0}),d.push({actionID:"scrollPageDown",keyBinding:new c(34),predefined:!0}),d.push({actionID:"pageUp",keyBinding:new c(33,null,null,!0),predefined:!0}),d.push({actionID:"pageDown",keyBinding:new c(34,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new c(37,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new c(39,!0),predefined:!0}),d.push({actionID:"wordPrevious",
keyBinding:new c(37,null,null,!0),predefined:!0}),d.push({actionID:"wordNext",keyBinding:new c(39,null,null,!0),predefined:!0}),d.push({actionID:"scrollTextStart",keyBinding:new c(36),predefined:!0}),d.push({actionID:"scrollTextEnd",keyBinding:new c(35),predefined:!0}),d.push({actionID:"textStart",keyBinding:new c(38,!0),predefined:!0}),d.push({actionID:"textEnd",keyBinding:new c(40,!0),predefined:!0}),d.push({actionID:"scrollPageUp",keyBinding:new c(38,null,null,null,!0),predefined:!0}),d.push({actionID:"scrollPageDown",
keyBinding:new c(40,null,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new c(37,null,null,null,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new c(39,null,null,null,!0),predefined:!0}),d.push({actionID:"lineStart",keyBinding:new c(38,null,null,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new c(40,null,null,!0),predefined:!0})):(d.push({actionID:"pageUp",keyBinding:new c(33),predefined:!0}),d.push({actionID:"pageDown",keyBinding:new c(34),predefined:!0}),
d.push({actionID:"lineStart",keyBinding:new c(36),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new c(35),predefined:!0}),d.push({actionID:"wordPrevious",keyBinding:new c(37,!0),predefined:!0}),d.push({actionID:"wordNext",keyBinding:new c(39,!0),predefined:!0}),d.push({actionID:"textStart",keyBinding:new c(36,!0),predefined:!0}),d.push({actionID:"textEnd",keyBinding:new c(35,!0),predefined:!0}));m.isFirefox&&m.isLinux&&(d.push({actionID:"lineUp",keyBinding:new c(38,!0),predefined:!0}),d.push({actionID:"lineDown",
keyBinding:new c(40,!0),predefined:!0}));m.isWindows&&(d.push({actionID:"scrollLineUp",keyBinding:new c(38,!0),predefined:!0}),d.push({actionID:"scrollLineDown",keyBinding:new c(40,!0),predefined:!0}));d.push({actionID:"selectLineUp",keyBinding:new c(38,null,!0),predefined:!0});d.push({actionID:"selectLineDown",keyBinding:new c(40,null,!0),predefined:!0});d.push({actionID:"selectCharPrevious",keyBinding:new c(37,null,!0),predefined:!0});d.push({actionID:"selectCharNext",keyBinding:new c(39,null,!0),
predefined:!0});d.push({actionID:"selectPageUp",keyBinding:new c(33,null,!0),predefined:!0});d.push({actionID:"selectPageDown",keyBinding:new c(34,null,!0),predefined:!0});m.isMac?(d.push({actionID:"selectLineStart",keyBinding:new c(37,!0,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new c(39,!0,!0),predefined:!0}),d.push({actionID:"selectWordPrevious",keyBinding:new c(37,null,!0,!0),predefined:!0}),d.push({actionID:"selectWordNext",keyBinding:new c(39,null,!0,!0),predefined:!0}),
d.push({actionID:"selectTextStart",keyBinding:new c(36,null,!0),predefined:!0}),d.push({actionID:"selectTextEnd",keyBinding:new c(35,null,!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new c(38,!0,!0),predefined:!0}),d.push({actionID:"selectTextEnd",keyBinding:new c(40,!0,!0),predefined:!0}),d.push({actionID:"selectLineStart",keyBinding:new c(37,null,!0,null,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new c(39,null,!0,null,!0),predefined:!0}),d.push({actionID:"selectLineStart",
keyBinding:new c(38,null,!0,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new c(40,null,!0,!0),predefined:!0})):(m.isLinux&&(d.push({actionID:"selectWholeLineUp",keyBinding:new c(38,!0,!0),predefined:!0}),d.push({actionID:"selectWholeLineDown",keyBinding:new c(40,!0,!0),predefined:!0})),d.push({actionID:"selectLineStart",keyBinding:new c(36,null,!0),predefined:!0}),d.push({actionID:"selectLineEnd",keyBinding:new c(35,null,!0),predefined:!0}),d.push({actionID:"selectWordPrevious",
keyBinding:new c(37,!0,!0),predefined:!0}),d.push({actionID:"selectWordNext",keyBinding:new c(39,!0,!0),predefined:!0}),d.push({actionID:"selectTextStart",keyBinding:new c(36,!0,!0),predefined:!0}),d.push({actionID:"selectTextEnd",keyBinding:new c(35,!0,!0),predefined:!0}));d.push({actionID:"undo",keyBinding:new k.KeyBinding("z",!0),predefined:!0});m.isMac?d.push({actionID:"redo",keyBinding:new k.KeyBinding("z",!0,!0),predefined:!0}):d.push({actionID:"redo",keyBinding:new k.KeyBinding("y",!0),predefined:!0});
d.push({actionID:"deletePrevious",keyBinding:new c(8),predefined:!0});d.push({actionID:"deletePrevious",keyBinding:new c(8,null,!0),predefined:!0});d.push({actionID:"deleteNext",keyBinding:new c(46),predefined:!0});d.push({actionID:"deleteWordPrevious",keyBinding:new c(8,!0),predefined:!0});d.push({actionID:"deleteWordPrevious",keyBinding:new c(8,!0,!0),predefined:!0});d.push({actionID:"deleteWordNext",keyBinding:new c(46,!0),predefined:!0});d.push({actionID:"tab",keyBinding:new c(9),predefined:!0});
d.push({actionID:"shiftTab",keyBinding:new c(9,null,!0),predefined:!0});d.push({actionID:"enter",keyBinding:new c(13),predefined:!0});d.push({actionID:"enter",keyBinding:new c(13,null,!0),predefined:!0});d.push({actionID:"escape",keyBinding:new c(27),predefined:!0});d.push({actionID:"selectAll",keyBinding:new c("a",!0),predefined:!0});d.push({actionID:"toggleTabMode",keyBinding:new c("m",!0),predefined:!0});m.isMac&&(d.push({actionID:"deleteNext",keyBinding:new c(46,null,!0),predefined:!0}),d.push({actionID:"deleteWordPrevious",
keyBinding:new c(8,null,null,!0),predefined:!0}),d.push({actionID:"deleteWordNext",keyBinding:new c(46,null,null,!0),predefined:!0}));d.push({actionID:"toggleWrapMode",keyBinding:new k.KeyBinding("w",!0,!1,!0)});d.push({actionID:"toggleOverwriteMode",keyBinding:new k.KeyBinding(45)});if(!m.isFirefox){var f=m.isMac&&m.isChrome;d.push({actionID:"noop",keyBinding:new c("u",!f,!1,!1,f),predefined:!0});d.push({actionID:"noop",keyBinding:new c("i",!f,!1,!1,f),predefined:!0});d.push({actionID:"noop",keyBinding:new c("b",
!f,!1,!1,f),predefined:!0})}m.isFirefox&&(d.push({actionID:"copy",keyBinding:new c(45,!0),predefined:!0}),d.push({actionID:"paste",keyBinding:new c(45,null,!0),predefined:!0}),d.push({actionID:"cut",keyBinding:new c(46,null,!0),predefined:!0}));m.isMac&&(d.push({actionID:"lineStart",keyBinding:new c("a",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineEnd",keyBinding:new c("e",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineUp",keyBinding:new c("p",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"lineDown",
keyBinding:new c("n",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"charPrevious",keyBinding:new c("b",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"charNext",keyBinding:new c("f",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deletePrevious",keyBinding:new c("h",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteNext",keyBinding:new c("d",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteLineEnd",keyBinding:new c("k",!1,!1,!1,!0),predefined:!0}),m.isFirefox?(d.push({actionID:"scrollPageDown",
keyBinding:new c("v",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteLineStart",keyBinding:new c("u",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"deleteWordPrevious",keyBinding:new c("w",!1,!1,!1,!0),predefined:!0})):(d.push({actionID:"pageDown",keyBinding:new c("v",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"centerLine",keyBinding:new c("l",!1,!1,!1,!0),predefined:!0}),d.push({actionID:"enterNoCursor",keyBinding:new c("o",!1,!1,!1,!0),predefined:!0})));return d};return{KeyMode:e,DefaultKeyMode:c}});
define("orion/editor/textTheme",["require","orion/editor/eventTarget","orion/util"],function(k,m,e){function c(c){c=c||{};this._document=c.document||document}var g={};c.getTheme=function(d){d=d||"default";var f=g[d];f||(f=g[d]=new c);return f};c.prototype={getThemeClass:function(){return this._themeClass},setThemeClass:function(c,f){var e=this,g=e._themeClass;e._themeClass=c;this._load(c,f,function(){e.onThemeChanged({type:"ThemeChanged",oldValue:g,newValue:e.getThemeClass()})})},onThemeChanged:function(c){return this.dispatchEvent(c)},
buildStyleSheet:function(c,f){var e=function(a){return a.replace(this._capitalRegEx,function(a){return"-"+a}.bind(this)).toLowerCase()}.bind(this),g=function(a,b,c,d,f){var k=[];Object.keys(a).forEach(function(m){var w=a[m];"string"===typeof w?k.push("\t"+e(m)+": "+w+";"):g(w,c===m?b:b+(d?" .":".")+m,c,!1,f)});k.length&&(f.push(b+(d?".textview":"")+" {"),f.push.apply(f,k),f.push("}"))},b=[""];g(f.styles,"."+c,f.className,!0,b);return b.join("\n")},_createStyle:function(c,f,g,l){var b=this._document;
c="orion-theme-"+c;var a=b.getElementById(c);if(a){if(l||a.firstChild.data===f)return;a.removeChild(a.firstChild);a.appendChild(b.createTextNode(f))}else l?(a=e.createElement(b,"link"),a.rel="stylesheet",a.type="text/css",a.href=f,a.addEventListener("load",function(){g()})):(a=e.createElement(b,"style"),a.appendChild(b.createTextNode(f))),a.id=c,(b.getElementsByTagName("head")[0]||b.documentElement).appendChild(a);l||g()},_load:function(c,f,e){if(c)if("string"===typeof f)this._createStyle(c,f,e);
else if(f=f.href,".css"!==f.substring(f.length-4)&&(f+=".css"),/^\//.test(f)||/[a-zA-Z0-9]+:\/\//i.test(f)||!k.toUrl)this._createStyle(c,f,e,!0);else{var g=this;k(["text!"+f],function(b){g._createStyle(c,b,e,!1)})}else e()},_capitalRegEx:/[A-Z]/g};m.EventTarget.addMixin(c.prototype);return{TextTheme:c}});
define("orion/editor/util",[],function(){return{contains:function(k,m){if(!m)return!1;if(!k.compareDocumentPosition){for(var e=m;e;){if(k===e)return!0;e=e.parentNode}return!1}return k===m||0!==(k.compareDocumentPosition(m)&16)},getNodeStyle:function(k,m,e){var c;if(k&&(c=k.style[m],!c))if(k.currentStyle){for(c=0;-1!==(c=m.indexOf("-",c));)m=m.substring(0,c)+m.substring(c+1,c+2).toUpperCase()+m.substring(c+2);c=k.currentStyle[m]}else c=(k=k.ownerDocument.defaultView.getComputedStyle(k,null))?k.getPropertyValue(m):
null;return c||e},addEventListener:function(k,m,e,c){"function"===typeof k.addEventListener?k.addEventListener(m,e,!0===c):k.attachEvent("on"+m,e)},removeEventListener:function(k,m,e,c){"function"===typeof k.removeEventListener?k.removeEventListener(m,e,!0===c):k.detachEvent("on"+m,e)},Animation:function(){function k(k){this.options=k}k.prototype.play=function(){var k="number"===typeof this.options.duration?this.options.duration:350,e=this.options.easing||this.defaultEasing,c=this.options.onAnimate||
function(){},g=this.options.curve[0],d=this.options.curve[1],f=d-g,n=-1,l,b=this;this.interval=this.options.window.setInterval(function(){n=-1===n?(new Date).getTime():n;var a=((new Date).getTime()-n)/k;1>a?(a=e(a),l=g+a*f,c(l)):(c(d),b.stop())},"number"===typeof this.options.rate?this.options.rate:20)};k.prototype.stop=function(){this.options.window.clearInterval(this.interval);(this.options.onEnd||function(){})()};k.prototype.defaultEasing=function(k){return Math.sin(k*(Math.PI/2))};return k}()}});
define("orion/editor/textView","i18n!orion/editor/nls/messages orion/editor/textModel orion/editor/keyModes orion/editor/eventTarget orion/editor/textTheme orion/editor/util orion/util orion/metrics".split(" "),function(k,m,e,c,g,d,f,n){function l(s,a,b){if(b){a.className="";b=a.attributes;for(var c=b.length;0<c--;)(!f.isIE||9<=f.isIE||9>f.isIE&&b[c].specified)&&a.removeAttribute(b[c].name)}if(s){s.styleClass&&(a.className=s.styleClass);if(b=s.style)for(var d in b)b.hasOwnProperty(d)&&(a.style[d]=
b[d]);if(s=s.attributes)for(var h in s)s.hasOwnProperty(h)&&a.setAttribute(h,s[h])}}function b(s){return s instanceof Array?s.slice(0):s}function a(s,a){if(!s)return a;if(!a)return s;for(var b in a)a.hasOwnProperty(b)&&(s.hasOwnProperty(b)||(s[b]=a[b]));return s}function q(a,b){if(a===b)return!0;if(a&&!b||!a&&b||a&&a.constructor===String||b&&b.constructor===String)return!1;if(a instanceof Array||b instanceof Array){if(!(a instanceof Array&&b instanceof Array)||a.length!==b.length)return!1;for(var c=
0;c<a.length;c++)if(!q(a[c],b[c]))return!1;return!0}if(!(a instanceof Object)||!(b instanceof Object))return!1;for(c in a)if(a.hasOwnProperty(c)&&(!b.hasOwnProperty(c)||!q(a[c],b[c])))return!1;for(c in b)if(!a.hasOwnProperty(c))return!1;return!0}function h(a,b,c){for(var d=0,h=0,f=0,e=a.length;f<e;){-1!==d&&d<=f&&(d=a.indexOf("\r",f));-1!==h&&h<=f&&(h=a.indexOf("\n",f));var g=f,l;if(-1===h&&-1===d){b(a.substring(f));break}-1!==d&&-1!==h?d+1===h?(l=d,f=h+1):(l=d<h?d:h,f=(d<h?d:h)+1):-1!==d?(l=d,f=
d+1):(l=h,f=h+1);b(a.substring(g,l));c?c():f===e&&b("")}}function p(a){var b,c,d,h,f=a.ownerDocument.defaultView||a.ownerDocument.parentWindow;f.getComputedStyle?(a=f.getComputedStyle(a,null),b=a.getPropertyValue("padding-left"),c=a.getPropertyValue("padding-top"),d=a.getPropertyValue("padding-right"),h=a.getPropertyValue("padding-bottom")):a.currentStyle&&(b=a.currentStyle.paddingLeft,c=a.currentStyle.paddingTop,d=a.currentStyle.paddingRight,h=a.currentStyle.paddingBottom);return{left:parseInt(b,
10)||0,top:parseInt(c,10)||0,right:parseInt(d,10)||0,bottom:parseInt(h,10)||0}}function r(a){var b,c,d,h,f=a._trim;if(!f){var f=p(a),e=a.ownerDocument.defaultView||a.ownerDocument.parentWindow;e.getComputedStyle?(h=e.getComputedStyle(a,null),b=h.getPropertyValue("border-left-width"),c=h.getPropertyValue("border-top-width"),d=h.getPropertyValue("border-right-width"),h=h.getPropertyValue("border-bottom-width")):a.currentStyle&&(b=a.currentStyle.borderLeftWidth,c=a.currentStyle.borderTopWidth,d=a.currentStyle.borderRightWidth,
h=a.currentStyle.borderBottomWidth);b=parseInt(b,10)||0;c=parseInt(c,10)||0;d=parseInt(d,10)||0;h=parseInt(h,10)||0;f.left+=b;f.top+=c;f.right+=d;f.bottom+=h;a._trim=f}return f}function u(a,b,c,d){function h(b){if(b.animationName===e){var c=b.target;"function"===typeof c.__DOMReady&&(a.defaultView||a.parentWindow).setTimeout(function(){c.__DOMReady()},0)}}function f(a,s){for(var b=["","-webkit-","-moz-","-ms-","-o-"],c="",d="body ."+a+" {\n",x=0;x<b.length;x++)c+="@"+b[x]+"keyframes "+s+" {\nfrom { opacity: 0.99; }\nto { opacity: 1; }\n}\n",
d+=b[x]+"animation-duration: 0.001s;\n"+b[x]+"animation-name: "+s+";\n";return c+(d+"}")}c="_"+c+"DOMReady";b.className=b.className?b.className+" "+c:c;b.__DOMReady=d;d=c+"Style";if(!a.getElementById(d)){var e=c+"Animation";C(a,"animationstart",h,!1);C(a,"MSAnimationStart",h,!1);C(a,"webkitAnimationStart",h,!1);b=a.createElement("style");b.id=d;d=a.getElementsByTagName("head")[0]||a.documentElement;b.appendChild(a.createTextNode(f(c,e)));d.insertBefore(b,d.firstChild)}}function v(a,b,c){this.start=
a;this.end=b;this.caret=c;this._columnX=-1}function w(a){this._view=a;this._divs=[];for(var b=a._clipDiv||a._rootDiv,c=0;3>c;c++){var d=a._createSelectionDiv();b.appendChild(d);this._divs.push(d)}}function t(a){this.left=a.left;this.top=a.top;this.right=a.right;this.bottom=a.bottom}function A(a,b,c){this.view=a;this.lineIndex=b;this._lineDiv=c}function z(a){this._init(a||{})}var C=d.addEventListener,E=d.removeEventListener,B=d.Animation;v.compare=function(a,b){if(a.length!==b.length)return!1;for(var c=
0;c<a.length;c++)if(!a[c].equals(b[c]))return!1;return!0};v.editing=function(a,b){var c;if(b){for(c=a.length-1;0<=c;c--)if(a[c]._editing)return a[c];return a[a.length-1]}for(c=0;c<a.length;c++)if(a[c]._editing)return a[c];return a[0]};v.convert=function(a){return 1===a.length?a[0]:a};v.contains=function(a,b){return a.some(function(a){return a.contains(b)})};v.merge=function(a){if(1>=a.length)return a;a.sort(function(a,b){return a.start-b.start});for(var b=[],c=a[0],d=1;d<a.length;d++)a[d].start>=
c.end||c._editing||a[d]._editing?(b.push(c),c=a[d]):c.end=Math.max(c.end,a[d].end);b.push(c);return b};v.prototype={clone:function(){var a=new v(this.start,this.end,this.caret);a._columnX=this._columnX;a._editing=this._editing;a._docX=this._docX;return a},contains:function(a){return this.start<=a&&a<this.end?!0:!1},collapse:function(){this.caret?this.end=this.start:this.start=this.end},extend:function(a){this.caret?this.start=a:this.end=a;this.start>this.end&&(a=this.start,this.start=this.end,this.end=
a,this.caret=!this.caret)},setCaret:function(a){this.end=this.start=a;this.caret=!1},getCaret:function(){return this.caret?this.start:this.end},getAnchor:function(){return this.caret?this.end:this.start},getOrientedSelection:function(){return{start:this.getAnchor(),end:this.getCaret()}},toString:function(){return"start\x3d"+this.start+" end\x3d"+this.end+(this.caret?" caret is at start":" caret is at end")},isEmpty:function(){return this.start===this.end},equals:function(a){return this.caret===a.caret&&
this.start===a.start&&this.end===a.end&&this._editing===a._editing}};w.prototype={destroy:function(){this._divs&&(this._divs.forEach(function(a){a.parentNode.removeChild(a)}),this._divs=null)},setPrimary:function(a){this.primary=a},update:function(){var a=this._view,b=this.primary,c=a._hasFocus,a=a._cursorVisible,d=!this.primary&&this._selection&&this._selection.isEmpty(),h;h=d?"textviewSelectionCaret":c?"textviewSelection":"textviewSelectionUnfocused";this._divs[0].style.visibility=d&&a&&c||!d?"visible":
"hidden";this._divs[0].style.zIndex=a&&d?"2":"0";this._divs.forEach(function(a){a.className=h;f.isWebkit&&b&&(a.style.background=c?"transparent":"")})},setSelection:function(a){this._selection=a;this.update();var b=this._view,c=b._model,d=c.getLineAtOffset(a.start),h=c.getLineAtOffset(a.end),f=b._getLineNext();if(f){var e=b._getLinePrevious(),g;d<f.lineIndex?(d=f,g=c.getLineStart(f.lineIndex)):d>e.lineIndex?(d=e,g=c.getLineStart(e.lineIndex)):(d=b._getLineNode(d),g=a.start);h<f.lineIndex?(b=f,c=c.getLineStart(f.lineIndex)):
h>e.lineIndex?(b=e,c=c.getLineStart(e.lineIndex)):(b=b._getLineNode(h),c=a.end);this._setDOMSelection(d,g,b,c,a.caret)}},_setDOMSelection:function(a,b,c,d,h){this._setDOMFullSelection(a,b,c,d);if(this.primary){var e=this._view;a=a._line.getNodeOffset(b);c=c._line.getNodeOffset(d);if(a.node&&c.node)if(d=e._getWindow(),b=e._parent.ownerDocument,d.getSelection){var g=d.getSelection();d=b.createRange();d.setStart(a.node,a.offset);d.setEnd(c.node,c.offset);if(e._hasFocus&&(g.anchorNode!==a.node||g.anchorOffset!==
a.offset||g.focusNode!==c.node||g.focusOffset!==c.offset||g.anchorNode!==c.node||g.anchorOffset!==c.offset||g.focusNode!==a.node||g.focusOffset!==a.offset))e._anchorNode=a.node,e._anchorOffset=a.offset,e._focusNode=c.node,e._focusOffset=c.offset,e._ignoreSelect=!1,0<g.rangeCount&&g.removeAllRanges(),g.addRange(d),e._ignoreSelect=!0;e._cursorDiv&&(d=b.createRange(),h?(d.setStart(a.node,a.offset),d.setEnd(a.node,a.offset)):(d.setStart(c.node,c.offset),d.setEnd(c.node,c.offset)),h=d.getClientRects()[0],
a=e._cursorDiv.parentNode,c=a.getBoundingClientRect(),h&&c&&(e._cursorDiv.style.top=h.top-c.top+a.scrollTop+"px",e._cursorDiv.style.left=h.left-c.left+a.scrollLeft+"px"))}else b.selection&&e._hasFocus&&(h=b.body,d=f.createElement(b,"div"),h.appendChild(d),h.removeChild(d),d=h.createTextRange(),d.moveToElementText(a.node.parentNode),d.moveStart("character",a.offset),h=h.createTextRange(),h.moveToElementText(c.node.parentNode),h.moveStart("character",c.offset),d.setEndPoint("EndToStart",h),e._ignoreSelect=
!1,d.select(),e._ignoreSelect=!0)}},_setDOMFullSelection:function(a,b,c,d){this._divs.forEach(function(a){a.style.width=a.style.height="0px"});var h=this._view;if(h._fullSelection&&!f.isIOS&&!(a===c&&b===d&&this.primary)){var e=h._getViewPadding(),g=h._clientDiv.getBoundingClientRect(),l=h._viewDiv.getBoundingClientRect(),p=l.left+e.left,r=g.right,e=l.top+e.top,k=g.bottom,l=g=0;h._clipDiv?(l=h._clipDiv.getBoundingClientRect(),g=l.left-h._clipDiv.scrollLeft):(l=h._rootDiv.getBoundingClientRect(),g=
l.left);l=l.top;h._ignoreDOMSelection=!0;var n=new A(h,a.lineIndex,a),q=n.getBoundingClientRect(b,!1),m=q.left;a===c&&b===d?(b=n,d=q):(b=new A(h,c.lineIndex,c),d=b.getBoundingClientRect(d,!1));b=d.left;h._ignoreDOMSelection=!1;var n=this._divs[0],m=Math.min(r,Math.max(p,m)),t=Math.min(k,Math.max(e,q.top)),u=r,h=Math.min(k,Math.max(e,q.bottom));n.style.left=m-g+"px";n.style.top=t-l+"px";n.style.width=Math.max(0,u-m)+"px";n.style.height=Math.max(0,h-t)+"px";a.lineIndex===c.lineIndex?(u=Math.min(b,r),
n.style.width=Math.max(this.primary?0:1,u-m)+"px"):(q=Math.min(k,Math.max(e,d.top)),b=Math.min(r,Math.max(p,b)),e=Math.min(k,Math.max(e,d.bottom)),k=this._divs[2],k.style.left=p-g+"px",k.style.top=q-l+"px",k.style.width=Math.max(0,b-p)+"px",k.style.height=Math.max(0,e-q)+"px",1<Math.abs(a.lineIndex-c.lineIndex)&&(a=this._divs[1],a.style.left=p-g+"px",a.style.top=h-l+"px",a.style.width=Math.max(0,r-p)+"px",a.style.height=Math.max(0,q-h)+"px"))}}};t.prototype={toString:function(){return"{l\x3d"+this.left+
", t\x3d"+this.top+", r\x3d"+this.right+", b\x3d"+this.bottom+"}"}};A.prototype={create:function(a,b){if(!this._lineDiv){var c=this._lineDiv=this._createLine(a,b,this.lineIndex);c._line=this;return c}},_createLine:function(a,b,c){var d=this.view,h=d._model,e=h.getLine(c),g=h.getLineStart(c),p={type:"LineStyle",textView:d,lineIndex:c,lineText:e,lineStart:g};d.onLineStyle(p);var r=a.ownerDocument,h=b||f.createElement(r,"div");if(!b||!q(b.viewStyle,p.style))l(p.style,h,b),b&&(b._trim=null),h.viewStyle=
p.style,h.setAttribute("role","presentation");h.lineIndex=c;if(b&&h.viewLineText===e&&q(p.ranges,h.viewRanges))return h;h.viewRanges=p.ranges;h.viewLineText=e;c=[];this._createRanges(p.ranges,e,0,e.length,g,{tabOffset:0,ranges:c});p=" ";!d._fullSelection&&9>f.isIE&&(p="\ufeff");d={text:p,style:d._metrics.largestFontStyle,ignoreChars:1};0===c.length||!c[c.length-1].style||"div"!==c[c.length-1].style.tagName?c.push(d):c.splice(c.length-1,0,d);var k,n,m,u=p=0;if(f.isFirefox&&2E3<e.length){b&&(h.innerHTML=
"",b.lineWidth=void 0);b=r.createDocumentFragment();for(e=0;e<c.length;e++)d=c[e],g=d.text,k=d.style,k=this._createSpan(h,g,k,d.ignoreChars),b.appendChild(k);h.appendChild(b)}else{var t,v;if(b){if(n=b.modelChangedEvent)0===n.removedLineCount&&0===n.addedLineCount?(v=n.start-g,t=n.addedCharCount-n.removedCharCount):v=-1,b.modelChangedEvent=void 0;n=b.firstChild}for(e=0;e<c.length;e++){d=c[e];g=d.text;p+=g.length;k=d.style;if(n)if(m=n.firstChild.data,r=n.viewStyle,m===g&&q(k,r)){u+=m.length;n._rectsCache=
void 0;k=n=n.nextSibling;continue}else for(;n;){if(-1!==v){r=p;r>=v&&(r-=t);m=(m=n.firstChild.data)?m.length:0;if(u+m>r)break;u+=m}r=n.nextSibling;h.removeChild(n);n=r}k=this._createSpan(h,g,k,d.ignoreChars);n?h.insertBefore(k,n):h.appendChild(k);b&&(b.lineWidth=void 0)}if(b)for(t=k?k.nextSibling:null;t;)r=t.nextSibling,b.removeChild(t),t=r}h.parentNode||a.appendChild(h);return h},_createRanges:function(a,b,c,d,h,f){if(!(c>d)){if(a)for(var e=0;e<a.length;e++){var g=a[e];if(!(g.end<h+c)){var l=Math.max(h+
c,g.start)-h;if(l>d)break;var p=Math.min(h+d,g.end)-h;if(l<=p){l=Math.max(c,l);p=Math.min(d,p);c<l&&this._createRange(b,c,l,null,f);if(!g.style||!g.style.unmergeable)for(;e+1<a.length&&a[e+1].start-h===p&&q(g.style,a[e+1].style);)g=a[e+1],p=Math.min(h+d,g.end)-h,e++;this._createRange(b,l,p,g.style,f);c=p}}}c<d&&this._createRange(b,c,d,null,f)}},_createRange:function(a,b,c,d,h){if(!(b>c)){var f=this.view._customTabSize;if(f&&8!==f)for(var e=a.indexOf("\t",b);-1!==e&&e<c;){b<e&&(b={text:a.substring(b,
e),style:d},h.ranges.push(b),h.tabOffset+=b.text.length);b=f-h.tabOffset%f;if(0<b){for(var g="\u00a0",l=1;l<b;l++)g+=" ";b={text:g,style:d,ignoreChars:b-1};h.ranges.push(b);h.tabOffset+=b.text.length}b=e+1;if(b===c)return;e=a.indexOf("\t",b)}b<=c&&(b={text:a.substring(b,c),style:d},h.ranges.push(b),h.tabOffset+=b.text.length)}},_createSpan:function(a,b,c,d){var h=this.view,e="span";c&&c.tagName&&(e=c.tagName.toLowerCase());var g="a"===e;g&&(this.hasLink=!0);g&&!h._linksVisible&&(e="span");g=a.ownerDocument;
a=f.createElement(a.ownerDocument,e);a.appendChild(g.createTextNode(c&&c.text?c.text:b));c&&c.html?(a.innerHTML=c.html,a.ignore=!0):c&&c.node&&(a.appendChild(c.node),a.ignore=!0);l(c,a);if("a"===e){var p=h._getWindow();C(a,"click",function(a){return h._handleLinkClick(a?a:p.event)},!1)}a.viewStyle=c;d&&(a.ignoreChars=d);return a},_ensureCreated:function(){return this._lineDiv?this._lineDiv:this._createdDiv=this.create(this.view._clientDiv,null)},getBoundingClientRect:function(a,b){var c=this._ensureCreated(),
d=this.view;if(void 0===a)return this._getLineBoundingClientRect(c,!0);var h=d._model,e=c.ownerDocument,g=this.lineIndex,l=null;if(a<h.getLineEnd(g)){var p=h.getLineStart(g);this.forEach(function(b){var x=b.firstChild,h=this._nodeLength(b);if(p+h>a){var g=a-p;if(1===x.length)l=new t(b.getBoundingClientRect());else if(d._isRangeRects)h=e.createRange(),h.setStart(x,g),h.setEnd(x,g+1),l=new t(h.getBoundingClientRect());else if(f.isIE)h=e.body.createTextRange(),h.moveToElementText(b),h.collapse(),(x=
0===g&&8===f.isIE)&&(g=1),h.moveEnd("character",g+1),h.moveStart("character",g),l=new t(h.getBoundingClientRect()),x&&(l.left=b.getClientRects()[0].left);else{var r=x.data;b.removeChild(x);b.appendChild(e.createTextNode(r.substring(0,g)));var k=f.createElement(e,"span");k.appendChild(e.createTextNode(r.substring(g,g+1)));b.appendChild(k);b.appendChild(e.createTextNode(r.substring(g+1)));l=new t(k.getBoundingClientRect());b.innerHTML="";b.appendChild(x);this._createdDiv||(b=d._getSelections()[0],(p<=
b.start&&b.start<p+h||p<=b.end&&b.end<p+h)&&d._updateDOMSelection())}11>f.isIE&&(g=c.ownerDocument.defaultView||c.ownerDocument.parentWindow,b=g.screen.logicalXDPI/g.screen.deviceXDPI,g=g.screen.logicalYDPI/g.screen.deviceYDPI,l.left*=b,l.right*=b,l.top*=g,l.bottom*=g);return!1}p+=h;return!0})}h=this.getBoundingClientRect();l||(d._wrapMode?(g=this.getClientRects(),l=g[g.length-1],l.left=l.right,l.left+=h.left,l.top+=h.top,l.right+=h.left,l.bottom+=h.top):(l=new t(h),l.left=l.right));if(b||void 0===
b)l.left-=h.left,l.top-=h.top,l.right-=h.left,l.bottom-=h.top;return l},forEach:function(a){for(var b=this._ensureCreated().firstChild;b;){var c=b.nextSibling;if(!b.ignore&&!a.call(this,b))break;b=c}},_getClientRects:function(a,b){var c,d,h,f;if(!a._rectsCache){c=a.getClientRects();d=Array(c.length);for(f=0;f<c.length;f++)h=d[f]=new t(c[f]),h.left-=b.left,h.top-=b.top,h.right-=b.left,h.bottom-=b.top;a._rectsCache=d}c=a._rectsCache;d=[c.length];for(f=0;f<c.length;f++)d[f]=new t(c[f]);return d},getClientRects:function(a){if(!this.view._wrapMode)return[this.getBoundingClientRect()];
var b=[],c=this._ensureCreated().getBoundingClientRect();this.forEach(function(a){a=this._getClientRects(a,c);for(var s=0;s<a.length;s++){var d=a[s],h,f;if(d.top!==d.bottom){var e=d.top+(d.bottom-d.top)/2;for(h=0;h<b.length&&!(f=b[h],f.top<=e&&e<f.bottom);h++);h===b.length?b.push(d):(d.left<f.left&&(f.left=d.left),d.top<f.top&&(f.top=d.top),d.right>f.right&&(f.right=d.right),d.bottom>f.bottom&&(f.bottom=d.bottom))}}return!0});return void 0!==a?b[a]:b},_getLineBoundingClientRect:function(a,b){var c=
new t(a.getBoundingClientRect());if(!this.view._wrapMode){c.right=c.left;for(var d=a.lastChild;d&&d.ignoreChars===d.firstChild.length;)d=d.previousSibling;d&&(d=d.getBoundingClientRect(),c.right=d.right+r(a).right)}b&&(d=r(a),c.left+=d.left,c.right-=d.right);return c},getLineCount:function(){return!this.view._wrapMode?1:this.getClientRects().length},getLineIndex:function(a){if(!this.view._wrapMode)return 0;var b=this.getClientRects();a=this.getBoundingClientRect(a);a=a.top+(a.bottom-a.top)/2;for(var c=
0;c<b.length;c++)if(b[c].top<=a&&a<b[c].bottom)return c;return b.length-1},getLineStart:function(a){if(!this.view._wrapMode||0===a)return this.view._model.getLineStart(this.lineIndex);var b=this.getClientRects();return this.getOffset(b[a].left+1,b[a].top+1)},_nodeLength:function(a){if(!a||a.ignore)return 0;var b=a.firstChild.length;a.ignoreChars&&(b-=a.ignoreChars);return b},getModelOffset:function(a,b){if(!a)return 0;var c=0;this.forEach(function(d){var h=d.firstChild;if(h===a)return d.ignoreChars&&
(c-=d.ignoreChars),c+=b,!1;d.ignoreChars&&(c-=d.ignoreChars);c+=h.data.length;return!0});return Math.max(0,c)+this.view._model.getLineStart(this.lineIndex)},getNodeOffset:function(a){var b=0,c,d,h=this.view._model,f=h.getLineStart(this.lineIndex),e=a-f,g=h.getLineEnd(this.lineIndex)-f;this.forEach(function(a){var s=a.firstChild,h=this._nodeLength(a);if(h+b>e||b+h>=g)return c=s,d=e-b,a.ignoreChars&&(0<h&&d===h)&&(d+=a.ignoreChars),!1;b+=h;return!0});return{node:c,offset:d}},getText:function(a){var b=
"",c=0;this.forEach(function(d){var h;if(d.ignoreChars){h=d.lastChild;for(var f=0,e=[],g=-1;h;){var l=h.data;if(l)for(var p=l.length-1;0<=p;p--){var r=l.substring(p,p+1);f<d.ignoreChars&&(" "===r||"\ufeff"===r)?f++:e.push("\u00a0"===r?"\t":r)}a===h&&(g=e.length);h=h.previousSibling}e=e.reverse().join("");-1!==g&&(c=b.length+e.length-g);b+=e}else for(h=d.firstChild;h;)a===h&&(c=b.length),b+=h.data,h=h.nextSibling;return!0});return{text:b,offset:c}},getOffset:function(a,b){function c(d,y,p){var D=d.firstChild,
m=n._nodeLength(d),q=r.ownerDocument,u=q.defaultView||q.parentWindow,t=11>f.isIE?u.screen.logicalXDPI/u.screen.deviceXDPI:1,v=11>f.isIE?u.screen.logicalYDPI/u.screen.deviceYDPI:1,w,A,z,u=p.left+k.left,B,E;if(f.isIE||h._isRangeRects){for(var q=h._isRangeRects?q.createRange():q.body.createTextRange(),C=m,L=-1;1<C-L;){var N=Math.floor((C+L)/2);p=L+1;w=N===m-1&&d.ignoreChars?D.length:N+1;B=0===p&&8===f.isIE;h._isRangeRects?(q.setStart(D,p),q.setEnd(D,w)):(B&&(p=1),q.moveToElementText(d),q.move("character",
p),q.moveEnd("character",w-p));E=q.getClientRects();for(var P=!1,O=0;O<E.length;O++)if(p=E[O],w=(B?u:p.left)*t-k.left,z=p.right*t-k.left,A=p.top*v-k.top,p=p.bottom*v-k.top,w<=a&&a<z&&(!h._wrapMode||A<=b&&b<=p)){P=!0;break}P?C=N:L=N}y+=C;p=C;w=C===m-1&&d.ignoreChars?D.length:Math.min(C+1,D.length);h._isRangeRects?(q.setStart(D,p),q.setEnd(D,w)):(q.moveToElementText(d),q.move("character",p),q.moveEnd("character",w-p));E=q.getClientRects();m=!1;0<E.length&&(p=E[0],w=(B?u:p.left)*t-k.left,z=p.right*t-
k.left,m=a>w+(z-w)/2);d=y-l;D=e.getLine(g);t=D.charCodeAt(d);55296<=t&&56319>=t&&m?d<D.length&&(t=D.charCodeAt(d+1),56320<=t&&57343>=t&&(y+=1)):56320<=t&&(57343>=t&&!m)&&0<d&&(t=D.charCodeAt(d-1),55296<=t&&56319>=t&&(y-=1));m&&y++}else{t=[];for(B=0;B<m;B++)t.push("\x3cspan\x3e"),B===m-1?t.push(D.data.substring(B)):t.push(D.data.substring(B,B+1)),t.push("\x3c/span\x3e");d.innerHTML=t.join("");for(t=d.firstChild;t;){p=t.getBoundingClientRect();w=p.left-k.left;z=p.right-k.left;if(w<=a&&a<z){a>w+(z-w)/
2&&y++;break}y++;t=t.nextSibling}n._createdDiv||(d.innerHTML="",d.appendChild(D),d=h._getSelections()[0],(y<=d.start&&d.start<y+m||y<=d.end&&d.end<y+m)&&h._updateDOMSelection())}return y}function d(c){if(c.ignore)return null;c=n._getClientRects(c,k);for(var f=0;f<c.length;f++){var e=c[f];if(e.left<=a&&a<e.right&&(!h._wrapMode||e.top<=b&&b<=e.bottom))return e}return null}var h=this.view,e=h._model,g=this.lineIndex,l=e.getLineStart(g),p=e.getLineEnd(g);if(l===p)return l;var r=this._ensureCreated(),
k=this.getBoundingClientRect(),n=this,q,m;if(h._wrapMode){q=this.getClientRects();b<q[0].top&&(b=q[0].top);for(var t=0;t<q.length&&!(m=q[t],m.top<=b&&b<m.bottom);t++);a<m.left&&(a=m.left);a>m.right&&(a=m.right-1)}else 0>a&&(a=0),a>k.right-k.left&&(a=k.right-k.left);var u,v;if(this._lastHitChild&&this._lastHitChild.parentNode){if(u=this._lastHitOffset,v=this._lastHitChild,m=d(v),!m){q=u;for(var t=u+this._nodeLength(v),w=v.previousSibling,A=v.nextSibling;w||A;){if(w){q-=this._nodeLength(w);if(m=d(w)){v=
w;u=q;break}w=w.previousSibling}if(A){if(m=d(A)){v=A;u=t;break}t+=this._nodeLength(A);A=A.nextSibling}}}}else u=l,this.forEach(function(a){v=a;if(m=d(v))return!1;u+=this._nodeLength(v);return!0});v&&m&&(this._lastHitChild=v,this._lastHitOffset=u,u=c(v,u,m));return Math.min(p,Math.max(l,u))},getNextOffset:function(a,b){if("line"===b.unit){var c=this.view._model,d=c.getLineAtOffset(a);if(0<b.count)return b.count--,c.getLineEnd(d);b.count++;return c.getLineStart(d)}return"wordend"===b.unit||"wordWS"===
b.unit||"wordendWS"===b.unit?this._getNextOffset_W3C(a,b):f.isIE?this._getNextOffset_IE(a,b):this._getNextOffset_W3C(a,b)},_getNextOffset_W3C:function(a,b){function c(a){return 33<=a&&47>=a||58<=a&&64>=a||91<=a&&94>=a||96===a||123<=a&&126>=a}function d(a){return 32===a||9===a}var h=this.view._model,f=h.getLineAtOffset(a),e=h.getLine(f),g=h.getLineStart(f),h=h.getLineEnd(f),f=e.length,l=a-g,p,r=0>b.count?-1:1;if("word"===b.unit||"wordend"===b.unit||"wordWS"===b.unit||"wordendWS"===b.unit)for(var k,
n,q;0!==b.count;){if(0<b.count){if(l===f)return h;p=e.charCodeAt(l);k=c(p);n=!k&&!d(p);for(l++;l<f;){p=e.charCodeAt(l);if("wordWS"!==b.unit&&"wordendWS"!==b.unit){q=c(p);if("wordend"===b.unit){if(!q&&k)break}else if(q&&!k)break;p=!q&&!d(p)}else p=!d(p);if("wordend"===b.unit||"wordendWS"===b.unit){if(!p&&n)break}else if(p&&!n)break;n=p;k=q;l++}}else{if(0===l)return g;l--;p=e.charCodeAt(l);k=c(p);for(n=!k&&!d(p);0<l;){p=e.charCodeAt(l-1);if("wordWS"!==b.unit&&"wordendWS"!==b.unit){q=c(p);if("wordend"===
b.unit){if(q&&!k)break}else if(!q&&k)break;p=!q&&!d(p)}else p=!d(p);if("wordend"===b.unit||"wordendWS"===b.unit){if(p&&!n)break}else if(!p&&n)break;n=p;k=q;l--}}b.count-=r}else for(;0!==b.count&&0<=l+r&&l+r<=f;)l+=r,p=e.charCodeAt(l),56320<=p&&57343>=p&&0<l&&(p=e.charCodeAt(l-1),55296<=p&&56319>=p&&(l+=r)),b.count-=r;return g+l},_getNextOffset_IE:function(a,b){var c=this._ensureCreated(),d=this.view._model,h=this.lineIndex,f=0,e;e=d.getLineStart(h);var g=d.getLine(h),l=d.getLineStart(h),p=c.ownerDocument,
r=0>b.count?-1:1;if(a===d.getLineEnd(h)){for(c=c.lastChild;c&&c.ignoreChars===c.firstChild.length;)c=c.previousSibling;if(!c)return e;f=p.body.createTextRange();f.moveToElementText(c);e=f.text.length;f.moveEnd(b.unit,r);f=a+f.text.length-e}else if(a===e&&0>b.count)f=e;else for(c=c.firstChild;c;){d=this._nodeLength(c);if(e+d>a){f=p.body.createTextRange();if(a===e&&0>b.count){for(e=c.previousSibling;e&&(!e.firstChild||!e.firstChild.length);)e=e.previousSibling;f.moveToElementText(e?e:c.previousSibling)}else f.moveToElementText(c),
f.collapse(),f.moveEnd("character",a-e);e=f.text.length;f.moveEnd(b.unit,r);f=a+f.text.length-e;break}e=d+e;c=c.nextSibling}e=f-l;f=g.charCodeAt(e);56320<=f&&57343>=f&&0<e&&(f=g.charCodeAt(e-1),55296<=f&&56319>=f&&(e+=r));b.count-=r;return e+l},updateLinks:function(){var a=this._ensureCreated();if(this.hasLink){var b=this;this.forEach(function(c){var d=c.viewStyle;d&&(d.tagName&&"a"===d.tagName.toLowerCase())&&a.replaceChild(b._createSpan(a,c.firstChild.data,d),c);return!0})}},destroy:function(){var a=
this._createdDiv;a&&(a.parentNode.removeChild(a),this._createdDiv=null)}};z.prototype={addKeyMode:function(a,b){var c=this._keyModes;void 0!==b?c.splice(b,0,a):c.push(a);a._modeAdded&&a._modeAdded()},addRuler:function(a,b){var c=this._rulers;if(void 0!==b){var d,h;for(h=d=0;d<c.length&&h<b;d++)a.getLocation()===c[d].getLocation()&&h++;c.splice(h,0,a);b=h}else c.push(a);this._createRuler(a,b);a.setView(this);this._update()},computeSize:function(){var a=0,b=0,c=this._model,d=this._clientDiv;if(!d)return{width:a,
height:b};var h=d.style.width;f.isWebkit&&(d.style.width="0x7fffffffpx");for(var c=c.getLineCount(),e=0;e<c;e++){var g=this._getLine(e),l=g.getBoundingClientRect(),a=Math.max(a,l.right-l.left),b=b+(l.bottom-l.top);g.destroy()}f.isWebkit&&(d.style.width=h);d=this._getViewPadding();a+=d.right+d.left+this._metrics.scrollWidth;b+=d.bottom+d.top+this._metrics.scrollWidth;return{width:a,height:b}},convert:function(a,b,c){if(!this._clientDiv)return a;var d=this._getScroll(),h=this._getViewPadding(),f=this._viewDiv.getBoundingClientRect();
"document"===b&&(void 0!==a.x&&(a.x+=-d.x+f.left+h.left),void 0!==a.y&&(a.y+=-d.y+f.top+h.top));"document"===c&&(void 0!==a.x&&(a.x+=d.x-f.left-h.left),void 0!==a.y&&(a.y+=d.y-f.top-h.top));return a},destroy:function(){for(var a=0;a<this._rulers.length;a++)this._rulers[a].setView(null);this.rulers=null;this._destroyView();this.onDestroy({type:"Destroy"});this._parent=null;this._model&&this._model.destroy&&this._model.destroy();this._actions=this._keyModes=this._doubleClickSelection=this._selection=
this._theme=this._model=null},focus:function(){this._clientDiv&&(this._updateDOMSelection(),this._clientDiv.focus(),this._updateDOMSelection())},hasFocus:function(){return this._hasFocus},getActionDescription:function(a){if(a=this._actions[a])return a.actionDescription},getActions:function(a){var b=[],c=this._actions,d;for(d in c)c.hasOwnProperty(d)&&(a||!c[d].defaultHandler)&&b.push(d);return b},getBottomIndex:function(a){return!this._clientDiv?0:this._getBottomIndex(a)},getBottomPixel:function(){return!this._clientDiv?
0:this._getScroll().y+this._getClientHeight()},getCaretOffset:function(){return this._getSelection().getCaret()},getClientArea:function(){if(!this._clientDiv)return{x:0,y:0,width:0,height:0};var a=this._getScroll();return{x:a.x,y:a.y,width:this._getClientWidth(),height:this._getClientHeight()}},getHorizontalPixel:function(){return!this._clientDiv?0:this._getScroll().x},getKeyBindings:function(a){for(var b=[],c=this._keyModes,d=0;d<c.length;d++)b=b.concat(c[d].getKeyBindings(a));return b},getKeyModes:function(){return this._keyModes.slice(0)},
getLineHeight:function(a){return!this._clientDiv?0:this._getLineHeight(a)},getLineIndex:function(a){return!this._clientDiv?0:this._getLineIndex(a)},isValidTextPosition:function(a,b){if(!this._clientDiv)return!1;var c=this._getLineIndex(b,!0);if(0>c)return!1;var c=this._getLine(c),d=this.getOffsetAtLocation(a,b),d=c.getBoundingClientRect(d);c.destroy();return a>d.right?!1:!0},getLinePixel:function(a){return!this._clientDiv?0:this._getLinePixel(a)},getLocationAtOffset:function(a){if(!this._clientDiv)return{x:0,
y:0};var b=this._model;a=Math.min(Math.max(0,a),b.getCharCount());var b=b.getLineAtOffset(a),c=this._getLine(b);a=c.getBoundingClientRect(a);c.destroy();c=a.left;b=this._getLinePixel(b)+a.top;return{x:c,y:b}},getNextOffset:function(a,b){var c=new v(a,a,!1);this._doMove(b,c);return c.getCaret()},getOptions:function(){var a;if(0===arguments.length)a=this._defaultOptions();else if(1===arguments.length){if(a=arguments[0],"string"===typeof a)return b(this["_"+a])}else{a={};for(var c in arguments)arguments.hasOwnProperty(c)&&
(a[arguments[c]]=void 0)}for(var d in a)a.hasOwnProperty(d)&&(a[d]=b(this["_"+d]));return a},getModel:function(){return this._model},getOffsetAtLocation:function(a,b){if(!this._clientDiv)return 0;var c=this._getLineIndex(b),d=this._getLine(c),c=d.getOffset(a,b-this._getLinePixel(c));d.destroy();return c},getLineAtOffset:function(a){return this.getModel().getLineAtOffset(a)},getLineStart:function(a){return this.getModel().getLineStart(a)},getRulers:function(){return this._rulers.slice(0)},getSelection:function(){return this._getSelection()},
getSelections:function(){return this._getSelections()},getSelectionText:function(a){var b=[],c=this;this._getSelections().forEach(function(a){a.isEmpty()||b.push(c._getBaseText(a.start,a.end))});return b.join(void 0!==a?a:this._model.getLineDelimiter())},getText:function(a,b){return this._model.getText(a,b)},getTopIndex:function(a){return!this._clientDiv?0:this._getTopIndex(a)},getTopPixel:function(){return!this._clientDiv?0:this._getScroll().y},invokeAction:function(a,b,c){if(this._clientDiv){if(a=
this._actions[a]){a.actionDescription&&a.actionDescription.id&&n.logEvent("editor","action",a.actionDescription.id);if(!b&&a.handler&&a.handler(c))return!0;if(a.defaultHandler)return"boolean"===typeof a.defaultHandler(c)}return!1}},isDestroyed:function(){return!this._clientDiv},onContextMenu:function(a){return this.dispatchEvent(a)},onDragStart:function(a){return this.dispatchEvent(a)},onDrag:function(a){return this.dispatchEvent(a)},onDragEnd:function(a){return this.dispatchEvent(a)},onDragEnter:function(a){return this.dispatchEvent(a)},
onDragOver:function(a){return this.dispatchEvent(a)},onDragLeave:function(a){return this.dispatchEvent(a)},onDrop:function(a){return this.dispatchEvent(a)},onDestroy:function(a){return this.dispatchEvent(a)},onSaving:function(a){return this.dispatchEvent(a)},onInputChanged:function(a){return this.dispatchEvent(a)},onLineStyle:function(a){return this.dispatchEvent(a)},onKeyDown:function(a){return this.dispatchEvent(a)},onKeyPress:function(a){return this.dispatchEvent(a)},onKeyUp:function(a){return this.dispatchEvent(a)},
onModelChanged:function(a){return this.dispatchEvent(a)},onModelChanging:function(a){return this.dispatchEvent(a)},onModify:function(a){return this.dispatchEvent(a)},onMouseDown:function(a){return this.dispatchEvent(a)},onMouseUp:function(a){return this.dispatchEvent(a)},onMouseMove:function(a){return this.dispatchEvent(a)},onMouseOver:function(a){return this.dispatchEvent(a)},onMouseOut:function(a){return this.dispatchEvent(a)},onTouchStart:function(a){return this.dispatchEvent(a)},onTouchMove:function(a){return this.dispatchEvent(a)},
onTouchEnd:function(a){return this.dispatchEvent(a)},onOptions:function(a){return this.dispatchEvent(a)},onSelection:function(a){return this.dispatchEvent(a)},onScroll:function(a){return this.dispatchEvent(a)},onVerify:function(a){return this.dispatchEvent(a)},onFocus:function(a){return this.dispatchEvent(a)},onBlur:function(a){return this.dispatchEvent(a)},redraw:function(){if(!(0<this._redrawCount)){var a=this._model.getLineCount();this.redrawRulers(0,a);this.redrawLines(0,a)}},redrawRulers:function(a,
b){if(!(0<this._redrawCount))for(var c=this.getRulers(),d=0;d<c.length;d++)this.redrawLines(a,b,c[d])},redrawLines:function(a,b,c){if(!(0<this._redrawCount)&&(void 0===a&&(a=0),void 0===b&&(b=this._model.getLineCount()),a!==b)){var d=this._clientDiv;if(d){if(c)for(d=this._getRulerParent(c).firstChild;d&&d._ruler!==c;)d=d.nextSibling;c?d.rulerChanged=!0:this._lineHeight&&this._resetLineHeight(a,b);var h=-1;!c&&-1!==this._imeOffset&&(h=this._model.getLineAtOffset(this._imeOffset));if(!c||"page"===c.getOverview())for(d=
d.firstChild;d;){var f=d.lineIndex;a<=f&&(f<b&&f!==h)&&(d.lineChanged=!0);d=d.nextSibling}!c&&(!this._wrapMode&&a<=this._maxLineIndex&&this._maxLineIndex<b)&&(this._checkMaxLineIndex=this._maxLineIndex,this._maxLineIndex=-1,this._maxLineWidth=0);this.dispatchEvent({type:"Redraw",startLine:a,endLine:b,ruler:c});this._queueUpdate()}}},redrawRange:function(a,b){if(!(0<this._redrawCount)){var c=this._model;void 0===a&&(a=0);void 0===b&&(b=c.getCharCount());var d=c.getLineAtOffset(a),c=c.getLineAtOffset(Math.max(a,
b-1))+1;this.redrawLines(d,c)}},removeKeyMode:function(a){for(var b=this._keyModes,c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}a._modeRemoved&&a._modeRemoved()},removeRuler:function(a){for(var b=this._rulers,c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);a.setView(null);this._destroyRuler(a);this._update();break}},resize:function(){this._clientDiv&&this._handleResize(null)},setAction:function(a,b,c){if(a){var d=this._actions,h=d[a];h||(h=d[a]={});h.handler=b;void 0!==c&&(h.actionDescription=
c)}},setKeyBinding:function(a,b){this._keyModes[0].setKeyBinding(a,b)},setCaretOffset:function(a,b,c){var d=this._model.getCharCount();a=Math.max(0,Math.min(a,d));a=new v(a,a,!1);this._setSelection(a,void 0===b||b,!0,c)},setHorizontalPixel:function(a){this._clientDiv&&(a=Math.max(0,a),this._scrollView(a-this._getScroll().x,0))},setRedraw:function(a){a?0===--this._redrawCount&&this.redraw():this._redrawCount++},setModel:function(a){if(a!==this._model){a=a||new m.TextModel;this._model.removeEventListener("preChanging",
this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);var b=this._model.getLineCount(),c=this._model.getCharCount(),d=a.getLineCount(),h=a.getCharCount(),f={type:"ModelChanging",text:a.getText(),start:0,removedCharCount:c,addedCharCount:h,removedLineCount:b,addedLineCount:d};this.onModelChanging(f);this._model=a;f={type:"ModelChanged",start:0,removedCharCount:c,addedCharCount:h,removedLineCount:b,addedLineCount:d};this.onModelChanged(f);this._model.addEventListener("preChanging",
this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._reset();this._update()}},setOptions:function(a){var c=this._defaultOptions(),d;for(d in a)if(a.hasOwnProperty(d)){var h=a[d];if(!q(this["_"+d],h)){var f=c[d]?c[d].update:null;f?f.call(this,h):this["_"+d]=b(h)}}this.onOptions({type:"Options",options:a})},setSelection:function(a,b,c,d){var h=a>b;if(h){var f=a;a=b;b=f}f=this._model.getCharCount();a=Math.max(0,Math.min(a,f));b=Math.max(0,Math.min(b,
f));a=new v(a,b,h);this._setSelection(a,void 0===c||c,!0,d)},setSelections:function(a,b,c){a=this._rangesToSelections(a);this._setSelection(a,void 0===b||b,!0,c)},setText:function(a,b,c,d,h){var e="string"===typeof a,g=void 0===b&&void 0===c&&e;e?(void 0===b&&(b=0),void 0===c&&(c=this._model.getCharCount()),a={text:a,selection:[new v(b,c,!1)]}):a.selection=this._rangesToSelections(a.selection);a._code=!0;g&&(this._variableLineHeight=!1);this._modifyContent(a,!g,void 0===d||d,h);g&&13>f.isFirefox&&
this._fixCaret()},setTopIndex:function(a,b){this._clientDiv&&this._scrollViewAnimated(0,this._getLinePixel(Math.max(0,a))-this._getScroll().y,b)},setTopPixel:function(a,b){this._clientDiv&&this._scrollViewAnimated(0,Math.max(0,a)-this._getScroll().y,b)},showSelection:function(a,b){return this._showCaret(a?!1:!0,b,a)},update:function(a,b){this._clientDiv&&((a||this._metrics.invalid)&&this._updateStyle(),void 0===b||b?this._update():this._queueUpdate())},_handleRootMouseDown:function(a){this._cancelCheckSelection();
if(!this._ignoreEvent(a)){13>f.isFirefox&&1===a.which&&(this._clientDiv.contentEditable=!1,this._ignoreBlur=(this._overlayDiv||this._clientDiv).draggable=!0);var b=this._overlayDiv||this._clientDiv;9>f.isIE&&(b=this._viewDiv);for(var c=a.target?a.target:a.srcElement;c;){if(b===c||c.className&&-1!==c.className.indexOf("textViewFind"))return;c=c.parentNode}a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();if(!this._isW3CEvents){var d=this;this._getWindow().setTimeout(function(){d._clientDiv.focus()},
0)}}},_handleRootMouseUp:function(a){this._ignoreEvent(a)||(13>f.isFirefox&&1===a.which&&(this._clientDiv.contentEditable=!0,(this._overlayDiv||this._clientDiv).draggable=!1),f.isFirefox&&1===a.which&&(this._fixCaret(),this._ignoreBlur=!1))},_handleBlur:function(){this._cancelCheckSelection();if(!this._ignoreBlur){this._commitIME();this._hasFocus=!1;if(9>f.isIE&&!this._getSelections()[0].isEmpty()){var a=this._rootDiv,b=f.createElement(a.ownerDocument,"div");a.appendChild(b);a.removeChild(b)}this._cursorDiv&&
(this._cursorDiv.style.display="none");if(this._domSelection)if(this._domSelection.forEach(function(a){a.update()}),a=this._getWindow(),b=this._parent.ownerDocument,a.getSelection){b=a.getSelection();for(a=b.anchorNode;a;){if(a===this._clientDiv){0<b.rangeCount&&b.removeAllRanges();break}a=a.parentNode}}else if(b.selection){this._ignoreSelect=!1;for(a=b.selection.createRange().parentElement();a;){if(a===this._clientDiv){b.selection.empty();break}a=a.parentNode}this._ignoreSelect=!0}if(!this._ignoreFocus)this.onBlur({type:"Blur"})}},
_handleCompositionStart:function(a){this._ignoreEvent(a)||(this._imeTimeout&&(this._getWindow().clearTimeout(this._imeTimeout),this._imeTimeout=null),this._imeText&&(this._commitIME(this._imeText),this._imeText=null),this._startIME(),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null))},_handleCompositionUpdate:function(a){this._ignoreEvent(a)||(this._imeText=a.data)},_handleCompositionEnd:function(a){this._ignoreEvent(a)||(this._imeText=a.data,this._imeTimeout=
this._getWindow().setTimeout(function(){this._commitIME(this._imeText);this._imeText=this._imeTimeout=null}.bind(this),0))},_handleContextMenu:function(a){if(!this._ignoreEvent(a)){f.isIE&&3===this._lastMouseButton&&this._updateDOMSelection();var b=!1;this.isListening("ContextMenu")?(b=this._createMouseEvent("ContextMenu",a),b.screenX=a.screenX,b.screenY=a.screenY,this.onContextMenu(b),b=b.defaultPrevented):f.isMac&&(f.isFirefox&&0===a.button)&&(b=!0);if(b)return a.preventDefault&&a.preventDefault(),
!1;this._contextMenuOpen=!0;f.isFirefox&&(this._checkSelectionChange=!0,this._pollSelectionChange(!0))}},_handleCopy:function(a){this._cancelCheckSelection();if(!this._ignoreEvent(a)&&!this._ignoreCopy&&this._doCopy(a))return a.preventDefault&&a.preventDefault(),!1},_handleCut:function(a){this._cancelCheckSelection();if(!this._ignoreEvent(a)&&this._doCut(a))return a.preventDefault&&a.preventDefault(),!1},_handleDataModified:function(a){this._ignoreEvent(a)||this._startIME()},_handleDblclick:function(a){this._ignoreEvent(a)||
(this._lastMouseTime=a.timeStamp?a.timeStamp:(new Date).getTime(),2!==this._clickCount&&(this._clickCount=2,this._handleMouse(a)))},_handleDragStart:function(a){if(!this._ignoreEvent(a)){if(13>f.isFirefox){var b=this;this._getWindow().setTimeout(function(){b._clientDiv.contentEditable=!0;b._clientDiv.draggable=!1;b._ignoreBlur=!1},0)}if(this.isListening("DragStart")&&-1!==this._dragOffset)this._isMouseDown=!1,this.onDragStart(this._createMouseEvent("DragStart",a)),this._dragOffset=-1;else return a.preventDefault&&
a.preventDefault(),!1}},_handleDrag:function(a){if(!this._ignoreEvent(a)&&this.isListening("Drag"))this.onDrag(this._createMouseEvent("Drag",a))},_handleDragEnd:function(a){if(!this._ignoreEvent(a)){this._dropTarget=!1;this._dragOffset=-1;if(this.isListening("DragEnd"))this.onDragEnd(this._createMouseEvent("DragEnd",a));13>f.isFirefox&&(this._fixCaret(),"none"===a.dataTransfer.dropEffect&&!a.dataTransfer.mozUserCancelled&&this._fixCaret())}},_handleDragEnter:function(a){if(!this._ignoreEvent(a)){var b=
!0;this._dropTarget=!0;this.isListening("DragEnter")&&(b=!1,this.onDragEnter(this._createMouseEvent("DragEnter",a)));if(f.isWebkit||b)return a.preventDefault&&a.preventDefault(),!1}},_handleDragOver:function(a){if(!this._ignoreEvent(a)){var b=!0;this.isListening("DragOver")&&(b=!1,this.onDragOver(this._createMouseEvent("DragOver",a)));if(f.isWebkit||b)return b&&(a.dataTransfer.dropEffect="none"),a.preventDefault&&a.preventDefault(),!1}},_handleDragLeave:function(a){if(!this._ignoreEvent(a)&&(this._dropTarget=
!1,this.isListening("DragLeave")))this.onDragLeave(this._createMouseEvent("DragLeave",a))},_handleDrop:function(a){if(!this._ignoreEvent(a)){this._dropTarget=!1;if(this.isListening("Drop"))this.onDrop(this._createMouseEvent("Drop",a));a.preventDefault&&a.preventDefault();return!1}},_handleFocus:function(){this._hasFocus=!0;f.isIOS&&void 0!==this._lastTouchOffset?(this.setCaretOffset(this._lastTouchOffset,!0),this._lastTouchOffset=void 0):this._updateDOMSelection();this._cursorDiv&&(this._cursorDiv.style.display=
"block");this._domSelection&&this._domSelection.forEach(function(a){a.update()});if(!this._ignoreFocus)this.onFocus({type:"Focus"})},_handleKeyDown:function(a){this._cancelCheckSelection();if(!this._ignoreEvent(a)){if(this.isListening("KeyDown")){var b=this._createKeyEvent("KeyDown",a);this.onKeyDown(b);if(b.defaultPrevented){f.isFirefox&&(this._keyDownPrevented=!0);a.preventDefault();return}}b=!1;switch(a.keyCode){case 16:case 17:case 18:case 91:b=!0;break;default:this._setLinksVisible(!1)}if(229===
a.keyCode){if(this._readonly)return a.preventDefault&&a.preventDefault(),!1;b=!0;f.isSafari&&f.isMac&&a.ctrlKey&&(b=!1,a.keyCode=129);b&&this._startIME()}else b||this._commitIME();if((f.isMac||f.isLinux)&&4>f.isFirefox||12.16>f.isOpera)return this._keyDownEvent=a,!0;if(this._doAction(a))return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1,a.keyCode=0),!1}},_handleKeyPress:function(a){if(!this._ignoreEvent(a))if(this._keyDownPrevented)a.preventDefault&&
(a.preventDefault(),a.stopPropagation()),this._keyDownPrevented=void 0;else{if(f.isMac&&f.isWebkit&&(63232<=a.keyCode&&63487>=a.keyCode||13===a.keyCode||8===a.keyCode)||((f.isMac||f.isLinux)&&4>f.isFirefox||12.16>f.isOpera)&&this._doAction(this._keyDownEvent))return a.preventDefault&&a.preventDefault(),!1;var b=f.isMac?a.metaKey:a.ctrlKey;if(void 0!==a.charCode&&b)switch(a.charCode){case 99:case 118:case 120:return!0}if(this.isListening("KeyPress")&&(b=this._createKeyEvent("KeyPress",a),this.onKeyPress(b),
b.defaultPrevented)){a.preventDefault();return}if(this._doAction(a))return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1,a.keyCode=0),!1;b=!1;if(f.isMac){if(a.ctrlKey||a.metaKey)b=!0}else if(f.isFirefox){if(a.ctrlKey||a.altKey)b=!0}else a.ctrlKey^a.altKey&&(b=!0);if(!b&&(b=f.isOpera?a.which:void 0!==a.charCode?a.charCode:a.keyCode,31<b))return this._doContent(String.fromCharCode(b)),a.preventDefault&&a.preventDefault(),!1}},_handleDocKeyUp:function(a){(f.isMac?
a.metaKey:a.ctrlKey)||this._setLinksVisible(!1)},_handleKeyUp:function(a){if(!this._ignoreEvent(a)){if(this.isListening("KeyUp")){var b=this._createKeyEvent("KeyUp",a);this.onKeyUp(b);if(b.defaultPrevented){a.preventDefault();return}}this._handleDocKeyUp(a);13===a.keyCode&&this._commitIME()}},_handleLinkClick:function(a){if(!(f.isMac?a.metaKey:a.ctrlKey))return a.preventDefault&&a.preventDefault(),!1},_handleMouse:function(a){var b=this._getWindow(),c=!0,d=b;if(f.isIE||f.isFirefox&&!this._overlayDiv)d=
this._clientDiv;if(this._overlayDiv){this._hasFocus&&(this._ignoreFocus=!0);var h=this;b.setTimeout(function(){h.focus();h._ignoreFocus=!1},0)}var b=a.shiftKey,e=a.altKey,g=f.isMac?a.metaKey:a.ctrlKey;this._blockSelection=this._doubleClickSelection=null;1===this._clickCount?(c=(!f.isOpera||12.16<=f.isOpera)&&this._hasFocus&&this.isListening("DragStart"),(c=this._setSelectionTo(a.clientX,a.clientY,!0,b,g,c))&&this._setGrab(d)):(this._isW3CEvents&&this._setGrab(d),this._setSelectionTo(a.clientX,a.clientY,
!0,b,g,!1),this._doubleClickSelection=v.editing(this._getSelections()));e&&(this._blockSelection=v.editing(this._getSelections()));return c},_handleMouseDown:function(a){if(!this._ignoreEvent(a)){if(this._linksVisible)if("A"!==(a.target||a.srcElement).tagName)this._setLinksVisible(!1);else return;this._commitIME();var b=a.which;b||(4===a.button&&(b=2),2===a.button&&(b=3),1===a.button&&(b=1));var c=2!==b&&a.timeStamp?a.timeStamp:(new Date).getTime(),d=c-this._lastMouseTime,h=Math.abs(this._lastMouseX-
a.clientX),e=Math.abs(this._lastMouseY-a.clientY),g=this._lastMouseButton===b;this._lastMouseX=a.clientX;this._lastMouseY=a.clientY;this._lastMouseTime=c;this._lastMouseButton=b;1===b&&(this._isMouseDown=!0,g&&d<=this._clickTime&&h<=this._clickDist&&e<=this._clickDist?this._clickCount++:this._clickCount=1);if(this.isListening("MouseDown")&&(c=this._createMouseEvent("MouseDown",a),this.onMouseDown(c),c.defaultPrevented)){a.preventDefault();return}if(1===b&&this._handleMouse(a)&&(9<=f.isIE||f.isOpera||
f.isChrome||f.isSafari||f.isFirefox&&!this._overlayDiv))this._hasFocus||this.focus(),a.preventDefault();f.isFirefox&&3===this._lastMouseButton&&this._updateDOMSelection()}},_handleMouseOver:function(a){if(!this._ignoreEvent(a)&&!this._animation&&this.isListening("MouseOver"))this.onMouseOver(this._createMouseEvent("MouseOver",a))},_handleMouseOut:function(a){if(!this._ignoreEvent(a)&&!this._animation&&this.isListening("MouseOut"))this.onMouseOut(this._createMouseEvent("MouseOut",a))},_handleMouseMove:function(a){if(!this._animation){var b=
this._isClientDiv(a);if(this.isListening("MouseMove")&&(b||this._isMouseDown)){var c=this._createMouseEvent("MouseMove",a);this.onMouseMove(c);if(c.defaultPrevented){a.preventDefault();return}}if(!this._dropTarget){c=this._linksVisible||this._lastMouseMoveX!==a.clientX||this._lastMouseMoveY!==a.clientY;this._lastMouseMoveX=a.clientX;this._lastMouseMoveY=a.clientY;this._setLinksVisible(c&&!this._isMouseDown&&a.altKey&&(f.isMac?a.metaKey:a.ctrlKey));this._checkOverlayScroll();if(!this._isW3CEvents){if(0===
a.button)return this._setGrab(null),!0;if(!this._isMouseDown&&1===a.button&&0!==(this._clickCount&1)&&b)return this._clickCount=2,this._handleMouse(a,this._clickCount)}if(this._isMouseDown&&-1===this._dragOffset){b=a.clientX;a=a.clientY;var d=this._getViewPadding(),h=this._viewDiv.getBoundingClientRect(),e=this._getClientWidth(),g=this._getClientHeight(),c=h.left+d.left,l=h.top+d.top,e=h.left+d.left+e,d=h.top+d.top+g;a<l?this._doAutoScroll("up",b,a-l):a>d?this._doAutoScroll("down",b,a-d):b<c&&!this._wrapMode?
this._doAutoScroll("left",b-c,a):b>e&&!this._wrapMode?this._doAutoScroll("right",b-e,a):(this._endAutoScroll(),this._setSelectionTo(b,a,!1,!0))}}}},_isClientDiv:function(a){var b=this._overlayDiv||this._clientDiv;for(a=a.target?a.target:a.srcElement;a;){if(b===a)return!0;a=a.parentNode}return!1},_createKeyEvent:function(a,b){return{type:a,event:b,preventDefault:function(){this.defaultPrevented=!0}}},_createMouseEvent:function(a,b){var c=this.convert({x:b.clientX,y:b.clientY},"page","document");return{type:a,
event:b,clickCount:this._clickCount,x:c.x,y:c.y,preventDefault:function(){this.defaultPrevented=!0}}},_createTouchEvent:function(a,b){var c=b.touches.length?this.convert({x:b.touches[0].clientX,y:b.touches[0].clientY},"page","document"):{};return{type:a,event:b,touchCount:b.touches.length,x:c.x,y:c.y,preventDefault:function(){this.defaultPrevented=!0}}},_handleMouseUp:function(a){var b=a.which?0===a.button:1===a.button;if(this.isListening("MouseUp")&&(this._isClientDiv(a)||b&&this._isMouseDown)){var c=
this._createMouseEvent("MouseUp",a);this.onMouseUp(c);if(c.defaultPrevented){a.preventDefault();this._isMouseDown=!1;return}}if(!this._linksVisible){if(b&&this._isMouseDown){var c=this._getSelections(),d=v.editing(c);c.forEach(function(a){a._editing=!1});-1!==this._dragOffset&&(d.extend(this._dragOffset),d.collapse(),c=d,this._dragOffset=-1);this._setSelection(c,!1);this._isMouseDown=!1;this._endAutoScroll();this._isW3CEvents&&this._setGrab(null)}b&&f.isFirefox&&(this._updateDOMSelection(),a.preventDefault())}},
_handleMouseWheel:function(a){if(!this._noScroll){var b=this._getLineHeight(),c=0,d=0;f.isIE||f.isOpera?d=-a.wheelDelta/40*b:f.isFirefox?"wheel"===a.type?a.deltaMode?(c=Math.max(-256,Math.min(256,a.deltaX))*b,d=Math.max(-256,Math.min(256,a.deltaY))*b):(c=a.deltaX,d=a.deltaY):(b=f.isMac?3*a.detail:Math.max(-256,Math.min(256,a.detail))*b,a.axis===a.HORIZONTAL_AXIS?c=b:d=b):f.isMac?(d=a.timeStamp-this._wheelTimeStamp,this._wheelTimeStamp=a.timeStamp,c=0!==a.wheelDeltaX%120?1:40>d?40/(40-d):40,d=0!==
a.wheelDeltaY%120?1:40>d?40/(40-d):40,c=Math.ceil(-a.wheelDeltaX/c),-1<c&&0>c&&(c=-1),0<c&&1>c&&(c=1),d=Math.ceil(-a.wheelDeltaY/d),-1<d&&0>d&&(d=-1),0<d&&1>d&&(d=1)):(c=-a.wheelDeltaX,d=8*(-a.wheelDeltaY/120)*b);if(f.isSafari||f.isChrome&&f.isMac){for(b=a.target;b&&void 0===b.lineIndex;)b=b.parentNode;this._mouseWheelLine=b}b=this._getScroll();this._scrollView(c,d);c=this._getScroll();if(b.x!==c.x||b.y!==c.y)return a.preventDefault&&a.preventDefault(),!1}},_handlePaste:function(a){this._cancelCheckSelection();
if(!this._ignoreEvent(a)&&!this._ignorePaste&&this._doPaste(a)){if(f.isIE){var b=this;this._ignoreFocus=!0;this._getWindow().setTimeout(function(){b._updateDOMSelection();b._ignoreFocus=!1},0)}a.preventDefault&&a.preventDefault();return!1}},_handleResize:function(){var a=this._rootDiv.clientWidth,b=this._rootDiv.clientHeight;if(this._rootWidth!==a||this._rootHeight!==b)this._rootWidth!==a&&this._wrapMode&&this._resetLineHeight(),this._rootWidth=a,this._rootHeight=b,a=9>f.isIE,b=this._calculateMetrics(),
q(b,this._metrics)||(this._metrics.invalid&&!b.invalid?this._updateStyle(!1,b):(this._variableLineHeight&&(this._variableLineHeight=!1,this._resetLineHeight()),this._metrics=b),a=!0),a?this._queueUpdate():this._update(),this.dispatchEvent({type:"Resize"})},_handleRulerEvent:function(a){for(var b=a.target?a.target:a.srcElement,c=b.lineIndex;b&&!b._ruler;)void 0===c&&void 0!==b.lineIndex&&(c=b.lineIndex),b=b.parentNode;var d=b?b._ruler:null;if(void 0===c&&d&&"document"===d.getOverview()){var h=this._getClientHeight(),
f=this._model.getLineCount(),e=this._getViewPadding(),c=this._viewDiv.getBoundingClientRect(),g=this._getLineHeight(),h=h+e.top+e.bottom-2*this._metrics.scrollWidth;g*f<h?e=e.top:(g=h/f,e=this._metrics.scrollWidth);c=Math.floor((a.clientY-c.top-e)/g);0<=c&&c<f||(c=void 0)}if(d)switch(a.type){case "click":if(d.onClick)d.onClick(c,a);break;case "dblclick":if(d.onDblClick)d.onDblClick(c,a);break;case "mousemove":if(d.onMouseMove)d.onMouseMove(c,a);break;case "mouseover":if(d.onMouseOver)d.onMouseOver(c,
a);break;case "mouseout":if(d.onMouseOut){for(f=a.relatedTarget;f&&f!==this._rootDiv;){if(f===b)return;f=f.parentNode}d.onMouseOut(c,a)}}},_handleScroll:function(){this._lastScrollTime=(new Date).getTime();var a=this._getScroll(!1),b=this._hScroll,c=this._vScroll;if(b!==a.x||c!==a.y)this._hScroll=a.x,this._vScroll=a.y,this._commitIME(),this._update(c===a.y),this.onScroll({type:"Scroll",oldValue:{x:b,y:c},newValue:a})},_handleSelectStart:function(a){var b=this._contextMenuOpen;this._contextMenuOpen=
!1;if(b)this._checkSelectionChange=!0;else if(this._ignoreSelect)return a&&a.preventDefault&&a.preventDefault(),!1},_getModelOffset:function(a,b){if(a){var c;c="DIV"===a.tagName?a:a.parentNode.parentNode;return!c._line?0:c._line.getModelOffset(a,b)}},_updateSelectionFromDOM:function(){if(!f.isIOS&&!f.isAndroid&&!this._checkSelectionChange)return!1;var a=this._getWindow().getSelection(),b=this._getModelOffset(a.anchorNode,a.anchorOffset),c=this._getModelOffset(a.focusNode,a.focusOffset),d=this._getSelections()[0];
if(void 0===b||void 0===c||d.start===b&&d.end===c)return!1;if(this._checkSelectionChange){var d=this._getLineNext(),h=this._getLinePrevious();if(a.anchorNode===d.firstChild.firstChild&&0===a.anchorOffset&&a.focusNode===h.firstChild.firstChild&&0===a.focusOffset)return!1;if(a.anchorNode===d.firstChild.firstChild&&0===a.anchorOffset&&a.focusNode===h.lastChild.firstChild||a.anchorNode===this._clientDiv&&a.focusNode===this._clientDiv)b=0,c=this.getModel().getCharCount()}this._setSelection(new v(b,c),
!1,!1);this._checkSelectionChange=!1;return!0},_cancelCheckSelection:function(){this._checkSelectionChange&&(this._checkSelectionChange=!1,this._cancelPollSelectionChange())},_cancelPollSelectionChange:function(){this._selPollTimer&&(this._getWindow().clearTimeout(this._selPollTimer),this._selPollTimer=null)},_pollSelectionChange:function(a){var b=this,c=this._getWindow();this._cancelPollSelectionChange();this._selPollTimer=c.setTimeout(function(){b._selPollTimer=null;b._clientDiv&&!b._updateSelectionFromDOM()&&
a&&b._pollSelectionChange(a)},100)},_handleSelectionChange:function(){-1===this._imeOffset&&(f.isAndroid?this._pollSelectionChange():this._updateSelectionFromDOM())},_handleTextInput:function(a){if(!this._ignoreEvent(a)&&-1===this._imeOffset){var b=this._getWindow().getSelection();if(b.anchorNode!==this._anchorNode||b.focusNode!==this._focusNode||b.anchorOffset!==this._anchorOffset||b.focusOffset!==this._focusOffset){for(var c=b.anchorNode;c&&void 0===c.lineIndex;)c=c.parentNode;if(c){var d=this._model,
h=c.lineIndex,f=d.getLine(h),e=f,g=0,d=d.getLineStart(h);0<b.rangeCount&&(b.getRangeAt(0).deleteContents(),h=c.ownerDocument.createTextNode(a.data),b.getRangeAt(0).insertNode(h),g=this._getDOMText(c,h),e=g.text,g=g.offset,h.parentNode.removeChild(h));c.lineRemoved=!0;for(c=0;f.charCodeAt(c)===e.charCodeAt(c)&&c<g;)c++;b=f.length-1;for(h=e.length-f.length;f.charCodeAt(b)===e.charCodeAt(b+h)&&b+h>=g+a.data.length;)b--;b++;f=e.substring(c,b+h);c+=d;b+=d;e=this._getSelections();g=e[0].start-c;d=e[0].end-
b;e[0].start=c;e[0].end=b;for(c=1;c<e.length;c++)e[c].start-=g,e[c].end-=d;this._modifyContent({text:f,selection:e,_ignoreDOMSelection:!0},!0)}}else this._doContent(a.data);a.preventDefault()}},_handleTouchStart:function(a){if(this.isListening("TouchStart")){var b=this._createTouchEvent("TouchStart",a);this.onTouchStart(b);if(b.defaultPrevented){a.preventDefault();return}if(this._noScroll)return}this._commitIME();b=this._getWindow();this._touchScrollTimer&&(this._vScrollDiv.style.display="none",this._hScrollDiv.style.display=
"none",b.clearInterval(this._touchScrollTimer),this._touchScrollTimer=null);var c=a.touches;if(1===c.length){var c=c[0],d=c.clientX,h=c.clientY;this._touchStartX=d;this._touchStartY=h;if(f.isAndroid&&(h<c.pageY-b.pageYOffset||d<c.pageX-b.pageXOffset))d=c.pageX-b.pageXOffset,h=c.pageY-b.pageYOffset;b=this.convert({x:d,y:h},"page","document");this._lastTouchOffset=this.getOffsetAtLocation(b.x,b.y);this._touchStartTime=a.timeStamp;this._touching=!0}},_handleTouchMove:function(a){if(this.isListening("TouchMove")){var b=
this._createTouchEvent("TouchMove",a);this.onTouchMove(b);if(b.defaultPrevented){a.preventDefault();return}if(this._noScroll)return}b=a.touches;if(1===b.length){b=b[0];this._touchCurrentX=b.clientX;this._touchCurrentY=b.clientY;if(!this._touchScrollTimer&&200>a.timeStamp-this._touchStartTime){this._vScrollDiv.style.display="block";this._wrapMode||(this._hScrollDiv.style.display="block");var c=this,d=this._getWindow();this._touchScrollTimer=d.setInterval(function(){var a=0,b=0;if(c._touching)a=c._touchStartX-
c._touchCurrentX,b=c._touchStartY-c._touchCurrentY,c._touchSpeedX=a/10,c._touchSpeedY=b/10,c._touchStartX=c._touchCurrentX,c._touchStartY=c._touchCurrentY;else{if(0.1>Math.abs(c._touchSpeedX)&&0.1>Math.abs(c._touchSpeedY)){c._vScrollDiv.style.display="none";c._hScrollDiv.style.display="none";d.clearInterval(c._touchScrollTimer);c._touchScrollTimer=null;return}a=10*c._touchSpeedX;b=10*c._touchSpeedY;c._touchSpeedX*=0.95;c._touchSpeedY*=0.95}c._scrollView(a,b)},10)}this._touchScrollTimer&&a.preventDefault()}},
_handleTouchEnd:function(a){if(this.isListening("TouchEnd")){var b=this._createTouchEvent("TouchEnd",a);this.onTouchEnd(b);if(b.defaultPrevented){a.preventDefault();return}if(this._noScroll)return}0===a.touches.length&&(this._touching=!1)},_doAction:function(a){var b,c,d=this._keyModes;for(c=d.length-1;0<=c;c--)if(b=d[c],"function"===typeof b.match&&(b=b.match(a),void 0!==b))return this.invokeAction(b);return!1},_doMove:function(a,b){var c=this._model,d=b.getCaret(),h=c.getLineAtOffset(d);a.count||
(a.count=1);for(;0!==a.count;){var f=c.getLineStart(h);if(0>a.count&&d===f)if(0<h)"character"===a.unit&&a.count++,h--,b.extend(c.getLineEnd(h));else break;else if(0<a.count&&d===c.getLineEnd(h))if(h+1<c.getLineCount())"character"===a.unit&&a.count--,h++,b.extend(c.getLineStart(h));else break;else{var e=!1;a.expandTab&&("character"===a.unit&&0===(d-f)%this._tabSize)&&(f=c.getText(f,d),e=!/[^ ]/.test(f));e?(b.extend(d-this._tabSize),a.count+=0>a.count?1:-1):(f=this._getLine(h),b.extend(f.getNextOffset(d,
a)),f.destroy())}d=b.getCaret()}return b},_doBackspace:function(a){var b=this,c=this._getSelections();c.forEach(function(c){c.isEmpty()&&(a.count||(a.count=1),a.count*=-1,a.expandTab=b._expandTab,b._doMove(a,c))});this._modifyContent({text:"",selection:c},!0);return!0},_doCase:function(a){var b=this,c=this._getSelections(),d=[];c.forEach(function(c){b._doMove(a,c);c=b.getText(c.start,c.end);switch(a.type){case "lower":c=c.toLowerCase();break;case "capitalize":c=c.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()});
break;case "reverse":for(var h="",f=0;f<c.length;f++)var e=c[f],g=e.toLowerCase(),e=g!==e?g:e.toUpperCase(),h=h+e;c=h;break;default:c=c.toUpperCase()}d.push(c)});return this._modifyContent({text:d,selection:c,_ignoreDOMSelection:!0},!0)},_doContent:function(a){var b=this,c=this._getSelections();c.forEach(function(a){if(b._overwriteMode&&a.isEmpty()){var c=b._model,d=c.getLineAtOffset(a.end);a.end<c.getLineEnd(d)&&(c=b._getLine(d),a.extend(c.getNextOffset(a.getCaret(),{unit:"character",count:1})),
c.destroy())}});return this._modifyContent({text:a,selection:c,_ignoreDOMSelection:!0},!0)},_doCopy:function(a){var b=this.getSelectionText();return b?this._setClipboardText(b,a):!0},_doCursorNext:function(a){var b=this,c=this._getSelections();c.forEach(function(c){!c.isEmpty()&&!a.select?c.start=c.end:b._doMove(a,c);a.select||c.collapse()});this._setSelection(c,!0);return!0},_doCursorPrevious:function(a){var b=this,c=this._getSelections();c.forEach(function(c){!c.isEmpty()&&!a.select?c.end=c.start:
(a.count||(a.count=1),a.count*=-1,b._doMove(a,c));a.select||c.collapse()});this._setSelection(c,!0);return!0},_doCut:function(a){var b=this.getSelectionText();return b?(this._doContent(""),this._setClipboardText(b,a)):!0},_doDelete:function(a){var b=this,c=this._getSelections();c.forEach(function(c){c.isEmpty()&&b._doMove(a,c)});this._modifyContent({text:"",selection:c},!0);return!0},_doEnd:function(a){var b=this._model,c=this,d=this._getSelections();d.forEach(function(d){if(a.ctrl)d.extend(b.getCharCount());
else{var h=d.getCaret(),f=b.getLineAtOffset(h);if(c._wrapMode){var e=c._getLine(f),h=e.getLineIndex(h),h=h===e.getLineCount()-1?b.getLineEnd(f):e.getLineStart(h+1)-1;e.destroy()}else a.count&&0<a.count&&(f=Math.min(f+a.count-1,b.getLineCount()-1)),h=b.getLineEnd(f);d.extend(h)}a.select||d.collapse()});this._setSelection(d,!0,!0,a.ctrl?function(){}:null);return!0},_doEnter:function(a){if(this._singleMode)return!0;var b=this._model,c=this._getSelections();this._doContent(b.getLineDelimiter());a&&a.noCursor&&
(c.forEach(function(a){a.end=a.start}),this._setSelection(c,!0));return!0},_doEscape:function(){var a=this._getSelections();1<a.length&&this._setSelection(a[0],!0);return!0},_doHome:function(a){var b=this._model,c=this,d=this._getSelections();d.forEach(function(d){if(a.ctrl)d.extend(0);else{var h=d.getCaret(),f=b.getLineAtOffset(h);c._wrapMode?(f=c._getLine(f),h=f.getLineIndex(h),h=f.getLineStart(h),f.destroy()):h=b.getLineStart(f);d.extend(h)}a.select||d.collapse()});this._setSelection(d,!0,!0,a.ctrl?
function(){}:null);return!0},_doLineDown:function(a){var b=this._model,c=this,d=this._getSelections();d.forEach(function(d){var h=d.getCaret(),e=b.getLineAtOffset(h),g=c._getLine(e),l=d._columnX,p=1,r=!1;if(-1===l||a.wholeLine||a.select&&f.isIE)l=a.wholeLine?b.getLineEnd(e+1):h,l=d._columnX=g.getBoundingClientRect(l).left;(h=g.getLineIndex(h))<g.getLineCount()-1?p=g.getClientRects(h+1).top+1:(h=b.getLineCount()-1,r=e===h,a.count&&0<a.count?e=Math.min(e+a.count,h):e++);h=!1;if(r){if(a.select||f.isMac||
f.isLinux)d.extend(b.getCharCount()),h=!0}else g.lineIndex!==e&&(g.destroy(),g=c._getLine(e)),d.extend(g.getOffset(l,p)),h=!0;h&&(a.select||d.collapse());g.destroy()});c._setSelection(d,!0,!0,null,0,!1,!0);return!0},_doLineUp:function(a){var b=this._model,c=this,d=this._getSelections();d.forEach(function(d){var h=d.getCaret(),e=b.getLineAtOffset(h),g=c._getLine(e),l=d._columnX,p=!1,r;if(-1===l||a.wholeLine||a.select&&f.isIE)l=a.wholeLine?b.getLineStart(e-1):h,l=d._columnX=g.getBoundingClientRect(l).left;
0<(h=g.getLineIndex(h))?r=g.getClientRects(h-1).top+1:(p=0===e,p||(a.count&&0<a.count?e=Math.max(e-a.count,0):e--,r=c._getLineHeight(e)-1));h=!1;if(p){if(a.select||f.isMac||f.isLinux)d.extend(0),h=!0}else g.lineIndex!==e&&(g.destroy(),g=c._getLine(e)),d.extend(g.getOffset(l,r)),h=!0;h&&(a.select||d.collapse());g.destroy()});c._setSelection(d,!0,!0,null,0,!1,!0);return!0},_doNoop:function(){return!0},_doPageDown:function(a){var b=this,c=this._model,d=this._getSelections(),h=c.getLineCount(),e=this._getScroll(),
g=this._getClientHeight(),l=this._getLineHeight(),p=Math.floor(g/l),r,k,n;d.forEach(function(d){var q=d.getCaret(),m=c.getLineAtOffset(q);if(b._lineHeight){r=d._columnX;var t=b._getBoundsAtOffset(q);if(-1===r||a.select&&f.isIE)r=d._columnX=t.left;q=b._getLineIndex(t.top+g);k=b._getLine(q);var m=b._getLinePixel(q),q=k.getOffset(r,t.top+g-m),u=k.getBoundingClientRect(q);k.destroy();d.extend(q);a.select||d.collapse();n=void 0!==n?Math.min(n,u.top+m-t.top):u.top+m-t.top}else if(m<h-1){t=Math.min(h-m-
1,p);t=Math.max(1,t);r=d._columnX;if(-1===r||a.select&&f.isIE)k=b._getLine(m),r=d._columnX=k.getBoundingClientRect(q).left,k.destroy();k=b._getLine(m+t);d.extend(k.getOffset(r,0));k.destroy();a.select||d.collapse();d=h*l;q=e.y+t*l;q+g>d&&(q=d-g);n=void 0!==n?Math.min(n,q-e.y):q-e.y}});this._setSelection(d,!0,!0,function(){},n,!1,!0);return!0},_doPageUp:function(a){var b=this,c=this._model,d=this._getSelections(),h=this._getScroll(),e=this._getClientHeight(),g=this._getLineHeight(),l=Math.floor(e/
g),p,r,k;d.forEach(function(d){var n=d.getCaret(),q=c.getLineAtOffset(n);if(b._lineHeight){p=d._columnX;q=b._getBoundsAtOffset(n);if(-1===p||a.select&&f.isIE)p=d._columnX=q.left;n=b._getLineIndex(q.bottom-e);r=b._getLine(n);var m=b._getLinePixel(n),n=r.getOffset(p,q.bottom-e-m),t=r.getBoundingClientRect(n);r.destroy();d.extend(n);a.select||d.collapse();k=void 0!==k?Math.max(k,t.top+m-q.top):t.top+m-q.top}else if(0<q){m=Math.max(1,Math.min(q,l));p=d._columnX;if(-1===p||a.select&&f.isIE)r=b._getLine(q),
p=d._columnX=r.getBoundingClientRect(n).left,r.destroy();r=b._getLine(q-m);d.extend(r.getOffset(p,b._getLineHeight(q-m)-1));r.destroy();a.select||d.collapse();d=Math.max(0,h.y-m*g);k=void 0!==k?Math.max(k,d-h.y):d-h.y}});this._setSelection(d,!0,!0,function(){},k,!1,!0);return!0},_doPaste:function(a){var b=this;return null!==this._getClipboardText(a,function(a){if(a.length){f.isLinux&&2===b._lastMouseButton&&(new Date).getTime()-b._lastMouseTime<=b._clickTime&&b._setSelectionTo(b._lastMouseX,b._lastMouseY,
!0);var c=b._getSelections(),d=b._singleMode?"":b._model.getLineDelimiter();b._doContent(1<c.length&&c.length===a.length?a:a.join(d))}})},_doScroll:function(a){var b=a.type,c=this._model,d=c.getLineCount();a=this._getClientHeight();var h=this._getLineHeight(),d=this._lineHeight?this._scrollHeight:d*h,f=this._getScroll().y,e;switch(b){case "textStart":e=0;break;case "textEnd":e=d-a;break;case "pageDown":e=f+a;break;case "pageUp":e=f-a;break;case "lineDown":e=f+h;break;case "lineUp":e=f-h;break;case "centerLine":b=
this._getSelections()[0],e=c.getLineAtOffset(b.start),c=(c.getLineAtOffset(b.end)-e+1)*h,e=e*h-a/2+c/2}void 0!==e&&(e=Math.min(Math.max(0,e),d-a),this._scrollViewAnimated(0,e-f,function(){}));return!0},_doSelectAll:function(){this._setSelection(new v(0,this._model.getCharCount()),!1);return!0},_doTab:function(){if(this._tabMode&&!this._readonly){var a="\t",b=this._getSelections();if(this._expandTab){var a=[],c=this._model,d=this._tabSize;b.forEach(function(b){b=b.getCaret();var h=c.getLineAtOffset(b),
h=c.getLineStart(h);a.push(Array(d-(b-h)%d+1).join(" "))})}return this._modifyContent({text:a,selection:b,_ignoreDOMSelection:!0},!0)}},_doShiftTab:function(){if(this._tabMode&&!this._readonly)return!0},_doOverwriteMode:function(){if(!this._readonly)return this.setOptions({overwriteMode:!this.getOptions("overwriteMode")}),!0},_doTabMode:function(){this._tabMode=!this._tabMode;return!0},_doWrapMode:function(){this.setOptions({wrapMode:!this.getOptions("wrapMode")});return!0},_autoScroll:function(){var a=
this._model,b=this._getSelections(),c=v.editing(b,"down"===this._autoScrollDir),d=this.convert({x:this._autoScrollX,y:this._autoScrollY},"page","document"),h=c.getCaret(),e=a.getLineCount(),g=a.getLineAtOffset(h),l;if("up"===this._autoScrollDir||"down"===this._autoScrollDir)h=this._autoScrollY/this._getLineHeight(),h=0>h?Math.floor(h):Math.ceil(h),l=Math.max(0,Math.min(e-1,g+h));else if("left"===this._autoScrollDir||"right"===this._autoScrollDir)l=this._getLineIndex(d.y),g=this._getLine(g),d.x+=g.getBoundingClientRect(h,
!1).left,g.destroy();this._blockSelection?b=this._getBlockSelections(b,l,d):0===l&&(f.isMac||f.isLinux)?c.extend(0):l===e-1&&(f.isMac||f.isLinux)?c.extend(a.getCharCount()):(g=this._getLine(l),c.extend(g.getOffset(d.x,d.y-this._getLinePixel(l))),g.destroy());this._setSelection(b,!0)},_autoScrollTimer:function(){this._autoScroll();var a=this;this._autoScrollTimerID=this._getWindow().setTimeout(function(){a._autoScrollTimer()},this._AUTO_SCROLL_RATE)},_calculateLineHeightTimer:function(a){if(this._lineHeight&&
!this._calculateLHTimer){var b=this._model.getLineCount(),c=0;if(a){a=0;for(var d=(new Date).getTime(),h=0;c<b&&!(this._lineHeight[c]||(a++,h||(h=c),this._lineHeight[c]=this._calculateLineHeight(c)),c++,100<(new Date).getTime()-d););this.redrawRulers(0,b);this._queueUpdate()}a=this._getWindow();if(c!==b){var f=this;this._calculateLHTimer=a.setTimeout(function(){f._calculateLHTimer=null;f._calculateLineHeightTimer(!0)},0)}else this._calculateLHTimer&&(a.clearTimeout(this._calculateLHTimer),this._calculateLHTimer=
void 0)}},_calculateLineHeight:function(a){a=this._getLine(a);var b=a.getBoundingClientRect();a.destroy();return Math.max(1,b.bottom-b.top)},_calculateMetrics:function(){var a=this._clientDiv,b=a.ownerDocument,c=f.createElement(b,"div");c.style.lineHeight="normal";var d={type:"LineStyle",textView:this,0:0,lineText:this._model.getLine(0),lineStart:0};this.onLineStyle(d);l(d.style,c);c.style.position="fixed";c.style.left="-1000px";var h=f.createElement(b,"span");h.appendChild(b.createTextNode(" "));
c.appendChild(h);var e=f.createElement(b,"span");e.style.fontStyle="italic";e.appendChild(b.createTextNode(" "));c.appendChild(e);var g=f.createElement(b,"span");g.style.fontWeight="bold";g.appendChild(b.createTextNode(" "));c.appendChild(g);d=f.createElement(b,"span");d.style.fontWeight="bold";d.style.fontStyle="italic";d.appendChild(b.createTextNode(" "));c.appendChild(d);a.appendChild(c);var k=c.getBoundingClientRect(),h=h.getBoundingClientRect(),e=e.getBoundingClientRect(),g=g.getBoundingClientRect(),
d=d.getBoundingClientRect(),h=h.bottom-h.top,e=e.bottom-e.top,g=g.bottom-g.top,n=d.bottom-d.top,q=0,d=0>=k.bottom-k.top,k=Math.max(1,k.bottom-k.top);e>h&&(q=1);g>e&&(q=2);n>g&&(q=3);var m;0!==q&&(m={style:{}},0!==(q&1)&&(m.style.fontStyle="italic"),0!==(q&2)&&(m.style.fontWeight="bold"));h=r(c);a.removeChild(c);q=p(this._viewDiv);c=f.createElement(b,"div");c.style.position="fixed";c.style.left="-1000px";c.style.paddingLeft=q.left+"px";c.style.paddingTop=q.top+"px";c.style.paddingRight=q.right+"px";
c.style.paddingBottom=q.bottom+"px";c.style.width="100px";c.style.height="100px";q=f.createElement(b,"div");q.style.width="100%";q.style.height="100%";c.appendChild(q);a.appendChild(c);e=c.getBoundingClientRect();g=q.getBoundingClientRect();n=0;!this._singleMode&&!this._noScroll&&(c.style.overflow="hidden",q.style.height="200px",n=c.clientWidth,c.style.overflow="scroll",n-=c.clientWidth);a.removeChild(c);var q={left:g.left-e.left,top:g.top-e.top,right:e.right-g.right,bottom:e.bottom-g.bottom},t=0,
u=g=0;if(!d){c=f.createElement(b,"div");c.style.position="fixed";c.style.left="-1000px";a.appendChild(c);c.innerHTML=Array(2).join("a");e=c.getBoundingClientRect();u=Math.ceil(e.right-e.left);if(this._wrapOffset||this._marginOffset)c.innerHTML=Array(this._wrapOffset+1+(f.isWebkit?0:1)).join(" "),e=c.getBoundingClientRect(),t=Math.ceil(e.right-e.left),c.innerHTML=Array(this._marginOffset+1).join(" "),g=c.getBoundingClientRect(),g=Math.ceil(g.right-g.left);a.removeChild(c)}return{lineHeight:k,largestFontStyle:m,
lineTrim:h,viewPadding:q,scrollWidth:n,wrapWidth:t,marginWidth:g,charWidth:u,invalid:d}},_cancelAnimation:function(){this._animation&&(this._animation.stop(),this._animation=null)},_clearSelection:function(a){var b=this._getSelections();b.forEach(function(b){"next"===a?b.start=b.end:b.end=b.start});this._setSelection(b,!0);return!0},_commitIME:function(a){if(-1!==this._imeOffset){var b=this._model,c=b.getLineAtOffset(this._imeOffset),d=b.getLineStart(c),h=this._getLineNode(c);if(!a){this._scrollDiv.focus();
this._clientDiv.focus();var e=this._getDOMText(h).text,b=b.getLine(c),d=this._imeOffset-d,b=d+e.length-b.length;d!==b&&(a=e.substring(d,b))}this._imeOffset=-1;a&&(!this._doContent(a)&&!f.isWebkit)&&(h.lineRemoved=!0,this._queueUpdate())}},_createActions:function(){this.addKeyMode(new e.DefaultKeyMode(this));var b=this;this._actions={noop:{defaultHandler:function(){return b._doNoop()}},lineUp:{defaultHandler:function(c){return b._doLineUp(a(c,{select:!1}))},actionDescription:{name:k.lineUp}},lineDown:{defaultHandler:function(c){return b._doLineDown(a(c,
{select:!1}))},actionDescription:{name:k.lineDown}},lineStart:{defaultHandler:function(c){return b._doHome(a(c,{select:!1,ctrl:!1}))},actionDescription:{name:k.lineStart}},lineEnd:{defaultHandler:function(c){return b._doEnd(a(c,{select:!1,ctrl:!1}))},actionDescription:{name:k.lineEnd}},charPrevious:{defaultHandler:function(c){return b._doCursorPrevious(a(c,{select:!1,unit:"character"}))},actionDescription:{name:k.charPrevious}},charNext:{defaultHandler:function(c){return b._doCursorNext(a(c,{select:!1,
unit:"character"}))},actionDescription:{name:k.charNext}},pageUp:{defaultHandler:function(c){return b._doPageUp(a(c,{select:!1}))},actionDescription:{name:k.pageUp}},pageDown:{defaultHandler:function(c){return b._doPageDown(a(c,{select:!1}))},actionDescription:{name:k.pageDown}},scrollPageUp:{defaultHandler:function(c){return b._doScroll(a(c,{type:"pageUp"}))},actionDescription:{name:k.scrollPageUp}},scrollPageDown:{defaultHandler:function(c){return b._doScroll(a(c,{type:"pageDown"}))},actionDescription:{name:k.scrollPageDown}},
scrollLineUp:{defaultHandler:function(c){return b._doScroll(a(c,{type:"lineUp"}))},actionDescription:{name:k.scrollLineUp}},scrollLineDown:{defaultHandler:function(c){return b._doScroll(a(c,{type:"lineDown"}))},actionDescription:{name:k.scrollLineDown}},wordPrevious:{defaultHandler:function(c){return b._doCursorPrevious(a(c,{select:!1,unit:"word"}))},actionDescription:{name:k.wordPrevious}},wordNext:{defaultHandler:function(c){return b._doCursorNext(a(c,{select:!1,unit:"word"}))},actionDescription:{name:k.wordNext}},
textStart:{defaultHandler:function(c){return b._doHome(a(c,{select:!1,ctrl:!0}))},actionDescription:{name:k.textStart}},textEnd:{defaultHandler:function(c){return b._doEnd(a(c,{select:!1,ctrl:!0}))},actionDescription:{name:k.textEnd}},scrollTextStart:{defaultHandler:function(c){return b._doScroll(a(c,{type:"textStart"}))},actionDescription:{name:k.scrollTextStart}},scrollTextEnd:{defaultHandler:function(c){return b._doScroll(a(c,{type:"textEnd"}))},actionDescription:{name:k.scrollTextEnd}},centerLine:{defaultHandler:function(c){return b._doScroll(a(c,
{type:"centerLine"}))},actionDescription:{name:k.centerLine}},selectLineUp:{defaultHandler:function(c){return b._doLineUp(a(c,{select:!0}))},actionDescription:{name:k.selectLineUp}},selectLineDown:{defaultHandler:function(c){return b._doLineDown(a(c,{select:!0}))},actionDescription:{name:k.selectLineDown}},selectWholeLineUp:{defaultHandler:function(c){return b._doLineUp(a(c,{select:!0,wholeLine:!0}))},actionDescription:{name:k.selectWholeLineUp}},selectWholeLineDown:{defaultHandler:function(c){return b._doLineDown(a(c,
{select:!0,wholeLine:!0}))},actionDescription:{name:k.selectWholeLineDown}},selectLineStart:{defaultHandler:function(c){return b._doHome(a(c,{select:!0,ctrl:!1}))},actionDescription:{name:k.selectLineStart}},selectLineEnd:{defaultHandler:function(c){return b._doEnd(a(c,{select:!0,ctrl:!1}))},actionDescription:{name:k.selectLineEnd}},selectCharPrevious:{defaultHandler:function(c){return b._doCursorPrevious(a(c,{select:!0,unit:"character"}))},actionDescription:{name:k.selectCharPrevious}},selectCharNext:{defaultHandler:function(c){return b._doCursorNext(a(c,
{select:!0,unit:"character"}))},actionDescription:{name:k.selectCharNext}},selectPageUp:{defaultHandler:function(c){return b._doPageUp(a(c,{select:!0}))},actionDescription:{name:k.selectPageUp}},selectPageDown:{defaultHandler:function(c){return b._doPageDown(a(c,{select:!0}))},actionDescription:{name:k.selectPageDown}},selectWordPrevious:{defaultHandler:function(c){return b._doCursorPrevious(a(c,{select:!0,unit:"word"}))},actionDescription:{name:k.selectWordPrevious}},selectWordNext:{defaultHandler:function(c){return b._doCursorNext(a(c,
{select:!0,unit:"word"}))},actionDescription:{name:k.selectWordNext}},selectTextStart:{defaultHandler:function(c){return b._doHome(a(c,{select:!0,ctrl:!0}))},actionDescription:{name:k.selectTextStart}},selectTextEnd:{defaultHandler:function(c){return b._doEnd(a(c,{select:!0,ctrl:!0}))},actionDescription:{name:k.selectTextEnd}},deletePrevious:{defaultHandler:function(c){return b._doBackspace(a(c,{unit:"character"}))},actionDescription:{name:k.deletePrevious}},deleteNext:{defaultHandler:function(c){return b._doDelete(a(c,
{unit:"character"}))},actionDescription:{name:k.deleteNext}},deleteWordPrevious:{defaultHandler:function(c){return b._doBackspace(a(c,{unit:"word"}))},actionDescription:{name:k.deleteWordPrevious}},deleteWordNext:{defaultHandler:function(c){return b._doDelete(a(c,{unit:"word"}))},actionDescription:{name:k.deleteWordNext}},deleteLineStart:{defaultHandler:function(c){return b._doBackspace(a(c,{unit:"line"}))},actionDescription:{name:k.deleteLineStart}},deleteLineEnd:{defaultHandler:function(c){return b._doDelete(a(c,
{unit:"line"}))},actionDescription:{name:k.deleteLineEnd}},tab:{defaultHandler:function(c){return b._doTab(a(c,{}))},actionDescription:{name:k.tab}},shiftTab:{defaultHandler:function(c){return b._doShiftTab(a(c,{}))},actionDescription:{name:k.shiftTab}},enter:{defaultHandler:function(c){return b._doEnter(a(c,{}))},actionDescription:{name:k.enter}},enterNoCursor:{defaultHandler:function(c){return b._doEnter(a(c,{noCursor:!0}))},actionDescription:{name:k.enterNoCursor}},escape:{defaultHandler:function(c){return b._doEscape(a(c,
{}))},actionDescription:{name:k.escape}},selectAll:{defaultHandler:function(c){return b._doSelectAll(a(c,{}))},actionDescription:{name:k.selectAll}},copy:{defaultHandler:function(c){return b._doCopy(a(c,{}))},actionDescription:{name:k.copy}},cut:{defaultHandler:function(c){return b._doCut(a(c,{}))},actionDescription:{name:k.cut}},paste:{defaultHandler:function(c){return b._doPaste(a(c,{}))},actionDescription:{name:k.paste}},uppercase:{defaultHandler:function(c){return b._doCase(a(c,{type:"upper"}))},
actionDescription:{name:k.uppercase}},lowercase:{defaultHandler:function(c){return b._doCase(a(c,{type:"lower"}))},actionDescription:{name:k.lowercase}},capitalize:{defaultHandler:function(c){return b._doCase(a(c,{unit:"word",type:"capitalize"}))},actionDescription:{name:k.capitalize}},reversecase:{defaultHandler:function(c){return b._doCase(a(c,{type:"reverse"}))},actionDescription:{name:k.reversecase}},toggleOverwriteMode:{defaultHandler:function(c){return b._doOverwriteMode(a(c,{}))},actionDescription:{name:k.toggleOverwriteMode}},
toggleTabMode:{defaultHandler:function(c){return b._doTabMode(a(c,{}))},actionDescription:{name:k.toggleTabMode}},toggleWrapMode:{defaultHandler:function(c){return b._doWrapMode(a(c,{}))},actionDescription:{name:k.toggleWrapMode}}}},_createRulerParent:function(a,b){var c=f.createElement(a,"div");c.className=b;c.tabIndex=-1;c.style.overflow="hidden";c.style.MozUserSelect="none";c.style.WebkitUserSelect="none";c.style.position="absolute";c.style.top="0px";c.style.bottom="0px";c.style.cursor="default";
c.style.display="none";c.setAttribute("aria-hidden","true");this._rootDiv.appendChild(c);return c},_createRuler:function(a,b){if(this._clientDiv){var c=this._getRulerParent(a);if(c){if(c!==this._marginDiv||this._marginOffset)c.style.display="block";c.rulerWidth=void 0;var d=f.createElement(c.ownerDocument,"div");d._ruler=a;a.node=d;d.rulerChanged=!0;d.style.position="relative";d.style.cssFloat="left";d.style.styleFloat="left";d.style.outline="none";if(void 0===b||0>b||b>=c.children.length)c.appendChild(d);
else{for(var h=c.firstChild;h&&0<b--;)h=h.nextSibling;c.insertBefore(d,h)}}}},_createSelectionDiv:function(){var a=f.createElement(this._parent.ownerDocument,"div");a.className="textviewSelection";a.style.position="absolute";a.style.borderWidth="0px";a.style.margin="0px";a.style.padding="0px";a.style.outline="none";a.style.width="0px";a.style.height="0px";a.style.zIndex="0";return a},_createView:function(){function a(){e._rootDiv&&(e.update(!0),e._metrics.invalid&&e._getWindow().setTimeout(function(){a()},
100))}if(!this._clientDiv){for(var b=this._parent;b.hasChildNodes();)b.removeChild(b.lastChild);var c=b.ownerDocument,d=f.createElement(c,"div");this._rootDiv=d;d.tabIndex=-1;d.style.position="relative";d.style.overflow="hidden";d.style.width="100%";d.style.height="100%";d.style.overflow="hidden";d.style.WebkitTextSizeAdjust="100%";d.setAttribute("role","application");b.appendChild(d);this._leftDiv=this._createRulerParent(c,"textviewLeftRuler");b=f.createElement(c,"div");b.className="textviewScroll";
this._viewDiv=b;b.tabIndex=-1;b.style.position="absolute";b.style.top="0px";b.style.bottom="0px";b.style.borderWidth="0px";b.style.margin="0px";b.style.outline="none";b.style.background="transparent";d.appendChild(b);var h=this._createRulerParent(c,"textviewRightRuler");this._rightDiv=h;h.style.right="0px";this._innerRightDiv=h=this._createRulerParent(c,"textviewInnerRightRuler");h.style.zIndex="1";this._scrollDiv=h=f.createElement(c,"div");h.style.margin="0px";h.style.borderWidth="0px";h.style.padding=
"0px";b.appendChild(h);(this._marginDiv=this._createRulerParent(c,"textviewMarginRuler")).style.zIndex="4";!f.isIE&&!f.isIOS&&(this._clipDiv=b=f.createElement(c,"div"),b.style.position="absolute",b.style.overflow="hidden",b.style.margin="0px",b.style.borderWidth="0px",b.style.padding="0px",b.style.background="transparent",d.appendChild(b),this._clipScrollDiv=h=f.createElement(c,"div"),h.style.position="absolute",h.style.height="1px",h.style.top="-1000px",h.style.background="transparent",b.appendChild(h));
b=f.createElement(c,"div");b.className="textviewContent";this._clientDiv=b;b.tabIndex=0;b.style.position="absolute";b.style.borderWidth="0px";b.style.margin="0px";b.style.padding="0px";b.style.outline="none";b.style.zIndex="1";b.style.WebkitUserSelect="text";b.setAttribute("spellcheck","false");if(f.isIOS||f.isAndroid)b.style.WebkitTapHighlightColor="transparent";(this._clipDiv||d).appendChild(b);this._setFullSelection(this._fullSelection,!0);if(f.isIOS||f.isAndroid)this._vScrollDiv=h=f.createElement(c,
"div"),h.style.position="absolute",h.style.borderWidth="1px",h.style.borderColor="white",h.style.borderStyle="solid",h.style.borderRadius="4px",h.style.backgroundColor="black",h.style.opacity="0.5",h.style.margin="0px",h.style.padding="0px",h.style.outline="none",h.style.zIndex="3",h.style.width="8px",h.style.display="none",d.appendChild(h),this._hScrollDiv=h=f.createElement(c,"div"),h.style.position="absolute",h.style.borderWidth="1px",h.style.borderColor="white",h.style.borderStyle="solid",h.style.borderRadius=
"4px",h.style.backgroundColor="black",h.style.opacity="0.5",h.style.margin="0px",h.style.padding="0px",h.style.outline="none",h.style.zIndex="3",h.style.height="8px",h.style.display="none",d.appendChild(h);f.isFirefox&&!b.setCapture&&(this._overlayDiv=h=f.createElement(c,"div"),h.style.position=b.style.position,h.style.borderWidth=b.style.borderWidth,h.style.margin=b.style.margin,h.style.padding=b.style.padding,h.style.cursor="text",h.style.zIndex="2",(this._clipDiv||d).appendChild(h));b.contentEditable=
"true";b.setAttribute("role","textbox");b.setAttribute("aria-multiline","true");this._setWrapMode(this._wrapMode,!0);this._setReadOnly(this._readonly);this._setThemeClass(this._themeClass,!0);this._setTabSize(this._tabSize,!0);this._setMarginOffset(this._marginOffset,!0);this._hookEvents();b=this._rulers;for(h=0;h<b.length;h++)this._createRuler(b[h]);this._update();var e=this;u(c,d,"textview",a)}},_defaultOptions:function(){return{parent:{value:void 0,update:null},model:{value:void 0,update:this.setModel},
scrollAnimation:{value:0,update:null},readonly:{value:!1,update:this._setReadOnly},fullSelection:{value:!0,update:this._setFullSelection},tabMode:{value:!0,update:null},tabSize:{value:8,update:this._setTabSize},expandTab:{value:!1,update:null},singleMode:{value:!1,update:this._setSingleMode},noScroll:{value:!1,update:this._setNoScroll},overwriteMode:{value:!1,update:this._setOverwriteMode},blockCursorVisible:{value:!1,update:this._setBlockCursor},marginOffset:{value:0,update:this._setMarginOffset},
wrapOffset:{value:0,update:this._setWrapOffset},wrapMode:{value:!1,update:this._setWrapMode},wrappable:{value:!1,update:null},undoStack:{value:null,update:this._setUndoStack},theme:{value:g.TextTheme.getTheme(),update:this._setTheme},themeClass:{value:void 0,update:this._setThemeClass}}},_destroyRuler:function(a){var b=this._getRulerParent(a);if(b)for(var c=b.firstChild;c;){if(c._ruler===a){c._ruler=void 0;b.removeChild(c);if(0===b.children.length&&(b!==this._marginDiv||!this._marginOffset))b.style.display=
"none";b.rulerWidth=void 0;break}c=c.nextSibling}},_destroyView:function(){if(this._clientDiv){this._setGrab(null);this._unhookEvents();var a=this._getWindow();this._autoScrollTimerID&&(a.clearTimeout(this._autoScrollTimerID),this._autoScrollTimerID=null);this._updateTimer&&(a.clearTimeout(this._updateTimer),this._updateTimer=null);this._calculateLHTimer&&(a.clearTimeout(this._calculateLHTimer),this._calculateLHTimer=null);this._cursorTimer&&(a.clearInterval(this._cursorTimer),this._cursorTimer=null);
this._imeTimeout&&(a.clearInterval(this._imeTimeout),this._imeTimeout=null);a=this._rootDiv;a.parentNode.removeChild(a);this._hScrollDiv=this._vScrollDiv=this._cursorDiv=this._marginDiv=this._innerRightDiv=this._rightDiv=this._leftDiv=this._overlayDiv=this._clientDiv=this._clipScrollDiv=this._clipDiv=this._viewDiv=this._scrollDiv=this._rootDiv=this._clipboardDiv=this._domSelection=null}},_doAutoScroll:function(a,b,c){this._autoScrollDir=a;this._autoScrollX=b;this._autoScrollY=c;this._autoScrollTimerID||
this._autoScrollTimer()},_endAutoScroll:function(){this._autoScrollTimerID&&this._getWindow().clearTimeout(this._autoScrollTimerID);this._autoScrollTimerID=this._autoScrollDir=void 0},_fixCaret:function(){var a=this._clientDiv;if(a){var b=this._hasFocus;this._ignoreFocus=!0;b&&a.blur();a.contentEditable=!1;a.contentEditable=!0;b&&a.focus();this._ignoreFocus=!1}},_getBaseText:function(a,b){var c=this._model;c.getBaseModel&&(a=c.mapOffset(a),b=c.mapOffset(b),c=c.getBaseModel());return c.getText(a,b)},
_getBottomIndex:function(a){var b=this._bottomChild;if(a&&this._getClientHeight()>this._getLineHeight()){a=b.getBoundingClientRect();var c=this._clientDiv.getBoundingClientRect();a.bottom>c.bottom&&(b=this._getLinePrevious(b)||b)}return b.lineIndex},_getBlockSelections:function(a,b,c){var d=this._model;a=a.filter(function(a){return!a._editing});var h=d.getLineAtOffset(this._blockSelection.getAnchor()),e;b>h?e=b:(e=h,h=b);for(b=h;b<=e;b++){var f=this._getLine(b),h=f.getOffset(c.x,1),g=f.getOffset(this._blockSelection._docX,
1);f.destroy();h===g&&h===d.getLineEnd(b)||(f=h<g,h=new v(f?h:g,f?g:h,f),h._editing=!0,a.push(h))}return a},_getBoundsAtOffset:function(a){var b=this._getLine(this._model.getLineAtOffset(a));a=b.getBoundingClientRect(a);var c=this._getLinePixel(b.lineIndex);a.top+=c;a.bottom+=c;b.destroy();return a},_getClientHeight:function(){var a=this._getViewPadding();return Math.max(0,this._viewDiv.clientHeight-a.top-a.bottom)},_getInnerRightWidth:function(){var a=this._innerRightDiv.rulerWidth;void 0===a&&(a=
this._innerRightDiv.getBoundingClientRect(),this._innerRightDiv.rulerWidth=a=a.right-a.left);return a},_getClientWidth:function(){var a=this._getViewPadding(),b=this._getInnerRightWidth();return Math.max(0,this._viewDiv.clientWidth-a.left-a.right-b)},_getClipboardText:function(a,b){function c(a){var d=[];h(a,function(a){d.push(a)},null);b&&b(d);return d}var d=this._getWindow(),e=d.clipboardData;!e&&a&&(e=a.clipboardData);if(e)return c(e.getData(f.isIE?"Text":"text/plain"));if(f.isFirefox){this._ignoreFocus=
!0;var g=this._clipboardDiv,e=this._rootDiv.ownerDocument;g||(this._clipboardDiv=g=f.createElement(e,"div"),g.style.position="fixed",g.style.whiteSpace="pre",g.style.left="-1000px",this._rootDiv.appendChild(g));g.innerHTML="\x3cpre contenteditable\x3d''\x3e\x3c/pre\x3e";g.firstChild.focus();var l=this,p=function(){var a=l._getTextFromElement(g);g.innerHTML="";return c(a)},r=!1;this._ignorePaste=!0;if(!f.isLinux||2!==this._lastMouseButton)try{r=e.execCommand("paste",!1,null)}catch(k){r=1<g.childNodes.length||
g.firstChild&&0<g.firstChild.childNodes.length}this._ignorePaste=!1;if(!r){if(a)return d.setTimeout(function(){l.focus();p();l._ignoreFocus=!1},0),null;this.focus();this._ignoreFocus=!1;return""}this.focus();this._ignoreFocus=!1;return p()}return""},_getDOMText:function(a,b){return a._line.getText(b)},_getTextFromElement:function(a){var b=a.ownerDocument,c=b.defaultView;if(!c.getSelection)return a.innerText||a.textContent;b=b.createRange();b.selectNode(a);a=c.getSelection();var c=[],d;for(d=0;d<a.rangeCount;d++)c.push(a.getRangeAt(d));
this._ignoreSelect=!0;a.removeAllRanges();a.addRange(b);b=a.toString();a.removeAllRanges();for(d=0;d<c.length;d++)a.addRange(c[d]);this._ignoreSelect=!1;return b},_getViewPadding:function(){return this._metrics.viewPadding},_getLine:function(a){var b=this._getLineNode(a);return b&&!b.lineChanged&&!b.lineRemoved?b._line:new A(this,a)},_getLineHeight:function(a,b){if(void 0!==a&&this._lineHeight){var c=this._lineHeight[a];if(c)return c;if(b||void 0===b)return this._lineHeight[a]=this._calculateLineHeight(a)}return this._metrics.lineHeight},
_getLineNode:function(a){for(var b=this._clientDiv.firstChild;b;){if(a===b.lineIndex)return b;b=b.nextSibling}},_getLineNext:function(a){for(a=a?a.nextSibling:this._clientDiv.firstChild;a&&(-1===a.lineIndex||!a._line);)a=a.nextSibling;return a},_getLinePrevious:function(a){for(a=a?a.previousSibling:this._clientDiv.lastChild;a&&(-1===a.lineIndex||!a._line);)a=a.previousSibling;return a},_getLinePixel:function(a){a=Math.min(Math.max(0,a),this._model.getLineCount());if(this._lineHeight){var b=this._getTopIndex(),
c=-this._topIndexY+this._getScroll().y;if(a>b)for(;b<a;b++)c+=this._getLineHeight(b);else for(b-=1;b>=a;b--)c-=this._getLineHeight(b);return c}return this._getLineHeight()*a},_getLineIndex:function(a,b){var c,d=0,h=this._model.getLineCount();if(this._lineHeight){var d=this._getTopIndex(),e=-this._topIndexY+this._getScroll().y;if(a!==e)if(a<e)for(;a<e&&0<d;)a+=this._getLineHeight(--d);else for(c=this._getLineHeight(d);a-c>=e&&d<h-1;)a-=c,c=this._getLineHeight(++d)}else c=this._getLineHeight(),d=Math.floor(a/
c);return b&&(0===h||0>d||d>h-1)?-1:Math.max(0,Math.min(h-1,d))},_getRulerParent:function(a){switch(a.getLocation()){case "left":return this._leftDiv;case "right":return this._rightDiv;case "innerRight":return this._innerRightDiv;case "margin":return this._marginDiv}return null},_getScroll:function(a){(void 0===a||a)&&this._cancelAnimation();a=this._viewDiv;return{x:a.scrollLeft,y:a.scrollTop}},_getSelection:function(){return(Array.isArray(this._selection)?this._selection[0]:this._selection).clone()},
_getSelections:function(){return(Array.isArray(this._selection)?this._selection:[this._selection]).map(function(a){return a.clone()})},_getTopIndex:function(a){var b=this._topChild;if(a&&this._getClientHeight()>this._getLineHeight()){a=b.getBoundingClientRect();var c=this._getViewPadding(),d=this._viewDiv.getBoundingClientRect();a.top<d.top+c.top&&(b=this._getLineNext(b)||b)}return b.lineIndex},_hookEvents:function(){var a=this;this._modelListener={onChanging:function(b){a._onModelChanging(b)},onChanged:function(b){a._onModelChanged(b)}};
this._model.addEventListener("preChanging",this._modelListener.onChanging);this._model.addEventListener("postChanged",this._modelListener.onChanged);this._themeListener={onChanged:function(){a._setThemeClass(a._themeClass)}};this._theme.addEventListener("ThemeChanged",this._themeListener.onChanged);var b=this._handlers=[],c=this._clientDiv,d=this._viewDiv,h=this._rootDiv,e=this._overlayDiv||c,g=c.ownerDocument,l=this._getWindow(),p=f.isIE?g:l;b.push({target:l,type:"resize",handler:function(b){return a._handleResize(b?
b:l.event)}});b.push({target:c,type:"blur",handler:function(b){return a._handleBlur(b?b:l.event)}});b.push({target:c,type:"focus",handler:function(b){return a._handleFocus(b?b:l.event)}});b.push({target:d,type:"focus",handler:function(){c.focus()}});b.push({target:d,type:"scroll",handler:function(b){return a._handleScroll(b?b:l.event)}});b.push({target:c,type:"textInput",handler:function(b){return a._handleTextInput(b?b:l.event)}});b.push({target:c,type:"keydown",handler:function(b){return a._handleKeyDown(b?
b:l.event)}});b.push({target:c,type:"keypress",handler:function(b){return a._handleKeyPress(b?b:l.event)}});b.push({target:c,type:"keyup",handler:function(b){return a._handleKeyUp(b?b:l.event)}});f.isIE&&b.push({target:g,type:"keyup",handler:function(b){return a._handleDocKeyUp(b?b:l.event)}});b.push({target:c,type:"contextmenu",handler:function(b){return a._handleContextMenu(b?b:l.event)}});b.push({target:c,type:"copy",handler:function(b){return a._handleCopy(b?b:l.event)}});b.push({target:c,type:"cut",
handler:function(b){return a._handleCut(b?b:l.event)}});b.push({target:c,type:"paste",handler:function(b){return a._handlePaste(b?b:l.event)}});b.push({target:g,type:"selectionchange",handler:function(b){return a._handleSelectionChange(b?b:l.event)}});if(f.isIOS||f.isAndroid)b.push({target:c,type:"touchstart",handler:function(b){return a._handleTouchStart(b?b:l.event)}}),b.push({target:c,type:"touchmove",handler:function(b){return a._handleTouchMove(b?b:l.event)}}),b.push({target:c,type:"touchend",
handler:function(b){return a._handleTouchEnd(b?b:l.event)}});else{b.push({target:c,type:"selectstart",handler:function(b){return a._handleSelectStart(b?b:l.event)}});b.push({target:c,type:"mousedown",handler:function(b){return a._handleMouseDown(b?b:l.event)}});b.push({target:c,type:"mouseover",handler:function(b){return a._handleMouseOver(b?b:l.event)}});b.push({target:c,type:"mouseout",handler:function(b){return a._handleMouseOut(b?b:l.event)}});b.push({target:p,type:"mouseup",handler:function(b){return a._handleMouseUp(b?
b:l.event)}});b.push({target:p,type:"mousemove",handler:function(b){return a._handleMouseMove(b?b:l.event)}});b.push({target:h,type:"mousedown",handler:function(b){return a._handleRootMouseDown(b?b:l.event)}});b.push({target:h,type:"mouseup",handler:function(b){return a._handleRootMouseUp(b?b:l.event)}});b.push({target:e,type:"dragstart",handler:function(b){return a._handleDragStart(b?b:l.event)}});b.push({target:e,type:"drag",handler:function(b){return a._handleDrag(b?b:l.event)}});b.push({target:e,
type:"dragend",handler:function(b){return a._handleDragEnd(b?b:l.event)}});b.push({target:e,type:"dragenter",handler:function(b){return a._handleDragEnter(b?b:l.event)}});b.push({target:e,type:"dragover",handler:function(b){return a._handleDragOver(b?b:l.event)}});b.push({target:e,type:"dragleave",handler:function(b){return a._handleDragLeave(b?b:l.event)}});b.push({target:e,type:"drop",handler:function(b){return a._handleDrop(b?b:l.event)}});b.push({target:this._clientDiv,type:26<f.isFirefox?"wheel":
f.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(b){return a._handleMouseWheel(b?b:l.event)}});this._clipDiv&&b.push({target:this._clipDiv,type:26<f.isFirefox?"wheel":f.isFirefox?"DOMMouseScroll":"mousewheel",handler:function(b){return a._handleMouseWheel(b?b:l.event)}});if(f.isFirefox&&(!f.isWindows||15<=f.isFirefox))(d=l.MutationObserver||l.MozMutationObserver)?(this._mutationObserver=new d(function(b){a._handleDataModified(b)}),this._mutationObserver.observe(c,{subtree:!0,characterData:!0})):
b.push({target:this._clientDiv,type:"DOMCharacterDataModified",handler:function(b){return a._handleDataModified(b?b:l.event)}});if(f.isFirefox&&(!f.isWindows||15<=f.isFirefox)||f.isIE||f.isWebkit)b.push({target:this._clientDiv,type:"compositionstart",handler:function(b){return a._handleCompositionStart(b?b:l.event)}}),b.push({target:this._clientDiv,type:"compositionend",handler:function(b){return a._handleCompositionEnd(b?b:l.event)}}),b.push({target:this._clientDiv,type:"compositionupdate",handler:function(b){return a._handleCompositionUpdate(b?
b:l.event)}});this._overlayDiv&&(b.push({target:this._overlayDiv,type:"mousedown",handler:function(b){return a._handleMouseDown(b?b:l.event)}}),b.push({target:this._overlayDiv,type:"mouseover",handler:function(b){return a._handleMouseOver(b?b:l.event)}}),b.push({target:this._overlayDiv,type:"mouseout",handler:function(b){return a._handleMouseOut(b?b:l.event)}}),b.push({target:this._overlayDiv,type:"contextmenu",handler:function(b){return a._handleContextMenu(b?b:l.event)}}));this._isW3CEvents||b.push({target:this._clientDiv,
type:"dblclick",handler:function(b){return a._handleDblclick(b?b:l.event)}})}this._hookRulerEvents(this._leftDiv,b);this._hookRulerEvents(this._rightDiv,b);this._hookRulerEvents(this._innerRightDiv,b);this._hookRulerEvents(this._marginDiv,b);for(d=0;d<b.length;d++)h=b[d],C(h.target,h.type,h.handler,h.capture)},_hookRulerEvents:function(a,b){if(a){var c=this,d=this._getWindow();f.isIE&&b.push({target:a,type:"selectstart",handler:function(){return!1}});b.push({target:a,type:26<f.isFirefox?"wheel":f.isFirefox?
"DOMMouseScroll":"mousewheel",handler:function(a){return c._handleMouseWheel(a?a:d.event)}});b.push({target:a,type:"click",handler:function(a){c._handleRulerEvent(a?a:d.event)}});b.push({target:a,type:"dblclick",handler:function(a){c._handleRulerEvent(a?a:d.event)}});b.push({target:a,type:"mousemove",handler:function(a){c._handleRulerEvent(a?a:d.event)}});b.push({target:a,type:"mouseover",handler:function(a){c._handleRulerEvent(a?a:d.event)}});b.push({target:a,type:"mouseout",handler:function(a){c._handleRulerEvent(a?
a:d.event)}})}},_getWindow:function(){return this._parent.ownerDocument.defaultView||this._parent.ownerDocument.parentWindow},_ignoreEvent:function(a){for(a=a.target;a&&a!==this._clientDiv;){if(a.ignore)return!0;a=a.parentNode}return!1},_init:function(a){var b=a.parent;"string"===typeof b&&(b=(a.document||document).getElementById(b));if(!b)throw Error("no parent");a.parent=b;a.model=a.model||new m.TextModel;var c=this._defaultOptions(),d;for(d in c)c.hasOwnProperty(d)&&(this["_"+d]=void 0!==a[d]?
a[d]:c[d].value);this._keyModes=[];this._rulers=[];this._selection=[new v(0,0,!1)];this._linksVisible=!1;this._maxLineWidth=this._redrawCount=0;this._maxLineIndex=-1;this._ignoreSelect=!0;this._hasFocus=this._ignoreFocus=!1;this._dragOffset=-1;this._isRangeRects=(!f.isIE||9<=f.isIE)&&"function"===typeof b.ownerDocument.createRange().getBoundingClientRect;this._isW3CEvents=b.addEventListener;this._autoScrollTimerID=this._autoScrollY=this._autoScrollX=null;this._AUTO_SCROLL_RATE=50;this._mouseUpClosure=
this._moseMoveClosure=this._grabControl=null;this._clickCount=this._lastMouseTime=this._lastMouseY=this._lastMouseX=0;this._clickTime=250;this._clickDist=5;this._isMouseDown=!1;this._doubleClickSelection=null;this._vScroll=this._hScroll=0;this._imeOffset=-1;this._createActions();this._createView()},_checkOverlayScroll:function(){if(f.isMac&&f.isWebkit&&!this._metrics.invalid&&0===this._metrics.scrollWidth){var a=this._viewDiv,b=this._isOverOverlayScroll();a.style.pointerEvents=b.vertical||b.horizontal?
"":"none"}},_isOverOverlayScroll:function(){if(!(200>(new Date).getTime()-this._lastScrollTime))return{};var a=this._viewDiv.getBoundingClientRect(),b=this._lastMouseMoveX,c=this._lastMouseMoveY;return{vertical:a.top<=c&&c<a.bottom&&a.right-15<=b&&b<a.right,horizontal:a.bottom-15<=c&&c<a.bottom&&a.left<=b&&b<a.right}},_startUndo:function(){if(this._undoStack){var a=this;this._compoundChange=this._undoStack.startCompoundChange({end:function(){a._compoundChange=null}})}},_endUndo:function(){this._undoStack&&
this._undoStack.endCompoundChange()},_modifyContent:function(a,b,c,d){if(this._readonly&&!a._code)return!1;a.type="Verify";var h=a.start=a.selection[0].start,e=a.end=a.selection[0].end;this.onVerify(a);h!==a.start&&(a.selection[0].start=a.start);e!==a.end&&(a.selection[0].end=a.end);if(null===a.text||void 0===a.text)return!1;1<a.selection.length&&this.setRedraw(!1);(h=this._compoundChange)?v.compare(this._getSelections(),h.owner.selection)||(this._endUndo(),1<a.selection.length&&this._startUndo()):
1<a.selection.length&&this._startUndo();var f=this._model;try{a._ignoreDOMSelection&&(this._ignoreDOMSelection=!0);var g=0,l=0;a.selection.forEach(function(c){c.start+=g;c.end+=g;var d=Array.isArray(a.text)?a.text[l]:a.text;f.setText(d,c.start,c.end);g+=c.start-c.end+d.length;c.setCaret(b?c.start+d.length:c.start);l++})}finally{a._ignoreDOMSelection&&(this._ignoreDOMSelection=!1)}this._setSelection(a.selection,c,!0,d);if(h=this._compoundChange)h.owner.selection=a.selection;1<a.selection.length&&this.setRedraw(!0);
this.onModify({type:"Modify"});return!0},_onModelChanged:function(a){a.type="ModelChanged";this.onModelChanged(a);a.type="Changed";var b=a.start,c=a.addedCharCount,d=a.removedCharCount,h=a.addedLineCount,e=a.removedLineCount,f=this._getSelections();f.forEach(function(a){a.end>b&&(a.end>b&&a.start<b+d?a.setCaret(b+c):(a.start+=c-d,a.end+=c-d))});this._setSelection(f,!1,!1);for(var f=this._model.getLineAtOffset(b),g=this._getLineNext();g;){var l=g.lineIndex;f<=l&&l<=f+e&&(f===l&&!g.modelChangedEvent&&
!g.lineRemoved?(g.modelChangedEvent=a,g.lineChanged=!0):(g.lineRemoved=!0,g.lineChanged=!1,g.modelChangedEvent=null));l>f+e&&(g.lineIndex=l+h-e,g._line.lineIndex=g.lineIndex);g=this._getLineNext(g)}this._lineHeight&&(a=[f,e].concat(Array(h)),Array.prototype.splice.apply(this._lineHeight,a));!this._wrapMode&&(f<=this._maxLineIndex&&this._maxLineIndex<=f+e)&&(this._checkMaxLineIndex=this._maxLineIndex,this._maxLineIndex=-1,this._maxLineWidth=0);this._update()},_onModelChanging:function(a){a.type="ModelChanging";
this.onModelChanging(a);a.type="Changing"},_queueUpdate:function(){if(!this._updateTimer&&!this._ignoreQueueUpdate){var a=this;this._updateTimer=this._getWindow().setTimeout(function(){a._updateTimer=null;a._update()},0)}},_rangesToSelections:function(a){var b=[],c=this._model.getCharCount();a.forEach(function(a){var d;if(a instanceof v)d=a.clone();else{d=a.start;a=a.end;var h=d>a;if(h){var e=d;d=a;a=e}d=Math.max(0,Math.min(d,c));a=Math.max(0,Math.min(a,c));d=new v(d,a,h)}b.push(d)});return b},_resetLineHeight:function(a,
b){if(this._wrapMode||this._variableLineHeight){if(void 0!==a&&void 0!==b)for(var c=a;c<b;c++)this._lineHeight[c]=void 0;else c=this._model.getLineCount(),this._lineHeight=Array(c);this._calculateLineHeightTimer()}else this._lineHeight=null},_resetLineWidth:function(){var a=this._clientDiv;if(a)for(a=a.firstChild;a;)a.lineWidth=void 0,a=a.nextSibling},_reset:function(){this._maxLineIndex=-1;this._maxLineWidth=0;this._bottomChild=this._topChild=null;this._topIndexY=0;this._variableLineHeight=!1;this._resetLineHeight();
this._setSelection(new v(0,0,!1),!1,!1);this._viewDiv&&(this._viewDiv.scrollLeft=0,this._viewDiv.scrollTop=0);var a=this._clientDiv;if(a){for(a=a.firstChild;a;)a.lineRemoved=!0,a=a.nextSibling;13>f.isFirefox&&this._fixCaret()}},_scrollViewAnimated:function(a,b,c){var d=this._getWindow();if(c&&this._scrollAnimation){var h=this;this._animation=new B({window:d,duration:this._scrollAnimation,curve:[b,0],onAnimate:function(a){a=b-Math.floor(a);h._scrollView(0,a);b-=a},onEnd:function(){h._animation=null;
h._scrollView(a,b);c&&d.setTimeout(c,0)}});this._animation.play()}else this._scrollView(a,b),c&&d.setTimeout(c,0)},_scrollView:function(a,b){this._ensureCaretVisible=!1;var c=this._viewDiv;a&&(c.scrollLeft+=a);b&&(c.scrollTop+=b)},_setClipboardText:function(a,b){var c,d=this._getWindow(),e=d.clipboardData;!e&&b&&(e=b.clipboardData);if(e&&(c=[],h(a,function(a){c.push(a)},function(){c.push(f.platformDelimiter)}),e.setData(f.isIE?"Text":"text/plain",c.join(""))||21<f.isFirefox))return!0;var g=this._parent.ownerDocument,
l=f.createElement(g,"pre");l.style.position="fixed";l.style.left="-1000px";h(a,function(a){l.appendChild(g.createTextNode(a))},function(){l.appendChild(f.createElement(g,"br"))});l.appendChild(g.createTextNode(" "));this._clientDiv.appendChild(l);e=g.createRange();e.setStart(l.firstChild,0);e.setEndBefore(l.lastChild);var p=d.getSelection();0<p.rangeCount&&p.removeAllRanges();p.addRange(e);var r=this,e=function(){l&&l.parentNode===r._clientDiv&&r._clientDiv.removeChild(l);r._updateDOMSelection()},
p=!1;this._ignoreCopy=!0;try{p=g.execCommand("copy",!1,null)}catch(k){}this._ignoreCopy=!1;if(!p&&b)return d.setTimeout(e,0),!1;e();return!0},_setGrab:function(a){a!==this._grabControl&&(a?(a.setCapture&&a.setCapture(),this._grabControl=a):(this._grabControl.releaseCapture&&this._grabControl.releaseCapture(),this._grabControl=null))},_setLinksVisible:function(a){if(this._linksVisible!==a){this._linksVisible=a;f.isIE&&a&&(this._hadFocus=this._hasFocus);var b=this._clientDiv;b.contentEditable=!a;this._hadFocus&&
!a&&b.focus();this._overlayDiv&&(this._overlayDiv.style.zIndex=a?"-1":"1");for(a=this._getLineNext();a;)a._line.updateLinks(),a=this._getLineNext(a);this._updateDOMSelection()}},_setSelection:function(a,b,c,d,h,e,f){if(a){void 0===c&&(c=!0);var g=this._getSelections();a=Array.isArray(a)?a:e?g.concat([a]):[a];this._selection=v.merge(a);f||a.forEach(function(a){a._columnX=-1});!1!==b&&this._showCaret(!1,d,b,h);c&&this._updateDOMSelection();v.compare(g,a)||(b={type:"Selection",oldValue:v.convert(g),
newValue:v.convert(a)},this.onSelection(b))}},_setSelectionTo:function(a,b,c,d,h,e){var f=this._model,g=this._getSelections(),l=this.convert({x:a,y:b},"page","document");b=this._getLineIndex(l.y);a=this._getLine(b);var p=a.getOffset(l.x,l.y-this._getLinePixel(b));if(e&&!d&&v.contains(g,p))return this._dragOffset=p,a.destroy(),!1;this._blockSelection?g=this._getBlockSelections(g,b,l):(c?d?(c=g[g.length-1],c._editing=!0):(c=new v(0,0),c._editing=!0,h?g.push(c):g=[c],c._docX=l.x):c=v.editing(g),1===
this._clickCount?(c.extend(p),d||c.collapse()):(0===(this._clickCount&1)?this._doubleClickSelection?p>=this._doubleClickSelection.start?(d=this._doubleClickSelection.start,f=a.getNextOffset(p,{unit:"wordend",count:1})):(d=a.getNextOffset(p,{unit:"word",count:-1}),f=this._doubleClickSelection.end):(d=a.getNextOffset(p,{unit:"word",count:-1}),f=a.getNextOffset(d,{unit:"wordend",count:1})):this._doubleClickSelection?(h=f.getLineAtOffset(this._doubleClickSelection.start),b>=h?(d=f.getLineStart(h),f=f.getLineEnd(b)):
(d=f.getLineStart(b),f=f.getLineEnd(h))):(d=f.getLineStart(b),f=f.getLineEnd(b)),c.setCaret(d),c.extend(f)));this._setSelection(g,!0,!0,null,!1);a.destroy();return!0},_setFullSelection:function(a,b){this._fullSelection=a;f.isWebkit&&(this._fullSelection=!0);this._domSelection||(this._domSelection=[],this._cursorVisible=!0);b||this._updateDOMSelection()},_setBlockCursor:function(a){this._blockCursorVisible=a;this._updateBlockCursorVisible()},_setOverwriteMode:function(a){this._overwriteMode=a;this._updateBlockCursorVisible()},
_updateBlockCursorVisible:function(){if(this._blockCursorVisible||this._overwriteMode){if(!this._cursorDiv){var a=this._viewDiv,b=f.createElement(a.ownerDocument,"div");b.className="textviewBlockCursor";this._cursorDiv=b;b.tabIndex=-1;b.style.zIndex="2";b.style.color="transparent";b.style.position="absolute";b.style.pointerEvents="none";b.innerHTML="\x26nbsp;";a.appendChild(b);this._updateDOMSelection()}}else this._cursorDiv&&(this._cursorDiv.parentNode.removeChild(this._cursorDiv),this._cursorDiv=
null)},_setMarginOffset:function(a,b){this._marginOffset=a;this._marginDiv.style.display=a?"block":"none";b||(this._metrics=this._calculateMetrics(),this._queueUpdate())},_setWrapOffset:function(a,b){this._wrapOffset=a;b||(this._metrics=this._calculateMetrics(),this._queueUpdate())},_setReadOnly:function(a){this._readonly=a;this._clientDiv.setAttribute("aria-readonly",a?"true":"false")},_setSingleMode:function(a,b){this._singleMode=a;this._updateOverflow();this._updateStyle(b)},_setNoScroll:function(a,
b){this._noScroll=a;this._updateOverflow();this._updateStyle(b)},_setTabSize:function(a,b){this._tabSize=a;this._customTabSize=void 0;var c=this._clientDiv;f.isOpera?c&&(c.style.OTabSize=this._tabSize+""):537.1<=f.isWebkit?c&&(c.style.tabSize=this._tabSize+""):4<=f.isFirefox?c&&(c.style.MozTabSize=this._tabSize+""):8!==this._tabSize&&(this._customTabSize=this._tabSize);b||(this.redrawLines(),this._resetLineWidth())},_setTheme:function(a){this._theme&&this._theme.removeEventListener("ThemeChanged",
this._themeListener.onChanged);(this._theme=a)&&this._theme.addEventListener("ThemeChanged",this._themeListener.onChanged);this._setThemeClass(this._themeClass)},_setThemeClass:function(a,b){this._themeClass=a;var c="textview",d=this._theme.getThemeClass();d&&(c+=" "+d);this._themeClass&&d!==this._themeClass&&(c+=" "+this._themeClass);this._rootDiv.className=c;this._updateStyle(b)},_setUndoStack:function(a){this._undoStack=a},_setWrapMode:function(a,b){this._wrapMode=a&&this._wrappable;var c=this._clientDiv;
this._wrapMode?(c.style.whiteSpace="pre-wrap",c.style.wordWrap="break-word"):(c.style.whiteSpace="pre",c.style.wordWrap="normal");this._updateOverflow();b||(this.redraw(),this._resetLineWidth());this._resetLineHeight()},_showCaret:function(a,b,c,d){if(this._clientDiv&&!(0<this._redrawCount)&&!this._ignoreDOMSelection&&-1===this._imeOffset){var h=this._model,e=this._getSelections(),f=v.editing(e,"down"===this._autoScrollDir),g=this._getScroll(),e=f.getCaret(),l=f.start,p=f.end,r=h.getLineAtOffset(l),
k=h.getLineAtOffset(p),n=Math.max(Math.max(l,h.getLineStart(k)),p-1),h=this._getClientWidth(),q=this._getClientHeight(),m=h/4,t=this._getBoundsAtOffset(e===l?l:n),u=t.left,w=t.right,A=t.top,z=t.bottom,B=0,E="object"===typeof c;if((a||E)&&!f.isEmpty())t=this._getBoundsAtOffset(e===p?l:n),B=(t.bottom>z?t.bottom:z)-(t.top<A?t.top:A),a&&(t.top===A?e===l?w=u+Math.min(t.right-u,h):u=w-Math.min(w-t.left,h):e===l?z=A+Math.min(t.bottom-A,q):A=z-Math.min(z-t.top,q));a=0;u<g.x&&(a=Math.min(u-g.x,-m));w>g.x+
h&&(a=Math.max(w-g.x-h,m));f=0;A<g.y?f=A-g.y:z>g.y+q&&(f=z-g.y-q);d&&(0<d?0<f&&(f=Math.max(f,d)):0>f&&(f=Math.min(f,d)));d=E&&"always"===c.scrollPolicy;if(0!==a||0!==f||d)return E?(d=0<f,0===f&&(f=A-g.y),g=c.viewAnchor,A=c.selectionAnchor,c=Math.min(Math.max(0,c.viewAnchorOffset||0)),f="top"===g?f+Math.floor(d?(1-c)*q:-c*q):"bottom"===g?f+Math.floor(d?c*q:-(1-c)*q):"center"===g?f+Math.floor(d?q/2+c*q:q/2-(1-c)*q):f+Math.floor(d?c*q:-c*q),r!==k&&("top"===A&&e!==l?f+=Math.floor(-B):"bottom"===A&&e!==
p?f+=Math.floor(B):"center"===A&&(f+=Math.floor(B/2)))):0!==f&&"number"===typeof c&&(0>c&&(c=0),1<c&&(c=1),f+=Math.floor(0<f?c*q:-c*q)),this._scrollViewAnimated(a,f,b),q!==this._getClientHeight()||h!==this._getClientWidth()?this._showCaret():this._ensureCaretVisible=!0,!0;b&&b();return!1}},_startIME:function(){if(-1===this._imeOffset){for(var a=!1,b=this._getSelections(),c=0;c<b.length&&!a;c++)a=!b[c].isEmpty();a&&this._modifyContent({text:"",selection:b},!0);this._imeOffset=b[0].start}},_unhookEvents:function(){this._model.removeEventListener("preChanging",
this._modelListener.onChanging);this._model.removeEventListener("postChanged",this._modelListener.onChanged);this._theme.removeEventListener("ThemeChanged",this._themeListener.onChanged);this._modelListener=null;for(var a=0;a<this._handlers.length;a++){var b=this._handlers[a];E(b.target,b.type,b.handler)}this._handlers=null;this._mutationObserver&&this._mutationObserver.disconnect()},_updateDOMSelection:function(){if(!(0<this._redrawCount)&&!this._ignoreDOMSelection&&-1===this._imeOffset&&this._clientDiv){var a=
this._getSelections(),b=this._domSelection,c;if(b.length<a.length)for(c=b.length;c<a.length;c++)b.push(new w(this));else b.length>a.length&&b.splice(a.length).forEach(function(a){a.destroy()});for(c=0;c<b.length;c++)b[c].setPrimary(0===c),b[c].setSelection(a[c]);var a=this._getWindow(),d=this;1<b.length?this._cursorTimer||(this._cursorTimer=a.setInterval(function(){d._cursorVisible=!d._cursorVisible;d._domSelection.forEach(function(a){a.update()})},500)):this._cursorTimer&&(a.clearInterval(this._cursorTimer),
this._cursorTimer=null)}},_update:function(a){if(!(0<this._redrawCount)){this._updateTimer&&(this._getWindow().clearTimeout(this._updateTimer),this._updateTimer=null,a=!1);var b=this._clientDiv,c=this._viewDiv;if(b){this._metrics.invalid&&(this._ignoreQueueUpdate=!0,this._updateStyle(),this._ignoreQueueUpdate=!1);var d=this._model,h=this._getScroll(!1),e=this._getViewPadding(),g=d.getLineCount(),l=this._getLineHeight(),p=!1,r=!1,k=!1,n=this._metrics.scrollWidth;this._wrapMode&&(b.style.width=(this._metrics.wrapWidth||
this._getClientWidth())+"px");var q,t,m,u,v=0,w=0,z;if(this._lineHeight){for(;w<g;){z=this._getLineHeight(w);if(v+z>h.y)break;v+=z;w++}q=w;t=Math.max(0,q-1);m=d=h.y-v;0<q&&(d+=this._getLineHeight(q-1))}else u=Math.max(0,h.y)/l,q=Math.floor(u),t=Math.max(0,q-1),d=Math.round((u-t)*l),m=Math.round((u-q)*l);this._topIndexY=m;u=this._rootDiv;var B=u.clientWidth,E=u.clientHeight;if(a){l=0;this._leftDiv&&(q=this._leftDiv.getBoundingClientRect(),l=q.right-q.left);q=this._getClientWidth();u=this._getClientHeight();
r=q;this._wrapMode?this._metrics.wrapWidth&&(r=this._metrics.wrapWidth):r=Math.max(this._maxLineWidth,r);for(;w<g;)z=this._getLineHeight(w,!1),v+=z,w++;g=v}else{u=this._getClientHeight();m=Math.min(q+Math.floor((u+m)/l),g-1);var h=Math.min(m+1,g-1),C;for(z=b.firstChild;z;){C=z.lineIndex;var I=z.nextSibling;if(!(t<=C&&C<=h)||z.lineRemoved||-1===z.lineIndex)this._mouseWheelLine===z?(z.style.display="none",z.lineIndex=-1):b.removeChild(z);z=I}z=this._getLineNext();var I=c.ownerDocument,M=I.createDocumentFragment();
for(C=t;C<=h;C++)!z||z.lineIndex>C?(new A(this,C)).create(M,null):(M.firstChild&&(b.insertBefore(M,z),M=I.createDocumentFragment()),z&&z.lineChanged&&(z=(new A(this,C)).create(M,z),z.lineChanged=!1),z=this._getLineNext(z));M.firstChild&&b.insertBefore(M,z);f.isWebkit&&!this._wrapMode&&(b.style.width="0x7fffffffpx");z=this._getLineNext();C=u+d;for(M=!1;z;)t=z.lineWidth,void 0===t&&(I=z._line.getBoundingClientRect(),t=z.lineWidth=Math.ceil(I.right-I.left),I=I.bottom-I.top,this._lineHeight?this._lineHeight[z.lineIndex]=
I:0!==l&&(0!==I&&Math.ceil(l)!==Math.ceil(I))&&(this._variableLineHeight=!0,this._lineHeight=[],this._lineHeight[z.lineIndex]=I)),this._lineHeight&&!M&&(C-=this._lineHeight[z.lineIndex],0>C&&(m=z.lineIndex,M=!0)),this._wrapMode||(t>=this._maxLineWidth&&(this._maxLineWidth=t,this._maxLineIndex=z.lineIndex),this._checkMaxLineIndex===z.lineIndex&&(this._checkMaxLineIndex=-1)),z.lineIndex===q&&(this._topChild=z),z.lineIndex===m&&(this._bottomChild=z),z=this._getLineNext(z);-1!==this._checkMaxLineIndex&&
(C=this._checkMaxLineIndex,this._checkMaxLineIndex=-1,0<=C&&C<g&&(l=new A(this,C),I=l.getBoundingClientRect(),t=I.right-I.left,t>=this._maxLineWidth&&(this._maxLineWidth=t,this._maxLineIndex=C),l.destroy()));for(;w<g;)z=this._getLineHeight(w,w<=m),v+=z,w++;g=v;this._updateRuler(this._leftDiv,q,h,E);this._updateRuler(this._rightDiv,q,h,E);this._updateRuler(this._innerRightDiv,q,h,E);this._updateRuler(this._marginDiv,q,h,E);l=0;this._leftDiv&&(q=this._leftDiv.getBoundingClientRect(),l=q.right-q.left);
v=0;this._rightDiv&&(h=this._rightDiv.getBoundingClientRect(),v=h.right-h.left);c.style.left=l+"px";c.style.right=v+"px";h=this._scrollDiv;h.style.height=g+(f.isWebkit?0:e.bottom)+"px";q=this._getClientWidth();!this._singleMode&&(!this._wrapMode&&!this._noScroll)&&(w=p=u,(m="scroll"===c.style.overflowX)?p+=n:w-=n,t=z=q,(C="scroll"===c.style.overflowY)?z+=n:t-=n,u=p,q=z,g>u&&(k=!0,q=t),this._maxLineWidth>q&&(r=!0,u=w,g>u&&(k=!0,q=t)),m!==r&&(c.style.overflowX=r?"scroll":"hidden"),C!==k&&(c.style.overflowY=
k?"scroll":"hidden"),p=m!==r||C!==k);k=q;this._wrapMode?this._metrics.wrapWidth&&(k=this._metrics.wrapWidth):k=Math.max(this._maxLineWidth+this._getInnerRightWidth(),k);r=k;if((!f.isIE||9<=f.isIE)&&this._maxLineWidth>q)k+=e.right+e.left;h.style.width=k+"px";this._clipScrollDiv&&(this._clipScrollDiv.style.width=k+"px");h=this._getScroll(!1);if(k=this._innerRightDiv)k.style.right=v+("scroll"===c.style.overflowY?this._metrics.scrollWidth:0)+"px",k.style.bottom=("scroll"===c.style.overflowX?n:0)+"px"}this._scrollHeight=
g;this._vScrollDiv&&(k=u-8,v=Math.max(15,Math.ceil(Math.min(1,k/(g+e.top+e.bottom))*k)),this._vScrollDiv.style.left=l+q-8+"px",this._vScrollDiv.style.top=Math.floor(Math.max(0,h.y*k/g))+"px",this._vScrollDiv.style.height=v+"px");!this._wrapMode&&this._hScrollDiv&&(k=q-8,v=Math.max(15,Math.ceil(Math.min(1,k/(this._maxLineWidth+e.left+e.right))*k)),this._hScrollDiv.style.left=l+Math.floor(Math.max(0,Math.floor(h.x*k/this._maxLineWidth)))+"px",this._hScrollDiv.style.top=u-9+"px",this._hScrollDiv.style.width=
v+"px");w=h.x;v=this._clipDiv;k=this._overlayDiv;if(m=this._marginDiv)m.style.left=-w+l+this._metrics.marginWidth+e.left+"px",m.style.bottom=("scroll"===c.style.overflowX?n:0)+"px";v?(v.scrollLeft=w,v.scrollTop=0,c=l+e.left,n=e.top,a=q,l=u,w=0,m=-d,0===h.x&&(c-=e.left,a+=e.left,w=e.left),h.x+q===r&&(a+=e.right),0===h.y&&(n-=e.top,l+=e.top,m+=e.top),h.y+u===g&&(l+=e.bottom),v.style.left=c+"px",v.style.top=n+"px",v.style.right=B-a-c+"px",v.style.bottom=E-l-n+"px",b.style.left=w+"px",b.style.top=m+"px",
b.style.width=r+"px",b.style.height=u+d+"px",k&&(k.style.left=b.style.left,k.style.top=b.style.top,k.style.width=b.style.width,k.style.height=b.style.height)):(c=w,n=d,B=w+q,E=d+u,0===c&&(c-=e.left),0===n&&(n-=e.top),B===r&&(B+=e.right),h.y+u===g&&(E+=e.bottom),b.style.clip="rect("+n+"px,"+B+"px,"+E+"px,"+c+"px)",b.style.left=-w+l+e.left+"px",b.style.width=(this._wrapMode||f.isWebkit?r:q+w)+"px",a||(b.style.top=-d+e.top+"px",b.style.height=u+d+"px"),k&&(k.style.clip=b.style.clip,k.style.left=b.style.left,
k.style.width=b.style.width,a||(k.style.top=b.style.top,k.style.height=b.style.height)));this._updateDOMSelection();p&&(b=this._ensureCaretVisible,this._ensureCaretVisible=!1,b&&this._showCaret(),this._queueUpdate())}}},_updateOverflow:function(){var a=this._viewDiv;this._noScroll?a.style.overflow="hidden":this._wrapMode?(a.style.overflowX="hidden",a.style.overflowY="scroll"):a.style.overflow="hidden"},_updateRuler:function(a,b,c,d){if(a)for(var h=this._parent.ownerDocument,e=this._getLineHeight(),
g=this._getViewPadding(),p=a.firstChild;p;){var r=p._ruler,k=r.getOverview();p.rulerChanged&&(l(r.getRulerStyle(),p),a.rulerWidth=void 0);if("fixed"!==k){var n=e;"page"===k&&(n+=this._topIndexY);p.style.top=-n+"px";p.style.height=d+n+"px";var q,m=p.firstChild;m?(q=m,m=m.nextSibling):(q=f.createElement(h,"div"),q.style.visibility="hidden",p.appendChild(q));var t;if(p.rulerChanged&&q){n=-1;if(t=r.getWidestAnnotation())l(t.style,q),t.html&&(q.innerHTML=t.html);q.lineIndex=n;q.style.height=e+g.top+"px"}var u,
v;if("page"===k){for(r=r.getAnnotations(b,c+1);m;)n=m.lineIndex,t=m.nextSibling,(!(b<=n&&n<=c)||m.lineChanged)&&p.removeChild(m),m=t;m=p.firstChild.nextSibling;v=h.createDocumentFragment();for(n=b;n<=c;n++)if(!m||m.lineIndex>n){u=f.createElement(h,"div");if(t=r[n])l(t.style,u),t.html&&(u.innerHTML=t.html),u.annotation=t;u.lineIndex=n;u.style.height=this._getLineHeight(n)+"px";v.appendChild(u)}else v.firstChild&&(p.insertBefore(v,m),v=h.createDocumentFragment()),m&&(m=m.nextSibling);v.firstChild&&
p.insertBefore(v,m)}else{t=this._getClientHeight();n=this._model.getLineCount();m=t+g.top+g.bottom-2*this._metrics.scrollWidth;e*n<m?(k=e,q=g.top):(k=m/n,q=this._metrics.scrollWidth);if(p.rulerChanged){for(t=p.childNodes.length;1<t;)p.removeChild(p.lastChild),t--;r=r.getAnnotations(0,n);v=h.createDocumentFragment();for(var w in r)n=w>>>0,0>n||(u=f.createElement(h,"div"),t=r[w],l(t.style,u),u.style.position="absolute",u.style.top=q+e+Math.floor(n*k)+"px",t.html&&(u.innerHTML=t.html),u.annotation=t,
u.lineIndex=n,v.appendChild(u));p.appendChild(v)}else if(p._oldTrackHeight!==m)for(u=p.firstChild?p.firstChild.nextSibling:null;u;)u.style.top=this._metrics.scrollWidth+e+Math.floor(u.lineIndex*k)+"px",u=u.nextSibling;p._oldTrackHeight=m}}p.rulerChanged=!1;p=p.nextSibling}},_updateStyleSheet:function(){var a="";f.isWebkit&&0<this._metrics.scrollWidth&&(a+="\n.textview ::-webkit-scrollbar-corner {background: #eeeeee;}");if(a){var b=this._clientDiv.ownerDocument,c=b.getElementById("_textviewStyle");
if(c)c.removeChild(c.firstChild),c.appendChild(b.createTextNode(a));else{c=f.createElement(b,"style");c.id="_textviewStyle";var d=b.getElementsByTagName("head")[0]||b.documentElement;c.appendChild(b.createTextNode(a));d.insertBefore(c,d.firstChild)}}},_updateStyle:function(a,b){!a&&f.isIE&&(this._rootDiv.style.lineHeight="normal");b=this._metrics=b||this._calculateMetrics();this._variableLineHeight&&(this._variableLineHeight=!1,this._resetLineHeight());this._rootDiv.style.lineHeight=f.isIE?b.lineHeight-
(b.lineTrim.top+b.lineTrim.bottom)+"px":"normal";this._updateStyleSheet();if(f.isMac&&f.isWebkit){var c=this._viewDiv;!b.invalid&&0===b.scrollWidth?(c.style.pointerEvents="none",c.style.zIndex="2"):(c.style.pointerEvents="",c.style.zIndex="")}a||(this.redraw(),this._resetLineWidth())}};c.EventTarget.addMixin(z.prototype);return{TextView:z}});
define("orion/editor/projectionTextModel",["orion/editor/textModel","orion/editor/eventTarget"],function(k,m){function e(c){this._model=c;this._projections=[];var e=this;this._listener={onChanged:function(c){e._onChanged(c)},onChanging:function(c){e._onChanging(c)}};c.addEventListener("postChanged",this._listener.onChanged);c.addEventListener("preChanging",this._listener.onChanging)}e.prototype={destroy:function(){this._model&&(this._model.removeEventListener("postChanged",this._listener.onChanged),
this._model.removeEventListener("preChanging",this._listener.onChanging),this._model=null)},addProjection:function(c){if(c){var e=this._model,d=this._projections;c._lineIndex=e.getLineAtOffset(c.start);c._lineCount=e.getLineAtOffset(c.end)-c._lineIndex;var f=c.text;f||(f="");c._model="string"===typeof f?new k.TextModel(f,e.getLineDelimiter()):f;var e=this.mapOffset(c.start,!0),f=c.end-c.start,n=c._lineCount,l=c._model.getCharCount(),b=c._model.getLineCount()-1,a={type:"Changing",text:c._model.getText(),
start:e,removedCharCount:f,addedCharCount:l,removedLineCount:n,addedLineCount:b};this.onChanging(a);a=this._binarySearch(d,c.start);d.splice(a,0,c);this.onChanged({type:"Changed",start:e,removedCharCount:f,addedCharCount:l,removedLineCount:n,addedLineCount:b})}},getProjections:function(){return this._projections.slice(0)},getBaseModel:function(){return this._model},mapOffset:function(c,e){var d=this._projections,f=0,k,l;if(e){for(k=0;k<d.length;k++){l=d[k];if(l.start>c)break;if(l.end>c)return-1;f+=
l._model.getCharCount()-(l.end-l.start)}return c+f}for(k=0;k<d.length;k++){l=d[k];if(l.start>c-f)break;var b=l._model.getCharCount();if(l.start+b>c-f)return-1;f+=b-(l.end-l.start)}return c-f},removeProjection:function(c){this._removeProjection(c)},_removeProjection:function(c,e){var d,f=0;for(d=0;d<this._projections.length;d++){var k=this._projections[d];if(k===c){c=k;break}f+=k._model.getCharCount()-(k.end-k.start)}if(d<this._projections.length){var k=this._model,f=c.start+f,l=c.end-c.start,b=c._lineCount,
a=c._model.getCharCount(),q=c._model.getLineCount()-1;e||(k={type:"Changing",text:k.getText(c.start,c.end),start:f,removedCharCount:a,addedCharCount:l,removedLineCount:q,addedLineCount:b},this.onChanging(k));this._projections.splice(d,1);if(!e)this.onChanged({type:"Changed",start:f,removedCharCount:a,addedCharCount:l,removedLineCount:q,addedLineCount:b})}},_binarySearch:function(c,e){for(var d=c.length,f=-1,k;1<d-f;)k=Math.floor((d+f)/2),e<=c[k].start?d=k:f=k;return d},getCharCount:function(){for(var c=
this._model.getCharCount(),e=this._projections,d=0;d<e.length;d++)var f=e[d],c=c+(f._model.getCharCount()-(f.end-f.start));return c},getLine:function(c,e){if(0>c)return null;var d=this._model,f=this._projections,k=0,l=[],b=0,a,q,h;for(a=0;a<f.length;a++){h=f[a];if(h._lineIndex>=c-k)break;q=h._model.getLineCount()-1;if(h._lineIndex+q>=c-k){b=c-(h._lineIndex+k);if(b<q)return h._model.getLine(b,e);l.push(h._model.getLine(q))}b=h.end;k+=q-h._lineCount}for(b=Math.max(b,d.getLineStart(c-k));a<f.length;a++){h=
f[a];if(h._lineIndex>c-k)break;l.push(d.getText(b,h.start));q=h._model.getLineCount()-1;if(h._lineIndex+q>c-k)return l.push(h._model.getLine(0,e)),l.join("");l.push(h._model.getText());b=h.end;k+=q-h._lineCount}f=d.getLineEnd(c-k,e);b<f&&l.push(d.getText(b,f));return l.join("")},getLineAtOffset:function(c){for(var e=this._model,d=this._projections,f=0,k=0,l=0;l<d.length;l++){var b=d[l];if(b.start>c-f)break;var a=b._model.getCharCount();if(b.start+a>c-f){d=c-(b.start+f);k+=b._model.getLineAtOffset(d);
f+=d;break}k+=b._model.getLineCount()-1-b._lineCount;f+=a-(b.end-b.start)}return e.getLineAtOffset(c-f)+k},getLineCount:function(){for(var c=this._projections,e=this._model.getLineCount(),d=0;d<c.length;d++)var f=c[d],e=e+(f._model.getLineCount()-1-f._lineCount);return e},getLineDelimiter:function(){return this._model.getLineDelimiter()},getLineEnd:function(c,e){if(0>c)return-1;for(var d=this._model,f=this._projections,k=0,l=0,b=0;b<f.length;b++){var a=f[b];if(a._lineIndex>c-k)break;var q=a._model.getLineCount()-
1;if(a._lineIndex+q>c-k)return a._model.getLineEnd(c-(a._lineIndex+k),e)+a.start+l;l+=a._model.getCharCount()-(a.end-a.start);k+=q-a._lineCount}return d.getLineEnd(c-k,e)+l},getLineStart:function(c){if(0>c)return-1;for(var e=this._model,d=this._projections,f=0,k=0,l=0;l<d.length;l++){var b=d[l];if(b._lineIndex>=c-f)break;var a=b._model.getLineCount()-1;if(b._lineIndex+a>=c-f)return b._model.getLineStart(c-(b._lineIndex+f))+b.start+k;k+=b._model.getCharCount()-(b.end-b.start);f+=a-b._lineCount}return e.getLineStart(c-
f)+k},getText:function(c,e){void 0===c&&(c=0);var d=this._model,f=this._projections,k=0,l=[],b,a,q;for(b=0;b<f.length;b++){a=f[b];if(a.start>c-k)break;q=a._model.getCharCount();if(a.start+q>c-k){if(void 0!==e&&a.start+q>e-k)return a._model.getText(c-(a.start+k),e-(a.start+k));l.push(a._model.getText(c-(a.start+k)));c=a.end+k+q-(a.end-a.start)}k+=q-(a.end-a.start)}var h=c-k;if(void 0!==e){for(;b<f.length;b++){a=f[b];if(a.start>e-k)break;l.push(d.getText(h,a.start));q=a._model.getCharCount();if(a.start+
q>e-k)return l.push(a._model.getText(0,e-(a.start+k))),l.join("");l.push(a._model.getText());h=a.end;k+=q-(a.end-a.start)}l.push(d.getText(h,e-k))}else{for(;b<f.length;b++)a=f[b],l.push(d.getText(h,a.start)),l.push(a._model.getText()),h=a.end;l.push(d.getText(h))}return l.join("")},_onChanged:function(c){c=this._change;var e=c.baseStart,d=c.baseEnd,f,k,l=this._projections;for(f=0;f<l.length&&!(k=l[f],k.end>e);f++);var b=f;for(f=0;f<l.length&&!(k=l[f],k.start>=d);f++);var a=f,q=this._model,e=c.baseText.length-
(d-e);for(f=a;f<l.length;f++)k=l[f],k.start+=e,k.end+=e,k._lineIndex=q.getLineAtOffset(k.start);k=l.splice(b,a-b);for(f=0;f<k.length;f++)k[f].annotation&&k[f].annotation._expand();this.onChanged({type:"Changed",start:c.start,removedCharCount:c.removedCharCount,addedCharCount:c.addedCharCount,removedLineCount:c.removedLineCount,addedLineCount:c.addedLineCount});this._change=void 0},_onChanging:function(c){var e=!!this._change,d=this._change||{},f=c.start,k=f+c.removedCharCount;d.baseStart=f;d.baseEnd=
k;d.baseText=c.text;d.addedLineCount=c.addedLineCount;if(!e){this._change=d;d.text=c.text;var l=this._projections,b,a,q;c=function(c){for(b=a=0;a<l.length;a++){q=l[a];if(q.start>c)break;if(q.end>c)return-1;b+=q._model.getCharCount()-(q.end-q.start)}return c+b};d.start=c(f);-1===d.start&&(d.text=this._model.getText(q.start,f)+d.text,d.addedLineCount+=this._model.getLineAtOffset(f)-this._model.getLineAtOffset(q.start),d.start=q.start+b);d.end=c(k);-1===d.end&&(d.text+=this._model.getText(k,q.end),d.addedLineCount+=
this._model.getLineAtOffset(q.end)-this._model.getLineAtOffset(k),d.end=q.start+b)}d.addedCharCount=d.text.length;d.removedCharCount=d.end-d.start;d.removedLineCount=this.getLineAtOffset(d.end)-this.getLineAtOffset(d.start);this.onChanging({type:"Changing",text:d.text,start:d.start,removedCharCount:d.removedCharCount,addedCharCount:d.addedCharCount,removedLineCount:d.removedLineCount,addedLineCount:d.addedLineCount})},onChanging:function(c){return this.dispatchEvent(c)},onChanged:function(c){return this.dispatchEvent(c)},
setLineDelimiter:function(c){this._model.setLineDelimiter(c)},setText:function(c,e,d){function f(c){for(l=b=0;b<k.length;b++){a=k[b];if(a.start>c-l)break;var d=a._model.getCharCount();if(a.start+d>c-l)return-1;l+=d-(a.end-a.start)}return c-l}this._change={text:c||"",start:e||0,end:void 0===d?this.getCharCount():d};var k=this._projections,l,b,a,q,h;c=f(this._change.start);-1===c&&(q={projection:a,start:this._change.start-(a.start+l)},c=a.end);e=f(this._change.end);-1===e&&(h={projection:a,end:this._change.end-
(a.start+l)},e=a.start);q&&h&&q.projection===h.projection?a._model.setText(this._change.text,q.start,h.end):(this._model.setText(this._change.text,c,e),q&&(a=q.projection,a._model.setText("",q.start)),h&&(a=h.projection,a._model.setText("",0,h.end),a.start=a.end,a._lineCount=0));this._change=void 0}};m.EventTarget.addMixin(e.prototype);return{ProjectionTextModel:e}});
define("orion/editor/tooltip","i18n!orion/editor/nls/messages orion/editor/textView orion/editor/projectionTextModel orion/Deferred orion/editor/util orion/webui/littlelib orion/util".split(" "),function(k,m,e,c,g,d,f){function n(c){this._view=c;c=c.getOptions("parent");this._create(c?c.ownerDocument:document)}n.getTooltip=function(c){c._tooltip||(c._tooltip=new n(c));return c._tooltip};n.prototype={_create:function(c){if(!this._tooltipDiv){var b=this._tooltipDiv=f.createElement(c,"div");b.tabIndex=
0;b.className="textviewTooltip";b.setAttribute("aria-live","assertive");b.setAttribute("aria-atomic","true");this._tooltipDiv.style.visibility="hidden";c.body.appendChild(b);var a=this;g.addEventListener(c,"mousedown",this._mouseDownHandler=function(c){a.isVisible()&&(g.contains(b,c.target||c.srcElement)||a._locked||a.hide())},!0);g.addEventListener(c,"mousemove",this._mouseMoveHandler=function(b){a.isVisible()&&(!a._locked&&!a._hasFocus())&&(a._isInRect(a._outerArea,b.clientX,b.clientY)||a.hide())},
!0);g.addEventListener(b,"focus",function(b){a._locked||a._tooltipDiv.classList.add("textViewTooltipOnFocus")},!1);g.addEventListener(b,"blur",function(b){a._tooltipDiv.classList.remove("textViewTooltipOnFocus")},!1);g.addEventListener(b,"mouseenter",function(b){a._locked||a._tooltipDiv.classList.add("textViewTooltipOnHover")},!1);g.addEventListener(b,"mouseleave",function(b){a._hasFocus()||a._tooltipDiv.classList.remove("textViewTooltipOnHover")},!1);g.addEventListener(b,"keydown",function(b){27===
b.keyCode&&(a._locked||a.hide())},!1);this._view.addEventListener("Destroy",function(){a.destroy()})}},destroy:function(){if(this._tooltipDiv){this.hide();var c=this._tooltipDiv.parentNode;c&&c.removeChild(this._tooltipDiv);c=this._tooltipDiv.ownerDocument;g.removeEventListener(c,"mousedown",this._mouseDownHandler,!0);g.removeEventListener(c,"mousemove",this._mouseMoveHandler,!0);this._tooltipDiv=null}},show:function(c,b,a){this._locked=b;this._giveFocus=a;this._processInfo(c.getTooltipInfo())},update:function(c){c&&
this._processInfo(c.getTooltipInfo(),!0)},onHover:function(c,b,a){c&&!this._isInRect(this._anchorArea,b,a)&&(!this._isInRect(this._tooltipArea,b,a)&&!this._locked&&!this._hasFocus())&&this._processInfo(c.getTooltipInfo())},hide:function(){this.isVisible()&&(this.hover&&this.hover.clearQuickFixes(),this._hasFocus()&&this._view.focus(),this._contentsView&&(this._contentsView.destroy(),this._contentsView=null),this._tooltipContents&&(this._tooltipDiv.removeChild(this._tooltipContents),this._tooltipContents=
null),this._tooltipDiv.classList.remove("textviewTooltipCodeProjection"),this._tooltipDiv.classList.remove("textviewTooltipOnHover"),this._tooltipDiv.classList.remove("textviewTooltipOnFocus"),this._tooltipDiv.style.visibility="hidden",this._tooltipDiv.style.left="",this._tooltipDiv.style.right="",this._tooltipDiv.style.top="",this._tooltipDiv.style.bottom="",this._tooltipDiv.style.width="auto",this._tooltipDiv.style.maxWidth="",this._tooltipDiv.style.height="auto",this._tooltipDiv.style.maxHeight=
"",this._tooltipDiv.style.overflowX="",this._tooltipDiv.style.overflowY="",this._outerArea=this._tooltipArea=this._anchorArea=this._locked=this._giveFocus=void 0,this._hoverPromises&&this._hoverPromises.forEach(function(c){c.resolved||c.cancel()}),this._tipRect=this._hoverPromises=void 0)},isVisible:function(){return this._tooltipDiv&&"visible"===this._tooltipDiv.style.visibility},_processInfo:function(d,b){if(this._tooltipDiv){var a;b&&this._tooltipContents?(this._tooltipContents.innerHTML="",a=
this._tooltipContents):a=f.createElement(this._tooltipDiv.ownerDocument,"div");if(d){if(d.contents&&this._renderImmediateInfo(a,d.contents,d.context))return this._showContents(a,d,b),!0;if(this.hover&&d.context&&(this._hoverPromises=this.hover.computeHoverInfo(d.context))){var e=this;this._hoverPromises.slice(0).forEach(function(h){c.when(h,function(c){if(e._hoverPromises){var f=e._hoverPromises.indexOf(h);0<=f&&e._hoverPromises.splice(f,1)}c&&e._renderPluginContent(a,c)&&(c.offsetStart&&(d.context.offsetStart=
c.offsetStart),c.offsetEnd&&(d.context.offsetEnd=c.offsetEnd),c.allowFullWidth&&(d.allowFullWidth=c.allowFullWidth),e._showContents(a,d,b))},function(a){console&&(a&&"Cancel"!==a.name)&&(console.log("Error computing hover tooltip"),console.log(a&&a.stack))})});return!0}}}},_showContents:function(c,b,a){if(a){if(this._tooltipArea&&b.tooltipArea&&(this._tooltipArea.left!==b.tooltipArea.left||this._tooltipArea.top!==b.tooltipArea.top||this._tooltipArea.width!==b.tooltipArea.width||this._tooltipArea.height!==
b.tooltipArea.height))this._outerArea=this._tooltipArea=this._anchorArea=null}else this.hide();this._tooltipContents=c;this._tooltipDiv.appendChild(c);this._anchorArea||(this._anchorArea=this._computeAnchorArea(b));this._tooltipArea||(this._tooltipArea=this._computeTooltipArea(b,this._anchorArea,this._tooltipDiv));this._outerArea||(this._outerArea=this._computeOuterArea(this._anchorArea,this._tooltipArea));this._tooltipDiv.style.visibility="visible";this._giveFocus&&(this._setInitialFocus(this._tooltipDiv),
this._giveFocus=void 0)},_computeAnchorArea:function(c){if(c.anchorArea&&c.anchorArea.top&&c.anchorArea.left&&c.anchorArea.height&&c.anchorArea.width)return c.anchorArea;if(c.context){if(c.context.offsetStart&&c.context.offsetEnd)return this._computeRectangleFromOffset(c.context.offsetStart,c.context.offsetEnd);if(0<=c.context.offset){var b=this._view.getNextOffset(c.context.offset,{unit:"word",count:-1});c=this._view.getNextOffset(c.context.offset,{unit:"word",count:0});return this._computeRectangleFromOffset(b,
c)}}return{top:0,left:0,height:0,width:0}},_computeTooltipArea:function(c,b,a){var d=a.ownerDocument.documentElement;if(c.tooltipArea&&c.tooltipArea.top&&c.tooltipArea.left&&c.tooltipArea.height&&c.tooltipArea.width)return a.style.overflowY="auto",a.style.resize="none",a.style.top=c.tooltipArea.top+"px",a.style.left=c.tooltipArea.left+"px",a.style.height=c.tooltipArea.height-16+"px",a.style.width=c.tooltipArea.width-16+"px",c.tooltipArea;var h=a.getBoundingClientRect(),h={width:h.width,height:h.height},
e=c.position?c.position:"below",f=(this._view._rootDiv?this._view._rootDiv:d).getBoundingClientRect(),d=f.left,g=f.top,k=f.width,f=f.height,n=k;if(!c.allowFullWidth){var n=Math.min(k/2,600),m=Math.min(f/2,400);h.width=Math.min(h.width,n);h.height=Math.min(h.height,m)}41>h.height&&h.width>n-16&&(h.height=56);var n=f-(b.top+b.height-g),A=b.top-g,m=k-(b.left+b.width-d);"above"===e&&h.height>A&&h.height<=n?e="below":"below"===e&&(h.height>n&&h.height<=A)&&(e="above");A=c.tooltipOffsetX?c.tooltipOffsetX:
0;c=c.tooltipOffsetY?c.tooltipOffsetY:0;switch(e){case "left":h.top=h.height+c>n+b.height?f+g-h.height:b.top+c;h.top=Math.max(h.top,g);h.left=Math.max(b.left-h.width+A,d);break;case "right":h.top=h.height+c>n+b.height?f+g-h.height:b.top+c;h.top=Math.max(h.top,g);h.left=Math.max(b.left+b.width+A,d);break;case "above":h.left=h.width+A>m+b.width?k+d-h.width:b.left+A;h.left=Math.max(h.left,d);h.top=Math.max(b.top-h.height+c,g);break;case "below":h.left=h.width+A>m+b.width?k+d-h.width:b.left+A,h.left=
Math.max(h.left,d),h.top=Math.max(b.top+b.height+c,g)}h.maxWidth=Math.min(k+d-h.left,k);h.maxHeight=Math.min(f+g-h.top,f);a.style.maxWidth=h.maxWidth-16+"px";a.style.maxHeight=h.maxHeight-16+"px";a.style.width=h.width-16+"px";a.style.height=h.height-16+"px";a.style.left=h.left+"px";a.style.top=h.top+"px";return h},_computeOuterArea:function(c,b){var a=Math.min(c.left,b.left),d=Math.min(c.top,b.top),h=Math.max(c.left+c.width,b.left+b.width),e=Math.max(c.top+c.height,b.top+b.height);return{left:a,top:d,
width:h-a,height:e-d}},_hasFocus:function(){var c=this._tooltipDiv;return!c?!1:g.contains(c,c.ownerDocument.activeElement)},_isNode:function(c){return"object"===typeof Node?c instanceof Node:c&&"object"===typeof c&&"number"===typeof c.nodeType&&"string"===typeof c.nodeName},_setInitialFocus:function(c){var b=d.$("button",c);if(b)b.focus();else if(b=d.$("a",c)){b.focus();var a=this;b.addEventListener("click",function(){a.hide()})}else(c=d.firstTabbable(c))&&c.focus()},_isInRect:function(c,b,a){if(!c)return!1;
a=a>=c.top&&a<=c.top+c.height;return b>=c.left&&b<=c.left+c.width&&a},mapOffset:function(c,b){var a=this._view.getModel();a.getBaseModel&&(c=a.mapOffset(c,b));return c},_computeRectangleFromOffset:function(c,b){c=this.mapOffset(c);b=this.mapOffset(b);var a=this._view,d=a.getLineAtOffset(c),h=a.getLineAtOffset(b);d!==h&&(b=a.getModel().getLineEnd(d));d=a.getLineHeight(d);h=a.getLocationAtOffset(c);a=a.getLocationAtOffset(b);a={x:h.x,y:h.y,width:a.x-h.x,height:d};a=this._view.convert(a,"document","page");
return{left:a.x,top:a.y,width:a.width,height:a.height}},_renderPluginContent:function(c,b){var a=this._tooltipDiv.ownerDocument;if("string"!==typeof b&&"undefined"===typeof b.content)return!1;var d=f.createElement(a,"div");if(b.title){var h=f.createElement(a,"div");h.innerHTML=this.hover.renderMarkDown?this.hover.renderMarkDown(b.title):b.title;d.appendChild(h)}h=f.createElement(a,"div");if("string"===typeof b)h.appendChild(a.createTextNode(b));else switch(b.type){case "delegatedUI":case "html":b.content&&
(a=a.createElement("iframe"),a.id="HtmlHover",a.name="HTML Hover",a.type="text/html",a.sandbox="allow-scripts allow-same-origin allow-forms",a.style.border="none",a.style.width="100%",a.style.height="100%",this._tooltipDiv.style.paddingBottom="5px",a.srcdoc=b.content,b.width&&(a.style.width=b.width),b.height&&(a.style.height=b.height),d.style.height="100%",c.style.height="100%",d.appendChild(a));break;case "markdown":this.hover.renderMarkDown&&(h.innerHTML=this.hover.renderMarkDown(b.content));break;
default:h.appendChild(a.createTextNode(b.content))}d.appendChild(h);c.appendChild(d);return!0},_renderImmediateInfo:function(c,b,a){if(b instanceof Array&&(b=this._getAnnotationContents(b,a),!b))return!1;if("string"===typeof b)return c.innerHTML=b,!0;if(this._isNode(b))return c.appendChild(b),!0;if(b instanceof e.ProjectionTextModel){var d=this._view;a=d.getOptions();a.wrapMode=!1;a.parent=c;var h=a.themeClass;h?((h=h.replace("tooltipTheme",""))&&(h=" "+h),h="tooltipTheme"+h):h="tooltipTheme";a.themeClass=
h;a=this._contentsView=new m.TextView(a);a.addEventListener("LineStyle",function(a){d.onLineStyle(a)});a.setModel(b);this._tooltipDiv.appendChild(c);this._tooltipDiv.classList.add("textviewTooltipCodeProjection");b=a.computeSize();c.style.width=b.width+8+"px";c.style.height=b.height+8+"px";a.resize();this._tooltipDiv.removeChild(c);return!0}return!1},_getAnnotationContents:function(c,b){function a(a,c){var h=a.title,e=f.createElement(m,"div");e.className="tooltipRow";if(a.html){var l=f.createElement(m,
"div");l.className="tooltipImage";l.innerHTML=a.html;l.lastChild&&g.addEventListener(l.lastChild,"click",function(){var b=a.start,c=a.end;t.getBaseModel&&(b=t.mapOffset(b,!0),c=t.mapOffset(c,!0));w.setSelection(b,c,1/3,function(){d.hide()})},!1);e.appendChild(l)}h||(h=A.getLineStart(A.getLineAtOffset(a.start)),l=A.getLineEnd(A.getLineAtOffset(a.end),!0),h=A.getText(h,l));"function"===typeof h&&(h=a.title());"string"===typeof h&&(l=f.createElement(m,"span"),l.className="tooltipTitle",l.appendChild(m.createTextNode(h)),
h=l);e.appendChild(h);c&&d.hover.renderQuickFixes(a,e);b&&(b.offsetStart=a.start,b.offsetEnd=a.end);return e}var d=this,h=d.hover?!0:!1;h&&(b&&b.source&&0<=b.source.indexOf("ruler"))&&(h=!1);for(var p,r=[],n=0;n<c.length;n++)p=c[n],""!==p.title&&!p.groupAnnotation&&(!h||p.title)&&r.push(p);c=r;if(0===c.length)return null;var m=this._tooltipDiv.ownerDocument,w=this._view,t=w.getModel(),A=t.getBaseModel?t.getBaseModel():t;if(1===c.length&&"orion.annotation.folding"===c[0].type)return h=new e.ProjectionTextModel(A),
p=A.getLineStart(A.getLineAtOffset(c[0].start)),r=A.getCharCount(),c[0].end!==r&&h.addProjection({start:c[0].end,end:r}),0<p&&h.addProjection({start:0,end:p}),h;if(1===c.length){if((p=a(c[0],h))&&p.firstChild)(h=p.firstChild.className)&&(h+=" "),p.firstChild.className=h+"single";return p}r=f.createElement(m,"div");p=f.createElement(m,"em");p.appendChild(m.createTextNode(k.multipleAnnotations));r.appendChild(p);for(n=0;n<c.length;n++)(p=a(c[n],h))&&r.appendChild(p);return r}};return{Tooltip:n}});
define("orion/objects",[],function(){function k(k){for(var e=Object.prototype.hasOwnProperty,c=1,g=arguments.length;c<g;c++){var d=arguments[c],f;for(f in d)e.call(d,f)&&(k[f]=d[f])}return k}return{clone:function(m){if(Array.isArray(m))return Array.prototype.slice.call(m);var e=Object.create(Object.getPrototypeOf(m));k(e,m);return e},mixin:k,toArray:function(k){return Array.isArray(k)?k:[k]}}});
define("orion/editor/editor","i18n!orion/editor/nls/messages orion/editor/eventTarget orion/editor/tooltip orion/editor/annotations orion/objects orion/util".split(" "),function(k,m,e,c,g,d){function f(b){b=b||{};this._domNode=b.domNode;this._model=b.model;this._undoStack=b.undoStack;this._statusReporter=b.statusReporter;this._title=null;var a=this;this._listener={onChanged:function(b){a.onChanged(b)}};this._model&&this._model.addEventListener("Changed",this._listener.onChanged);this.checkDirty()}
function n(b){b=b||{};f.call(this,b);this._textViewFactory=b.textViewFactory;this._undoStackFactory=b.undoStackFactory;this._textDNDFactory=b.textDNDFactory;this._annotationFactory=b.annotationFactory;this._zoomRulerFactory=b.zoomRulerFactory;this._foldingRulerFactory=b.foldingRulerFactory;this._lineNumberRulerFactory=b.lineNumberRulerFactory;this._contentAssistFactory=b.contentAssistFactory;this._keyBindingFactory=b.keyBindingFactory;this._hoverFactory=b.hoverFactory;this._contentAssist=this._foldingRuler=
this._zoomRuler=this._overviewRuler=this._lineNumberRuler=this._annotationRuler=this._annotationModel=this._annotationStyler=null}var l=c.AnnotationType;f.prototype={destroy:function(){this.uninstall();this._statusReporter=this._domNode=null;this._model&&this._model.removeEventListener("Changed",this._listener.onChanged)},checkDirty:function(){this.setDirty(this._undoStack&&!this._undoStack.isClean())},focus:function(){},getModel:function(){return this._model},getText:function(b,a){return this.getModel().getText(b,
a)},getTitle:function(){return this._title},getUndoStack:function(){return this._undoStack},install:function(){this.installed=!0},isDirty:function(){return this._undoStack?!this._undoStack.isClean():this._dirty},markClean:function(){this.getUndoStack().markClean();this.setDirty(!1)},onDirtyChanged:function(b){return this.dispatchEvent(b)},onInputChanged:function(b){return this.dispatchEvent(b)},onChanged:function(b){this.checkDirty()},reportStatus:function(b,a,c){this._statusReporter&&this._statusReporter(b,
a,c)},resize:function(){},setDirty:function(b){this._dirty!==b&&(this._dirty=b,this.onDirtyChanged({type:"DirtyChanged"}))},_setModelText:function(b){this._model&&this._model.setText(b)},setInput:function(b,a,c,d){this._title=b;d||(a?this.reportStatus(a,"error"):null!==c&&void 0!==c&&("string"===typeof c&&this._setModelText(c),this._undoStack&&this._undoStack.reset()));this.checkDirty();this.onInputChanged({type:"InputChanged",title:b,message:a,contents:c,contentsSaved:d})},setText:function(b,a,c){this.getModel().setText(b,
a,c)},uninstall:function(){this.installed=!1}};m.EventTarget.addMixin(f.prototype);n.prototype=new f;g.mixin(n.prototype,{destroy:function(){f.prototype.destroy.call(this);this._textViewFactory=this._undoStackFactory=this._textDNDFactory=this._annotationFactory=this._foldingRulerFactory=this._lineNumberRulerFactory=this._contentAssistFactory=this._keyBindingFactory=this._hoverFactory=this._zoomRulerFactory=null},getAnnotationModel:function(){return this._annotationModel},getAnnotationRuler:function(){return this._annotationRuler},
getAnnotationStyler:function(){return this._annotationStyler},getContentAssist:function(){return this._contentAssist},getFoldingRuler:function(){return this._foldingRuler},getLineNumberRuler:function(){return this._lineNumberRuler},getTooltip:function(){return e.Tooltip.getTooltip(this._textView)},getZoomRuler:function(){return this._zoomRuler},getModel:function(){if(!this._textView)return null;var b=this._textView.getModel();b.getBaseModel&&(b=b.getBaseModel());return b},getOverviewRuler:function(){return this._overviewRuler},
getTextView:function(){return this._textView},getKeyModes:function(){return this._textView.getKeyModes()},getSourceCodeActions:function(){return this._sourceCodeActions},getLinkedMode:function(){return this._linkedMode},getTextActions:function(){return this._textActions},focus:function(){this._textView&&this._textView.focus()},resize:function(){this._textView&&this._textView.resize()},setAnnotationRulerVisible:function(b,a){if(this._annotationRulerVisible!==b||a)if(this._annotationRulerVisible=b,
this._annotationRuler){var c=this._textView;b?c.addRuler(this._annotationRuler,0):c.removeRuler(this._annotationRuler)}},setFoldingRulerVisible:function(b,a){if(this._foldingRulerVisible!==b||a)if(this._foldingRulerVisible=b,this._foldingRuler){var c=this._textView;c.getModel().getBaseModel&&(b?c.addRuler(this._foldingRuler):c.removeRuler(this._foldingRuler))}},setLineNumberRulerVisible:function(b,a){if(this._lineNumberRulerVisible!==b||a)if(this._lineNumberRulerVisible=b,this._lineNumberRuler){var c=
this._textView;b?c.addRuler(this._lineNumberRuler,!this._annotationRulerVisible?0:1):c.removeRuler(this._lineNumberRuler)}},setOverviewRulerVisible:function(b,a){if(this._overviewRulerVisible!==b||a)if(this._overviewRulerVisible=b,this._overviewRuler){var c=this._textView;b?c.addRuler(this._overviewRuler):c.removeRuler(this._overviewRuler)}},setZoomRulerVisible:function(b,a){if(this._zoomRulerVisible!==b||a)if(this._zoomRulerVisible=b,this._zoomRuler){var c=this._textView;b?c.addRuler(this._zoomRuler):
c.removeRuler(this._zoomRuler)}},mapOffset:function(b,a){var c=this._textView.getModel();c.getBaseModel&&(b=c.mapOffset(b,a));return b},getLineAtOffset:function(b){return this.getModel().getLineAtOffset(this.mapOffset(b))},getLineStart:function(b){return this.getModel().getLineStart(b)},getCaretOffset:function(){return this.mapOffset(this._textView.getCaretOffset())},getSelection:function(){var b=this._textView,a=b.getSelection(),b=b.getModel();b.getBaseModel&&(a.start=b.mapOffset(a.start),a.end=
b.mapOffset(a.end));return a},getSelections:function(){var b=this._textView,a=b.getModel(),b=b.getSelections();b.forEach(function(b){a.getBaseModel&&(b.start=a.mapOffset(b.start),b.end=a.mapOffset(b.end))});return b},_expandOffset:function(b){var a=this._textView.getModel(),c=this._annotationModel;if(c&&a.getBaseModel)for(b=c.getAnnotations(b,b+1);b.hasNext();)a=b.next(),a.type===l.ANNOTATION_FOLDING&&a.expand&&a.expand()},setCaretOffset:function(b,a,c){var d=this._textView,e=d.getModel();e.getBaseModel&&
(this._expandOffset(b),b=e.mapOffset(b,!0));d.setCaretOffset(b,a,c)},setText:function(b,a,c,d,e){var f=this._textView,g=f.getModel();g.getBaseModel&&(void 0!==a&&(this._expandOffset(a),a=g.mapOffset(a,!0)),void 0!==c&&(this._expandOffset(c),c=g.mapOffset(c,!0)));f.setText(b,a,c,d,e)},setSelection:function(b,a,c,d){var e=this._textView,f=e.getModel();f.getBaseModel&&(this._expandOffset(b),this._expandOffset(a),b=f.mapOffset(b,!0),a=f.mapOffset(a,!0));e.setSelection(b,a,c,d)},setSelections:function(b,
a,c){var d=this,e=this._textView,f=e.getModel();b.forEach(function(a){var b=a.start,c=a.end;f.getBaseModel&&(d._expandOffset(b),d._expandOffset(c),b=f.mapOffset(b,!0),c=f.mapOffset(c,!0));a.start=b;a.end=c});e.setSelections(b,a,c)},moveSelection:function(b,a,c,d){var e=this._textView;this.setSelection(b,a||b,1/3,function(){(void 0===d||d)&&e.focus();c&&c()})},_getTooltipInfo:function(b,a){var c=this._textView,d=this.getAnnotationModel();if(!d)return null;var e=this._annotationStyler;if(!e||!c.isValidTextPosition(b,
a))return null;c=c.getOffsetAtLocation(b,a);if(-1===c)return null;for(var c=this.mapOffset(c),d=e.getAnnotationsByType(d,c,c+1),e=[],f=0;f<d.length;f++)d[f].rangeStyle&&e.push(d[f]);return{contents:e,position:"below",context:{source:"editor",offset:c}}},_highlightCurrentLine:function(b,a){function c(a){var b={};return a&&a.some(function(a){if(a&&a.isEmpty())b[g.getLineAtOffset(a.start).toString()]=!0;else return!0;return!1})?{}:b}function d(a,b){for(var c in a)if(!b[c])return!0;return!1}var e=this._annotationModel;
if(e){var f=this._textView;if(!f.getOptions("singleMode")){a=Array.isArray(a)?a:[a];b=Array.isArray(b)?b:[b];var g=f.getModel(),f=c(a),k=c(b);if(d(f,k)||d(k,f)){var f=this._currentLineAnnotations,n=[],m;for(m in k){var A=m>>0,k=g.getLineStart(A),A=g.getLineEnd(A);g.getBaseModel&&(k=g.mapOffset(k),A=g.mapOffset(A));k=l.createAnnotation(l.ANNOTATION_CURRENT_LINE,k,A);n.push(k)}this._currentLineAnnotations=n;e.replaceAnnotations(f,n)}}}},installTextView:function(){this.install()},install:function(){if(!this._textView){this._textView=
this._textViewFactory();this._undoStackFactory&&(this._undoStack=this._undoStackFactory.createUndoStack(this),this._textView.setOptions({undoStack:this._undoStack}),this.checkDirty());this._textDNDFactory&&(this._textDND=this._textDNDFactory.createTextDND(this,this._undoStack));this._contentAssistFactory&&(this._contentAssist=this._contentAssistFactory.createContentAssistMode(this).getContentAssist());var b=e.Tooltip.getTooltip(this._textView);this._hoverFactory&&(this._hover=this._hoverFactory.createHover(this),
b.hover=this._hover);var a=this,c=this._textView,d=this;this._listener={onModelChanged:function(a){d.checkDirty()},onMouseOver:function(a){d._listener.onMouseMove(a)},onMouseDown:function(a){d._listener.mouseDown=!0},onMouseUp:function(a){d._listener.mouseDown=!1},onMouseMove:function(a){b&&!d._listener.mouseDown&&!(a.event.clientX===d._listener.lastMouseX&&a.event.clientY===d._listener.lastMouseY)&&(d._listener.lastMouseX=a.event.clientX,d._listener.lastMouseY=a.event.clientY,d._hoverTimeout&&(window.clearTimeout(d._hoverTimeout),
d._hoverTimeout=null),d._hoverTimeout=window.setTimeout(function(){d._hoverTimeout=null;if(d._listener)b.onHover({y:a.y,x:a.x,getTooltipInfo:function(){return d._getTooltipInfo(this.x,this.y)}},a.x,a.y)},175))},onMouseOut:function(a){d._hoverTimeout&&(window.clearTimeout(d._hoverTimeout),d._hoverTimeout=null)},onScroll:function(a){b&&b.hide()},onSelection:function(a){b&&b.hide();d._updateCursorStatus();d._highlightCurrentLine(a.newValue,a.oldValue)}};c.addEventListener("ModelChanged",this._listener.onModelChanged);
c.addEventListener("Selection",this._listener.onSelection);c.addEventListener("MouseOver",this._listener.onMouseOver);c.addEventListener("MouseOut",this._listener.onMouseOut);c.addEventListener("MouseDown",this._listener.onMouseDown);c.addEventListener("MouseUp",this._listener.onMouseUp);c.addEventListener("MouseMove",this._listener.onMouseMove);c.addEventListener("Scroll",this._listener.onScroll);if(this._keyBindingFactory){var g;if(g="function"===typeof this._keyBindingFactory?this._keyBindingFactory(this,
this.getKeyModes(),this._undoStack,this._contentAssist):this._keyBindingFactory.createKeyBindings(a,this._undoStack,this._contentAssist))this._textActions=g.textActions,this._linkedMode=g.linkedMode,this._sourceCodeActions=g.sourceCodeActions}g=function(b,c){if(void 0!==b&&-1!==b){for(var d=this.getView().getModel(),h=this.getAnnotationModel(),e=a.mapOffset(d.getLineStart(b)),d=a.mapOffset(d.getLineEnd(b)),f=h.getAnnotations(e,d),g=null;f.hasNext();){var k=f.next();if(k.type===l.ANNOTATION_BOOKMARK){g=
k;break}}g?h.removeAnnotation(g):(g=l.createAnnotation(l.ANNOTATION_BOOKMARK,e,d,a.getText(e,d)),h.addAnnotation(g))}};if(this._annotationFactory){var k=c.getModel();k.getBaseModel&&(k=k.getBaseModel());if(this._annotationModel=this._annotationFactory.createAnnotationModel(k))if(k=this._annotationStyler=this._annotationFactory.createAnnotationStyler(c,this._annotationModel))k.addAnnotationType(l.ANNOTATION_CURRENT_SEARCH),k.addAnnotationType(l.ANNOTATION_MATCHING_SEARCH),k.addAnnotationType(l.ANNOTATION_ERROR),
k.addAnnotationType(l.ANNOTATION_WARNING),k.addAnnotationType(l.ANNOTATION_MATCHING_BRACKET),k.addAnnotationType(l.ANNOTATION_CURRENT_BRACKET),k.addAnnotationType(l.ANNOTATION_CURRENT_LINE),k.addAnnotationType(l.ANNOTATION_READ_OCCURRENCE),k.addAnnotationType(l.ANNOTATION_WRITE_OCCURRENCE),k.addAnnotationType(l.ANNOTATION_SELECTED_LINKED_GROUP),k.addAnnotationType(l.ANNOTATION_CURRENT_LINKED_GROUP),k.addAnnotationType(l.ANNOTATION_LINKED_GROUP),k.addAnnotationType("orion.annotation.highlightError");
var k=this._annotationFactory.createAnnotationRulers(this._annotationModel),n=this._annotationRuler=k.annotationRuler;n&&(n.onDblClick=g,n.setMultiAnnotationOverlay({html:"\x3cdiv class\x3d'annotationHTML overlay'\x3e\x3c/div\x3e"}),n.addAnnotationType(l.ANNOTATION_ERROR),n.addAnnotationType(l.ANNOTATION_WARNING),n.addAnnotationType(l.ANNOTATION_TASK),n.addAnnotationType(l.ANNOTATION_BOOKMARK),n.addAnnotationType(l.ANNOTATION_DIFF_ADDED),n.addAnnotationType(l.ANNOTATION_DIFF_DELETED),n.addAnnotationType(l.ANNOTATION_DIFF_MODIFIED));
this.setAnnotationRulerVisible(this._annotationRulerVisible||void 0===this._annotationRulerVisible,!0);if(n=this._overviewRuler=k.overviewRuler)n.addAnnotationType(l.ANNOTATION_CURRENT_SEARCH),n.addAnnotationType(l.ANNOTATION_MATCHING_SEARCH),n.addAnnotationType(l.ANNOTATION_READ_OCCURRENCE),n.addAnnotationType(l.ANNOTATION_WRITE_OCCURRENCE),n.addAnnotationType(l.ANNOTATION_CURRENT_BLAME),n.addAnnotationType(l.ANNOTATION_ERROR),n.addAnnotationType(l.ANNOTATION_WARNING),n.addAnnotationType(l.ANNOTATION_TASK),
n.addAnnotationType(l.ANNOTATION_BOOKMARK),n.addAnnotationType(l.ANNOTATION_MATCHING_BRACKET),n.addAnnotationType(l.ANNOTATION_CURRENT_BRACKET),n.addAnnotationType(l.ANNOTATION_CURRENT_LINE),n.addAnnotationType(l.ANNOTATION_DIFF_ADDED),n.addAnnotationType(l.ANNOTATION_DIFF_DELETED),n.addAnnotationType(l.ANNOTATION_DIFF_MODIFIED);this.setOverviewRulerVisible(this._overviewRulerVisible||void 0===this._overviewRulerVisible,!0)}this._zoomRulerFactory&&(this._zoomRuler=this._zoomRulerFactory.createZoomRuler(this._annotationModel),
this.setZoomRulerVisible(this._zoomRulerVisible,!0));this._lineNumberRulerFactory&&(this._lineNumberRuler=this._lineNumberRulerFactory.createLineNumberRuler(this._annotationModel),this._lineNumberRuler.addAnnotationType(l.ANNOTATION_CURRENT_BLAME),this._lineNumberRuler.addAnnotationType(l.ANNOTATION_BLAME),this._lineNumberRuler.addAnnotationType(l.ANNOTATION_DIFF_ADDED),this._lineNumberRuler.addAnnotationType(l.ANNOTATION_DIFF_MODIFIED),this._lineNumberRuler.addAnnotationType(l.ANNOTATION_DIFF_DELETED),
this._lineNumberRuler.onDblClick=g,this.setLineNumberRulerVisible(this._lineNumberRulerVisible||void 0===this._lineNumberRulerVisible,!0));this._foldingRulerFactory&&(this._foldingRuler=this._foldingRulerFactory.createFoldingRuler(this._annotationModel),this._foldingRuler.addAnnotationType(l.ANNOTATION_FOLDING),this.setFoldingRulerVisible(this._foldingRulerVisible||void 0===this._foldingRulerVisible,!0));this.dispatchEvent({type:"TextViewInstalled",textView:c});f.prototype.install.call(this)}},uninstallTextView:function(){this.uninstall()},
uninstall:function(){var b=this._textView;b&&(b.destroy(),this._annotationModel&&this._annotationModel.setTextModel(null),this._textView=this._undoStack=this._textDND=this._contentAssist=this._listener=this._annotationModel=this._annotationStyler=this._annotationRuler=this._overviewRuler=this._zoomRuler=this._lineNumberRuler=this._foldingRuler=this._currentLineAnnotations=this._title=null,this._dirty=!1,this._foldingRulerVisible=this._overviewRulerVisible=this._zoomRulerVisible=this._lineNumberRulerVisible=
this._annotationRulerVisible=void 0,this.dispatchEvent({type:"TextViewUninstalled",textView:b}),f.prototype.uninstall.call(this))},_updateCursorStatus:function(){for(var b=this.getKeyModes(),a=0;a<b.length;a++){var c=b[a];if(c.isActive()&&c.isStatusActive&&c.isStatusActive())return}b=this.getModel();a=this.getSelections();1<a.length?b=d.formatMessage(k.multiSelections,a.length):(a=a[0].getCaret(),c=b.getLineAtOffset(a),b=b.getLineStart(c),b=d.formatMessage(k.lineColumn,c+1,a-b+1));this.reportStatus(b)},
showAnnotations:function(b,a,c,d){var e=this._annotationModel;if(e){for(var f=[],g=[],k=e.getTextModel(),n=e.getAnnotations(),m;n.hasNext();)m=n.next(),-1!==a.indexOf(m.type)&&m.creatorID===this&&f.push(m);if(b)for(a=0;a<b.length;a++)if(m=b[a]){if(c)m=c(m);else{var A;m.lineStart&&m.lineEnd?(n=k.getLineStart(m.lineStart),A=k.getLineCount()===m.lineEnd?k.getLineEnd(m.lineEnd-1):k.getLineStart(m.lineEnd)):"number"===typeof m.line?(A=k.getLineStart(m.line-1),n=A+m.start-1,A=A+m.end-1):(n=m.start,A=m.end);
var z=d(m);if(!z)continue;m=l.createAnnotation(z,n,A,m.description)}m.id=b[a].id;b[a].data&&(m.data=b[a].data);m.creatorID=this;g.push(m)}e.replaceAnnotations(f,g)}},showProblems:function(b){this.showAnnotations(b,[l.ANNOTATION_ERROR,l.ANNOTATION_WARNING,l.ANNOTATION_TASK],null,function(a){switch(a.severity){case "error":return l.ANNOTATION_ERROR;case "warning":return l.ANNOTATION_WARNING;case "task":return l.ANNOTATION_TASK}return null})},showOccurrences:function(b){this.showAnnotations(b,[l.ANNOTATION_READ_OCCURRENCE,
l.ANNOTATION_WRITE_OCCURRENCE],null,function(a){return a.readAccess?l.ANNOTATION_READ_OCCURRENCE:l.ANNOTATION_WRITE_OCCURRENCE})},showBlame:function(b){var a=this._blameRGB,e=this.getTextView().getOptions("parent").ownerDocument;if(!a){var h=d.createElement(e,"div");h.className="annotation blame";e.body.appendChild(h);var f=(e.defaultView||e.parentWindow).getComputedStyle(h).getPropertyValue("background-color");h.parentNode.removeChild(h);var h=f.indexOf("("),r=f.indexOf(")"),f=f.substring(h+1,r);
this._blameRGB=a=f.split(",").slice(0,3)}var n=function(){var a=c.AnnotationType.createAnnotation(this.groupType,this.start,this.end,this.title);a.style=g.mixin({},a.style);a.style.style=g.mixin({},a.style.style);a.style.style.backgroundColor="";this.groupAnnotation=a;a.blame=this.blame;a.html=this.html;a.creatorID=this.creatorID;return a},m=function(){var a=d.createElement(e,"div");a.className="tooltipTitle";var b=this.blame.Message.indexOf("\n");-1===b&&(b=this.blame.Message.length);var c=d.createElement(e,
"a");c.href=this.blame.CommitLink;c.appendChild(e.createTextNode(this.blame.Message.substring(0,b)));a.appendChild(c);a.appendChild(d.createElement(e,"br"));a.appendChild(e.createTextNode(d.formatMessage(k.committerOnTime,this.blame.AuthorName,this.blame.Time)));return a},w=this.getModel();this.showAnnotations(b,[l.ANNOTATION_BLAME,l.ANNOTATION_CURRENT_BLAME],function(b){var d=w.getLineStart(b.Start-1),h=w.getLineEnd(b.End-1,!0),d=c.AnnotationType.createAnnotation(l.ANNOTATION_BLAME,d,h,m),h=a.slice(0);
h.push(b.Shade);d.style=g.mixin({},d.style);d.style.style=g.mixin({},d.style.style);d.style.style.backgroundColor="rgba("+h.join()+")";d.groupId=b.Name;d.groupType=l.ANNOTATION_CURRENT_BLAME;d.createGroupAnnotation=n;d.html='\x3cimg class\x3d"annotationHTML blame" src\x3d"'+b.AuthorImage+'"/\x3e';d.blame=b;return d})},showDiffAnnotations:function(b){this.showAnnotations(b,[l.ANNOTATION_DIFF_ADDED,l.ANNOTATION_DIFF_MODIFIED,l.ANNOTATION_DIFF_DELETED],null,function(a){return"added"===a.type?l.ANNOTATION_DIFF_ADDED:
"modified"===a.type?l.ANNOTATION_DIFF_MODIFIED:l.ANNOTATION_DIFF_DELETED})},showSelection:function(b,a,c,d,e){return"number"===typeof b?("number"!==typeof a&&(a=b),this.moveSelection(b,a),!0):"number"===typeof c?(b=this.getModel().getLineStart(c-1),"number"===typeof d&&(b+=d),"number"!==typeof e&&(e=0),this.moveSelection(b,b+e),!0):!1},_setModelText:function(b){this._textView&&(this._textView.setText(b),this._textView.getModel().setLineDelimiter("auto"),this._highlightCurrentLine(this._textView.getSelections()))},
setInput:function(b,a,c,d,e){f.prototype.setInput.call(this,b,a,c,d);this._textView&&(!d&&!e)&&this._textView.focus()},onGotoLine:function(b,a,c,d){if(this._textView){var e=this.getModel();b=Math.max(0,Math.min(b,e.getLineCount()-1));var f=e.getLineStart(b),g=0;void 0===c&&(c=0);"string"===typeof a?(b=e.getLine(b).indexOf(a),-1!==b&&(g=b,c=g+a.length)):(g=a,a=e.getLineEnd(b)-f,g=Math.min(g,a),c=Math.min(c,a));this.moveSelection(f+g,f+c,d)}}});return{BaseEditor:f,Editor:n}});
define("orion/editor/find","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/keyModes orion/editor/annotations orion/regex orion/objects orion/util".split(" "),function(k,m,e,c,g,d,f){function n(a){var b=a.getTextView();e.KeyMode.call(this,b);this.editor=a;this._active=!1;this._success=!0;this._ignoreSelection=!1;this._prefix="";b.setAction("incrementalFindCancel",function(){this.setActive(!1);return!0}.bind(this));b.setAction("incrementalFindBackspace",function(){return this._backspace()}.bind(this));
var c=this;this._listener={onVerify:function(a){var b=c.editor,d=b.getModel(),e=b.mapOffset(a.start),b=b.mapOffset(a.end),d=d.getText(e,b);if((d=c._prefix.match(RegExp("^"+g.escape(d),"i")))&&0<d.length)c._prefix+=a.text,c._success=!0,c._status(),c.find(c._forward,!0),a.text=null},onSelection:function(){c._ignoreSelection||c.setActive(!1)}}}function l(a,b,c){if(a){this._editor=a;this._undoStack=b;this._showAll=!0;this._visible=!1;this._wrap=this._caseInsensitive=!0;this._wholeWord=!1;this._incremental=
!0;this._regex=!1;this._findAfterReplace=!0;this._reverse=this._hideAfterFind=!1;this._timer=this._end=this._start=void 0;this._lastString="";var d=this;this._listeners={onEditorFocus:function(a){d._removeCurrentAnnotation(a)}};this.setOptions(c)}}var b={};n.prototype=new e.KeyMode;d.mixin(n.prototype,{createKeyBindings:function(){var a=m.KeyBinding,b=[];b.push({actionID:"incrementalFindBackspace",keyBinding:new a(8)});b.push({actionID:"incrementalFindCancel",keyBinding:new a(13)});b.push({actionID:"incrementalFindCancel",
keyBinding:new a(27)});b.push({actionID:"incrementalFindReverse",keyBinding:new a(38)});b.push({actionID:"incrementalFind",keyBinding:new a(40)});b.push({actionID:"incrementalFindReverse",keyBinding:new a("k",!0,!0)});b.push({actionID:"incrementalFind",keyBinding:new a("k",!0)});return b},find:function(a,b){this._forward=a;if(!this.isActive())return this.setActive(!0),!1;var c=this._prefix;if(0===c.length)return!1;var d=this.editor,e=d.getModel(),e=a?this._success?b?this._start:d.getCaretOffset()+
1:0:this._success?b?this._start:d.getCaretOffset():e.getCharCount()-1;(c=d.getModel().find({string:c,start:e,reverse:!a,caseInsensitive:c.toLowerCase()===c}).next())?(b||(this._start=e),this._ignoreSelection=this._success=!0,d.moveSelection(a?c.start:c.end,a?c.end:c.start),this._ignoreSelection=!1):this._success=!1;this._status();return!0},isActive:function(){return this._active},isStatusActive:function(){return this.isActive()},setActive:function(a){this._active!==a&&(this._active=a,this._prefix=
"",this._success=!0,a=this.editor.getTextView(),this._start=this.editor.getCaretOffset(),this.editor.setCaretOffset(this._start),this._active?(a.addEventListener("Verify",this._listener.onVerify),a.addEventListener("Selection",this._listener.onSelection),a.addKeyMode(this)):(a.removeEventListener("Verify",this._listener.onVerify),a.removeEventListener("Selection",this._listener.onSelection),a.removeKeyMode(this)),this._status())},_backspace:function(){var a=this._prefix,a=this._prefix=a.substring(0,
a.length-1);return 0===a.length?(this._ignoreSelection=this._success=!0,this.editor.setCaretOffset(this.editor.getSelection().start),this._ignoreSelection=!1,this._status(),!0):this.find(this._forward,!0)},_status:function(){if(this.isActive()){var a;a=this._forward?this._success?k.incrementalFindStr:k.incrementalFindStrNotFound:this._success?k.incrementalFindReverseStr:k.incrementalFindReverseStrNotFound;a=f.formatMessage(a,this._prefix);this.editor.reportStatus(a,this._success?"":"error")}else this.editor.reportStatus("")}});
b.IncrementalFind=n;l.prototype={find:function(a,b,c){this.setOptions({reverse:!a});var d=this.getFindString(),e;b&&(d=b.findString||d,e=b.count);a=this.getOptions();this.setOptions(b);b=c?this._startOffset:this.getStartOffset();if((e=this._doFind(d,b,e))&&!c)this._startOffset=e.start;this.setOptions(a);this._hideAfterFind&&this.hide();return e},getStartOffset:function(){return void 0!==this._start?this._start:this._reverse?this._editor.getSelection().start-1:this._editor.getCaretOffset()},getFindString:function(){var a=
this._editor.getSelection(),a=this._editor.getText(a.start,a.end);this._regex&&(a=g.escape(a));return a||this._lastString},getOptions:function(){return{showAll:this._showAll,caseInsensitive:this._caseInsensitive,wrap:this._wrap,wholeWord:this._wholeWord,incremental:this._incremental,regex:this._regex,findAfterReplace:this._findAfterReplace,hideAfterFind:this._hideAfterFind,reverse:this._reverse,findCallback:this._findCallback,start:this._start,end:this._end}},getReplaceString:function(){return""},
hide:function(){this._visible=!1;this._savedOptions&&(this.setOptions(this._savedOptions.pop()),0===this._savedOptions.length&&(this._savedOptions=null));this._removeAllAnnotations();var a=this._editor.getTextView();a&&(a.removeEventListener("Focus",this._listeners.onEditorFocus),a.focus())},_processReplaceString:function(a){var b=a;if(this._regex){for(var b="",c=!1,d=this._editor.getModel().getLineDelimiter(),e=0;e<a.length;e++){var f=a.substring(e,e+1);if(c){switch(f){case "R":b+=d;break;case "r":b+=
"\r";break;case "n":b+="\n";break;case "t":b+="\t";break;case "\\":b+="\\";break;default:b+="\\"+f}c=!1}else"\\"===f?c=!0:b+=f}c&&(b+="\\")}return b},isVisible:function(){return this._visible},replace:function(){var a=this.getFindString();if(a){var b=this._editor,c=this._processReplaceString(this.getReplaceString()),d=b.getSelection().start;if(b=b.getModel().find({string:a,start:d,reverse:!1,wrap:this._wrap,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive}).next())this.startUndo(),
this._doReplace(b.start,b.end,a,c),this.endUndo()}this._findAfterReplace&&a&&this._doFind(a,this.getStartOffset())},replaceAll:function(){var a=this.getFindString();if(a){this._replacingAll=!0;var b=this._editor,c=b.getTextView();b.reportStatus(k.replacingAll);var d=this._processReplaceString(this.getReplaceString()),e=this;window.setTimeout(function(){for(var g=0,l=0;;){var n=e._doFind(a,g,null,!0);if(!n)break;l++;1===l&&(c.setRedraw(!1),e.startUndo());e._doReplace(n.start,n.end,a,d);g=e.getStartOffset()}0<
l&&(e.endUndo(),c.setRedraw(!0));0<g?b.reportStatus(f.formatMessage(k.replacedMatches,l)):b.reportStatus(k.nothingReplaced,"error");e._replacingAll=!1},100)}},setOptions:function(a){if(a){if((!0===a.showAll||!1===a.showAll)&&this._showAll!==a.showAll)if(this._showAll=a.showAll,this.isVisible())if(this._showAll)this._markAllOccurrences();else{var b=this._editor.getAnnotationModel();b&&b.removeAnnotations(c.AnnotationType.ANNOTATION_MATCHING_SEARCH)}if(!0===a.caseInsensitive||!1===a.caseInsensitive)this._caseInsensitive=
a.caseInsensitive;if(!0===a.wrap||!1===a.wrap)this._wrap=a.wrap;if(!0===a.wholeWord||!1===a.wholeWord)this._wholeWord=a.wholeWord;if(!0===a.incremental||!1===a.incremental)this._incremental=a.incremental;if(!0===a.regex||!1===a.regex)this._regex=a.regex;if(!0===a.findAfterReplace||!1===a.findAfterReplace)this._findAfterReplace=a.findAfterReplace;if(!0===a.hideAfterFind||!1===a.hideAfterFind)this._hideAfterFind=a.hideAfterFind;if(!0===a.reverse||!1===a.reverse)this._reverse=a.reverse;a.hasOwnProperty("findCallback")&&
(this._findCallback=a.findCallback);a.hasOwnProperty("start")&&(this._start=a.start);a.hasOwnProperty("end")&&(this._end=a.end)}},show:function(a){this._visible=!0;a&&(this._savedOptions||(this._savedOptions=[]),this._savedOptions.push(this.getOptions()),this.setOptions(a));this._startOffset=this._editor.getSelection().start;this._editor.getTextView().addEventListener("Focus",this._listeners.onEditorFocus);var b=this;window.setTimeout(function(){b._incremental&&b.find(!0,null,!0)},0)},startUndo:function(){this._undoStack&&
this._undoStack.startCompoundChange()},endUndo:function(){this._undoStack&&this._undoStack.endCompoundChange()},_find:function(a,b,c){return this._editor.getModel().find({string:a,start:b,end:this._end,reverse:this._reverse,wrap:c?!1:this._wrap,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive})},_doFind:function(a,b,d,e){d=d||1;var f=this._editor;if(!a)return this._removeAllAnnotations(),null;this._lastString=a;var g,l;if(this._regex)try{l=this._find(a,b,e)}catch(n){f.reportStatus(n.message,
"error");return}else l=this._find(a,b,e);for(a=0;a<d&&l.hasNext();a++)g=l.next();if(!this._replacingAll){g?this._editor.reportStatus(""):this._editor.reportStatus(k.notFound,"error");if(this.isVisible()){d=c.AnnotationType.ANNOTATION_CURRENT_SEARCH;if(l=f.getAnnotationModel())l.removeAnnotations(d),g&&l.addAnnotation(c.AnnotationType.createAnnotation(d,g.start,g.end));if(this._showAll){this._timer&&window.clearTimeout(this._timer);var m=this;this._timer=window.setTimeout(function(){m._markAllOccurrences();
m._timer=null},500)}}this._findCallback?this._findCallback(g):g&&f.moveSelection(g.start,g.end,null,!1)}return g},_doReplace:function(a,b,c,d){var e=this._editor;this._regex&&(d=e.getText(a,b).replace(RegExp(c,this._caseInsensitive?"i":""),d));e.setText(d,a,b);e.setSelection(a,a+d.length,!0)},_markAllOccurrences:function(){var a=this._editor.getAnnotationModel();if(a){for(var b=c.AnnotationType.ANNOTATION_MATCHING_SEARCH,d=a.getAnnotations(),e=[],f;d.hasNext();){var g=d.next();g.type===b&&e.push(g)}if(this.isVisible()){d=
this.getFindString();d=this._editor.getModel().find({string:d,regex:this._regex,wholeWord:this._wholeWord,caseInsensitive:this._caseInsensitive});for(f=[];d.hasNext();)g=d.next(),f.push(c.AnnotationType.createAnnotation(b,g.start,g.end))}a.replaceAnnotations(e,f)}},_removeAllAnnotations:function(){var a=this._editor.getAnnotationModel();a&&(a.removeAnnotations(c.AnnotationType.ANNOTATION_CURRENT_SEARCH),a.removeAnnotations(c.AnnotationType.ANNOTATION_MATCHING_SEARCH))},_removeCurrentAnnotation:function(a){(a=
this._editor.getAnnotationModel())&&a.removeAnnotations(c.AnnotationType.ANNOTATION_CURRENT_SEARCH)}};b.Find=l;return b});
define("orion/editor/findUI",["i18n!orion/editor/nls/messages","orion/editor/find","orion/objects","orion/editor/util","orion/util"],function(k,m,e,c,g){function d(c,d,e){m.Find.call(this,c,d,e)}d.prototype=new m.Find;e.mixin(d.prototype,{getFindString:function(){var c=this._findInput;return!c?m.Find.prototype.getFindString.call(this):c.value},getReplaceString:function(){var c=this._replaceInput;return!c?m.Find.prototype.getReplaceString(this):c.value},hide:function(){var c=this.isVisible();m.Find.prototype.hide.call(this);
c&&(this._rootDiv.className="textViewFind")},show:function(c){m.Find.prototype.show.call(this,c);var d=c.findString;c=c.replaceString;var e=this._findInput;e||(this._create(),e=this._findInput);d&&(e.value=d);c&&(this._replaceInput.value=c);var b=this;window.setTimeout(function(){b._rootDiv.className="textViewFind show";e.select();e.focus()},0)},_create:function(){var d=this,e=this._editor.getTextView(),l=e.getOptions("parent").ownerDocument,b=g.createElement(l,"div");b.className="textViewFind";c.addEventListener(b,
"keydown",function(a){d._handleKeyDown(a)});this._rootDiv=b;this._createContents(l,b);e._rootDiv.insertBefore(b,e._rootDiv.firstChild)},_createContents:function(d,e){var l=this,b=g.createElement(d,"input");b.className="textViewFindInput";this._findInput=b;b.type="text";b.placeholder=k.findWith;c.addEventListener(b,"input",function(a){return l._handleInput(a)});e.appendChild(b);b=g.createElement(d,"span");l._createButton(d,b,k.next,function(){l.find(!0)});l._createButton(d,b,k.previous,function(){l.find(!1)});
e.appendChild(b);l._editor.getTextView().getOptions("readonly")||(b=g.createElement(d,"input"),b.className="textViewReplaceInput",this._replaceInput=b,b.type="text",b.placeholder=k.replaceWith,e.appendChild(b),b=g.createElement(d,"span"),l._createButton(d,b,k.replace,function(){l.replace()}),l._createButton(d,b,k.replaceAll,function(){l.replaceAll()}),e.appendChild(b));b=g.createElement(d,"span");l._createButton(d,b,k.regex,function(a){l._toggle("regex",a.target)},this._regex,k.regexTooltip);l._createButton(d,
b,k.caseInsensitive,function(a){l._toggle("caseInsensitive",a.target)},this._caseInsensitive,k.caseInsensitiveTooltip);l._createButton(d,b,k.wholeWord,function(a){l._toggle("wholeWord",a.target)},this._wholeWord,k.wholeWordTooltip);e.appendChild(b);b=l._createButton(d,e,"",function(){l.hide()});b.className="textViewFindCloseButton";b.title=k.closeTooltip},_createButton:function(d,e,g,b,a,k){var h=d.createElement("button");this._checked(a,h);k&&(h.title=k);c.addEventListener(h,"click",function(a){b.call(this,
a)},!1);g&&h.appendChild(d.createTextNode(g));e.appendChild(h);return h},_toggle:function(c,d){var e={};e[c]=!this["_"+c];this.setOptions(e);this._checked(e[c],d)},_checked:function(c,d){d.className="textViewFindButton";c&&(d.className+=" checked")},_handleInput:function(){this._incremental&&this.find(!0,null,!0);return!0},_handleKeyDown:function(c){var d,e=(g.isMac?c.metaKey:c.ctrlKey)&&!c.altKey&&!c.shiftKey;e&&70===c.keyCode&&(d=!0);if((g.isMac?c.metaKey:c.ctrlKey)&&!c.altKey&&75===c.keyCode||
13===c.keyCode)13===c.keyCode?this.find(this._reverse?c.shiftKey:!c.shiftKey):this.find(!c.shiftKey),d=!0;e&&82===c.keyCode&&(this.replace(),d=!0);27===c.keyCode&&(this.hide(),d=!0);return d?(c.stopPropagation&&c.stopPropagation(),c.preventDefault&&c.preventDefault(),c.cancelBubble=!0,!1):!0}});return{FindUI:d}});
define("orion/editor/actions","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/annotations orion/editor/tooltip orion/editor/find orion/editor/findUI orion/util".split(" "),function(k,m,e,c,g,d,f){function n(a,b,c,d){function e(a,b,c){g.setText(a,b,c);f+=b-c+a.length}var f=0,g=a.editor,l=g.getSelections();!d&&(b||1<l.length)&&a.startUndo();l.forEach(function(a){a.start+=f;a.end+=f;c(a,e)});g.setSelections(l);!d&&(b||1<l.length)&&a.endUndo()}function l(a,b,c){this.editor=a;this.undoStack=
b;this._incrementalFind=new g.IncrementalFind(a);this._find=c?c:new d.FindUI(a,b);this._lastEditLocation=null;this.init()}function b(a,b,c,d){this.editor=a;this.undoStack=b;this.contentAssist=c;this.linkedMode=d;this.contentAssist&&this.contentAssist.addEventListener("ProposalApplied",this.contentAssistProposalApplied.bind(this));this.init()}var a=e.AnnotationType,q={};l.prototype={init:function(){var a=this.editor.getTextView();this._lastEditListener={onModelChanged:function(a){this.editor.isDirty()&&
(this._lastEditLocation=a.start+a.addedCharCount)}.bind(this)};a.addEventListener("ModelChanged",this._lastEditListener.onModelChanged);a.setAction("undo",function(a){if(this.undoStack){var b=1;a&&a.count&&(b=a.count);for(;0<b;)this.undoStack.undo(),--b;return!0}return!1}.bind(this),{name:k.undo});a.setAction("redo",function(a){if(this.undoStack){var b=1;a&&a.count&&(b=a.count);for(;0<b;)this.undoStack.redo(),--b;return!0}return!1}.bind(this),{name:k.redo});a.setKeyBinding(new m.KeyBinding("f",!0),
"find");a.setAction("find",function(){if(this._find){var a=this.editor.getSelection();this._find.show({findString:this.editor.getText(a.start,a.end)});return!0}return!1}.bind(this),{name:k.find});a.setKeyBinding(new m.KeyBinding("k",!0),"findNext");a.setAction("findNext",function(a){return this._find?(this._find.find(!0,a),!0):!1}.bind(this),{name:k.findNext});a.setKeyBinding(new m.KeyBinding("k",!0,!0),"findPrevious");a.setAction("findPrevious",function(a){return this._find?(this._find.find(!1,a),
!0):!1}.bind(this),{name:k.findPrevious});a.setKeyBinding(new m.KeyBinding("j",!0),"incrementalFind");a.setAction("incrementalFind",function(){this._incrementalFind&&this._incrementalFind.find(!0);return!0}.bind(this),{name:k.incrementalFind});a.setKeyBinding(new m.KeyBinding("j",!0,!0),"incrementalFindReverse");a.setAction("incrementalFindReverse",function(){this._incrementalFind&&this._incrementalFind.find(!1);return!0}.bind(this),{name:k.incrementalFindReverse});a.setAction("tab",function(){return this.indentLines()}.bind(this));
a.setAction("shiftTab",function(){return this.unindentLines()}.bind(this),{name:k.unindentLines});a.setKeyBinding(new m.KeyBinding(38,!1,!1,!0),"moveLinesUp");a.setAction("moveLinesUp",function(){return this.moveLinesUp()}.bind(this),{name:k.moveLinesUp});a.setKeyBinding(new m.KeyBinding(40,!1,!1,!0),"moveLinesDown");a.setAction("moveLinesDown",function(){return this.moveLinesDown()}.bind(this),{name:k.moveLinesDown});a.setKeyBinding(new m.KeyBinding(38,!0,!1,!0),"copyLinesUp");a.setAction("copyLinesUp",
function(){return this.copyLinesUp()}.bind(this),{name:k.copyLinesUp});a.setKeyBinding(new m.KeyBinding(40,!0,!1,!0),"copyLinesDown");a.setAction("copyLinesDown",function(){return this.copyLinesDown()}.bind(this),{name:k.copyLinesDown});a.setKeyBinding(new m.KeyBinding("d",!0,!1,!1),"deleteLines");a.setAction("deleteLines",function(a){return this.deleteLines(a)}.bind(this),{name:k.deleteLines});a.setKeyBinding(new m.KeyBinding("l",!f.isMac,!1,!1,f.isMac),"gotoLine");a.setAction("gotoLine",function(){return this.gotoLine()}.bind(this),
{name:k.gotoLine});a.setKeyBinding(new m.KeyBinding(190,!0),"nextAnnotation");a.setAction("nextAnnotation",function(){return this.nextAnnotation(!0)}.bind(this),{name:k.nextAnnotation});a.setKeyBinding(new m.KeyBinding(188,!0),"previousAnnotation");a.setAction("previousAnnotation",function(){return this.nextAnnotation(!1)}.bind(this),{name:k.prevAnnotation});a.setKeyBinding(new m.KeyBinding("e",!0,!1,!0,!1),"expand");a.setAction("expand",function(){return this.expandAnnotation(!0)}.bind(this),{name:k.expand});
a.setKeyBinding(new m.KeyBinding("c",!0,!1,!0,!1),"collapse");a.setAction("collapse",function(){return this.expandAnnotation(!1)}.bind(this),{name:k.collapse});a.setKeyBinding(new m.KeyBinding("e",!0,!0,!0,!1),"expandAll");a.setAction("expandAll",function(){return this.expandAnnotations(!0)}.bind(this),{name:k.expandAll});a.setKeyBinding(new m.KeyBinding("c",!0,!0,!0,!1),"collapseAll");a.setAction("collapseAll",function(){return this.expandAnnotations(!1)}.bind(this),{name:k.collapseAll});a.setKeyBinding(new m.KeyBinding("q",
!f.isMac,!1,!1,f.isMac),"lastEdit");a.setAction("lastEdit",function(){return this.gotoLastEdit()}.bind(this),{name:k.lastEdit})},copyLinesDown:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();n(this,!1,function(a,c){var d=b.getLineAtOffset(a.start),e=b.getLineAtOffset(a.end>a.start?a.end-1:a.end),h=b.getLineStart(d),d=b.getLineEnd(e,!0),f=b.getLineCount(),g="",h=b.getText(h,d);e===f-1&&(h=(g=b.getLineDelimiter())+h);c(h,d,d);a.start=d+g.length;a.end=
d+h.length});return!0},copyLinesUp:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();n(this,!1,function(a,c){var d=b.getLineAtOffset(a.start),e=b.getLineAtOffset(a.end>a.start?a.end-1:a.end),d=b.getLineStart(d),h=b.getLineEnd(e,!0),f=b.getLineCount(),g="",h=b.getText(d,h);e===f-1&&(h+=g=b.getLineDelimiter());c(h,d,d);a.start=d;a.end=d+h.length-g.length});return!0},deleteLines:function(a){var b=this.editor;if(b.getTextView().getOptions("readonly"))return!1;
var c=1;a&&a.count&&(c=a.count);var d=b.getModel();n(this,!1,function(a,b){var e=d.getLineAtOffset(a.start),h=d.getLineStart(e),e=a.start!==a.end||1===c?d.getLineAtOffset(a.end>a.start?a.end-1:a.end):Math.min(e+c-1,d.getLineCount()-1),e=d.getLineEnd(e,!0);b("",h,e);a.start=a.end=h});return!0},expandAnnotation:function(a){var b=this.editor,c=b.getAnnotationModel();if(!c)return!0;var d=b.getModel(),f=b.getCaretOffset(),g=d.getLineAtOffset(f),f=d.getLineStart(g),g=d.getLineEnd(g,!0);d.getBaseModel&&
(f=d.mapOffset(f),g=d.mapOffset(g),d.getBaseModel());for(var l,c=c.getAnnotations(f,g);!l&&c.hasNext();)d=c.next(),d.type===e.AnnotationType.ANNOTATION_FOLDING&&(l=d);l&&a!==l.expanded&&(a?l.expand():(b.setCaretOffset(l.start),l.collapse()));return!0},expandAnnotations:function(a){var b=this.editor,c=b.getTextView(),b=b.getAnnotationModel();if(!b)return!0;var d=b.getAnnotations();for(c.setRedraw(!1);d.hasNext();)b=d.next(),b.type===e.AnnotationType.ANNOTATION_FOLDING&&a!==b.expanded&&(a?b.expand():
b.collapse());c.setRedraw(!0);return!0},indentLines:function(){var a=this.editor,b=a.getTextView();if(b.getOptions("readonly"))return!1;if(b.getOptions("tabMode")){var c=a.getModel(),d=0,e=a.getSelections();1<e.length&&this.startUndo();if(e.some(function(f){f.start+=d;f.end+=d;var g=c.getLineAtOffset(f.start),l=c.getLineAtOffset(f.end>f.start?f.end-1:f.end);if(g!==l||1<e.length){var k=[];k.push("");for(var n=g;n<=l;n++)k.push(c.getLine(n,!0));var n=c.getLineStart(g),m=c.getLineEnd(l,!0),q=b.getOptions("tabSize",
"expandTab"),q=q.expandTab?Array(q.tabSize+1).join(" "):"\t",k=k.join(q);a.setText(k,n,m);var s=n===f.start?f.start:f.start+q.length,g=f.end+(l-g+1)*q.length;d+=n-m+k.length;f.start=s;f.end=g}else return!0;return!1}))return!1;a.setSelections(e);1<e.length&&this.endUndo();return!0}},gotoLastEdit:function(){"number"===typeof this._lastEditLocation&&this.editor.showSelection(this._lastEditLocation);return!0},gotoLine:function(){var a=this.editor,b=a.getModel().getLineAtOffset(a.getCaretOffset());if(b=
prompt(k.gotoLinePrompty,b+1))b=parseInt(b,10),a.onGotoLine(b-1,0);return!0},moveLinesDown:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();n(this,!0,function(a,c){var d=b.getLineAtOffset(a.start),e=b.getLineAtOffset(a.end>a.start?a.end-1:a.end),h=b.getLineCount();if(e!==h-1){var d=b.getLineStart(d),f=b.getLineEnd(e,!0),g=b.getLineEnd(e+1,!0)-(f-d),l=0;e!==h-2?e=b.getText(d,f):(h=b.getLineEnd(e),e=b.getText(h,f)+b.getText(d,h),l+=f-h);c("",d,f);c(e,
g,g);a.start=g+l;a.end=g+l+e.length}});return!0},moveLinesUp:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();n(this,!0,function(a,c){var d=b.getLineAtOffset(a.start);if(0!==d){var e=b.getLineAtOffset(a.end>a.start?a.end-1:a.end),h=b.getLineCount(),f=b.getLineStart(d-1),g=b.getLineStart(d),l=b.getLineEnd(e,!0),k=b.getText(g,l),n=0;e===h-1&&(e=b.getLineEnd(d-1),d=b.getLineEnd(d-1,!0),k+=b.getText(e,d),g=e,n=d-e);c("",g,l);c(k,f,f);a.start=f;a.end=f+
k.length-n}});return!0},nextAnnotation:function(b){function d(b){return!!b.lineStyle||b.type===a.ANNOTATION_MATCHING_BRACKET||b.type===a.ANNOTATION_CURRENT_BRACKET||!g.isAnnotationTypeVisible(b.type)}var e=this.editor,f=e.getAnnotationModel();if(!f)return!0;var g=e.getOverviewRuler()||e.getAnnotationStyler();if(!g)return!0;for(var l=e.getModel(),k=e.getCaretOffset(),n=f.getAnnotations(b?k:0,b?l.getCharCount():k),m=null;n.hasNext();){var q=n.next();if(b){if(q.start<=k)continue}else if(q.start>=k)continue;
if(!d(q)&&(m=q,b))break}if(m){for(var E=[m],n=f.getAnnotations(m.start,m.start);n.hasNext();)q=n.next(),q!==m&&!d(q)&&E.push(q);var B=e.getTextView(),s=l.getLineAtOffset(m.start),x=c.Tooltip.getTooltip(B);if(!x)return e.moveSelection(m.start),!0;e.moveSelection(m.start,m.start,function(){x.setTarget({getTooltipInfo:function(){var a=B.convert({x:B.getLocationAtOffset(m.start).x,y:B.getLocationAtOffset(l.getLineStart(s)).y},"document","page");return{contents:E,x:a.x,y:a.y+Math.floor(1.33*B.getLineHeight(s))}}},
0)})}return!0},unindentLines:function(){var a=this.editor,b=a.getTextView();if(b.getOptions("readonly"))return!1;if(b.getOptions("tabMode")){var c=a.getModel();n(this,!1,function(a,d){for(var e=c.getLineAtOffset(a.start),h=c.getLineAtOffset(a.end>a.start?a.end-1:a.end),f=b.getOptions("tabSize"),g=Array(f+1).join(" "),l=[],k=0,n=0,m=e;m<=h;m++){var q=c.getLine(m,!0);if(c.getLineStart(m)!==c.getLineEnd(m))if(0===q.indexOf("\t"))q=q.substring(1),k++;else if(0===q.indexOf(g))q=q.substring(f),k+=f;else return!0;
m===e&&(n=k);l.push(q)}e=c.getLineStart(e);f=c.getLineEnd(h,!0);h=c.getLineStart(h);l=l.join("");d(l,e,f);n=e===a.start?a.start:a.start-n;k=Math.max(n,a.end-k+(a.end===h+1&&a.start!==a.end?1:0));a.start=n;a.end=k});return!0}},startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()}};q.TextActions=l;b.prototype={init:function(){var a=this.editor.getTextView();a.setAction("lineStart",function(){return this.lineStart()}.bind(this));
a.setAction("enter",function(){return this.autoIndent()}.bind(this));a.setKeyBinding(new m.KeyBinding("t",!0,!1,!0),"trimTrailingWhitespaces");a.setAction("trimTrailingWhitespaces",function(){return this.trimTrailingWhitespaces()}.bind(this),{name:k.trimTrailingWhitespaces});a.setKeyBinding(new m.KeyBinding(191,!0),"toggleLineComment");a.setAction("toggleLineComment",function(){return this.toggleLineComment()}.bind(this),{name:k.toggleLineComment});a.setKeyBinding(new m.KeyBinding(191,!0,!f.isMac,
!1,f.isMac),"addBlockComment");a.setAction("addBlockComment",function(){return this.addBlockComment()}.bind(this),{name:k.addBlockComment});a.setKeyBinding(new m.KeyBinding(220,!0,!f.isMac,!1,f.isMac),"removeBlockComment");a.setAction("removeBlockComment",function(){return this.removeBlockComment()}.bind(this),{name:k.removeBlockComment});a.setKeyBinding(new m.KeyBinding("[",!1,!1,!1,!1,"keypress"),"autoPairSquareBracket");a.setAction("autoPairSquareBracket",function(){return this.autoPairBrackets("[",
"]")}.bind(this));a.setKeyBinding(new m.KeyBinding("]",!1,!1,!1,!1,"keypress"),"skipClosingSquareBracket");a.setAction("skipClosingSquareBracket",function(){return this.skipClosingBracket("]")}.bind(this));a.setKeyBinding(new m.KeyBinding("\x3c",!1,!1,!1,!1,"keypress"),"autoPairAngleBracket");a.setAction("autoPairAngleBracket",function(){return this.autoPairBrackets("\x3c","\x3e")}.bind(this));a.setKeyBinding(new m.KeyBinding("\x3e",!1,!1,!1,!1,"keypress"),"skipClosingAngleBracket");a.setAction("skipClosingAngleBracket",
function(){return this.skipClosingBracket("\x3e")}.bind(this));a.setKeyBinding(new m.KeyBinding("(",!1,!1,!1,!1,"keypress"),"autoPairParentheses");a.setAction("autoPairParentheses",function(){return this.autoPairBrackets("(",")")}.bind(this));a.setKeyBinding(new m.KeyBinding(")",!1,!1,!1,!1,"keypress"),"skipClosingParenthesis");a.setAction("skipClosingParenthesis",function(){return this.skipClosingBracket(")")}.bind(this));a.setKeyBinding(new m.KeyBinding("{",!1,!1,!1,!1,"keypress"),"autoPairBraces");
a.setAction("autoPairBraces",function(){return this.autoPairBrackets("{","}")}.bind(this));a.setKeyBinding(new m.KeyBinding("}",!1,!1,!1,!1,"keypress"),"skipClosingBrace");a.setAction("skipClosingBrace",function(){return this.skipClosingBracket("}")}.bind(this));a.setKeyBinding(new m.KeyBinding("'",!1,!1,!1,!1,"keypress"),"autoPairSingleQuotation");a.setAction("autoPairSingleQuotation",function(){return this.autoPairQuotations("'")}.bind(this));a.setKeyBinding(new m.KeyBinding('"',!1,!1,!1,!1,"keypress"),
"autoPairDblQuotation");a.setAction("autoPairDblQuotation",function(){return this.autoPairQuotations('"')}.bind(this));a.setAction("deletePrevious",function(){return this.deletePrevious()}.bind(this))},autoIndent:function(){function a(b,c){if(b.start===b.end){for(var h=d.getLineAtOffset(b.start),p=d.getLine(h,!1),n=d.getLineStart(h),r=0,q=b.start-n,F;r<q&&(32===(F=p.charCodeAt(r))||9===F);)r++;var n=p.substring(0,r),K=p.substring(0,q),H=p.substring(q),L;if(m.smartIndentation&&123===p.charCodeAt(L=
K.trimRight().length-1))return h=q-L-1,H=H.length-H.trimLeft().length,p=125===p.charCodeAt(q+H)?f+n+e+f+n:f+n+e,c(p,b.start-h,b.end+H),b.start=b.end=b.start+f.length+n.length+e.length-h,!0;if(m.autoCompleteComments&&!k.test(K)&&(g.test(K)||l.test(K))){if(r=g.exec(K)){p=f+n+" * ";p=k.test(H)?p+H.substring(0,H.length-2).trim():p+H.trim();if(d.getLineCount()===h+1||!l.test(d.getLine(h+1)))p+=f+n+" */";c(p,b.start,b.end+H.length);b.start=b.end=b.start+f.length+n.length+3;return!0}if(r=l.exec(K))for(h-=
1;0<=h;h--){r=d.getLine(h,!1);if(g.test(r))return k.test(H)||47===p.charCodeAt(q)?(p=f+n+"*"+H,n=b.start+f.length+n.length+1):(p=f+n+"* "+H,n=b.start+f.length+n.length+2),c(p,b.start,b.end+H.length),b.start=b.end=n,!0;if(!l.test(r))break}}else{if(k.test(K)&&32===n.charCodeAt(n.length-1))return p=f+n.substring(0,n.length-1),c(p,b.start,b.end),b.start=b.end=b.start+p.length,!0;if(0<r){for(r=q;r<p.length&&(32===(F=p.charCodeAt(r++))||9===F);)b.end++;p=d.getLineDelimiter()+n;c(p,b.start,b.end);b.start=
b.end=b.start+p.length;return!0}}}return!1}var b=this.editor,c=b.getTextView();if(c.getOptions("readonly")||c.getOptions("singleMode"))return!1;var d=b.getModel(),b=c.getOptions("tabSize","expandTab"),e=b.expandTab?Array(b.tabSize+1).join(" "):"\t",f=d.getLineDelimiter(),g=/^[\s]*\/\*[\*]*[\s]*$/,l=/^[\s]*\*/,k=/\*\/[\s]*$/,m=this;n(this,!0,function(b,c){a(b,c)||(c(f,b.start,b.end),b.start=b.end=b.start+f.length)});return!0},addBlockComment:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;
var b=a.getModel(),c=/\/\*|\*\//g,d=this;n(this,!1,function(a,e){var h=d._findEnclosingComment(b,a.start,a.end);if(!(void 0!==h.commentStart&&void 0!==h.commentEnd)&&(h=b.getText(a.start,a.end),0!==h.length)){var f=h.length,h=h.replace(c,""),g=h.length;e("/*"+h+"*/",a.start,a.end);a.start+=2;a.end+=2+(g-f)}});return!0},autoPairBrackets:function(a,b){if("["===a&&!this.autoPairSquareBrackets||"{"===a&&!this.autoPairBraces||"("===a&&!this.autoPairParentheses||"\x3c"===a&&!this.autoPairAngleBrackets)return!1;
var c=this.editor;if(c.getTextView().getOptions("readonly"))return!1;var d=/^$|[)}\]>]/,e=c.getModel();n(this,!1,function(c,f){var g=c.start===e.getCharCount()?"":e.getText(c.start,c.start+1).trim();c.start===c.end&&d.test(g)?(g=a+b,f(g,c.start,c.start),c.start=c.end=c.start+1):c.start!==c.end?(g=a+e.getText(c.start,c.end)+b,f(g,c.start,c.end),c.start+=1,c.end+=1):(f(a,c.start,c.end),c.start=c.end=c.start+a.length)});return!0},autoPairQuotations:function(a){if(!this.autoPairQuotation)return!1;var b=
this.editor;if(b.getTextView().getOptions("readonly"))return!1;var c=/^"$|^'$/,d=/\w/,e=/^$|[)}\]>]/,f=b.getModel();n(this,!1,function(b,g){function l(){g(a,b.start,b.end);b.start=b.end=b.start+a.length}var k=0===b.start?"":f.getText(b.start-1,b.start).trim(),p=b.start===f.getCharCount()?"":f.getText(b.start,b.start+1).trim();b.start!==b.end?(k=f.getText(b.start,b.end),c.test(k)?l():(g(a+k+a,b.start,b.end),b.start+=1,b.end+=1)):p===a?b.start=b.end=b.start+1:k===a||c.test(p)||d.test(k)||!e.test(p)?
l():(g(a+a,b.start,b.end),b.start=b.end=b.start+a.length)});return!0},contentAssistProposalApplied:function(a){function b(){return"number"===typeof c.escapePosition?c.escapePosition:a.data.start+c.proposal.length}var c=a.data.proposal;if(c.positions&&0<c.positions.length&&this.linkedMode){for(var d=[],e=0;e<c.positions.length;++e)d[e]={positions:[{offset:c.positions[e].offset,length:c.positions[e].length}]};this.linkedMode.enterLinkedMode({groups:d,escapePosition:b()})}else c.groups&&0<c.groups.length&&
this.linkedMode?this.linkedMode.enterLinkedMode({groups:c.groups,escapePosition:b()}):"number"===typeof c.escapePosition&&this.editor.getTextView().setCaretOffset(c.escapePosition);return!0},deletePrevious:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel();n(this,!1,function(a,c){if(a.start===a.end){var d=0===a.start?"":b.getText(a.start-1,a.start),e=a.start===b.getCharCount()?"":b.getText(a.start,a.start+1);("("===d&&")"===e||"["===d&&"]"===e||"{"===
d&&"}"===e||"\x3c"===d&&"\x3e"===e||'"'===d&&'"'===e||"'"===d&&"'"===e)&&c("",a.start,a.start+1)}},!0);return!1},_findEnclosingComment:function(a,b,c){var d=a.getLineAtOffset(b),e=a.getLineAtOffset(c),f,g,l,k,n,m;for(f=d;0<=f&&!(g=a.getLine(f),l=f===d?b-a.getLineStart(d):g.length,k=g.lastIndexOf("/*",l),g=g.lastIndexOf("*/",l),g>k);f--)if(-1!==k){n=a.getLineStart(f)+k;break}for(f=e;f<a.getLineCount()&&!(g=a.getLine(f),l=f===e?c-a.getLineStart(e):0,k=g.indexOf("/*",l),g=g.indexOf("*/",l),-1!==k&&k<
g);f++)if(-1!==g){m=a.getLineStart(f)+g;break}return{commentStart:n,commentEnd:m}},lineStart:function(){var a=this.editor.getModel();n(this,!1,function(b){var c=b.getCaret(),d=a.getLineAtOffset(c),e=a.getLineStart(d),d=a.getLine(d),f;for(f=0;f<d.length;f++){var g=d.charCodeAt(f);if(!(32===g||9===g))break}f+=e;c!==f?b.setCaret(f):b.setCaret(e)});return!0},removeBlockComment:function(){var a=this.editor;if(a.getTextView().getOptions("readonly"))return!1;var b=a.getModel(),c=this;n(this,!1,function(a,
d){var e=b.getText(a.start,a.end),f,h,g;for(g=0;g<e.length;g++)if("/*"===e.substring(g,g+2)){f=a.start+g;break}for(;g<e.length;g++)if("*/"===e.substring(g,g+2)){h=a.start+g;break}void 0!==f&&void 0!==h?(e=b.getText(f+2,h),d(e,f,h+2),a.start=f,a.end=h):(f=c._findEnclosingComment(b,a.start,a.end),void 0===f.commentStart||void 0===f.commentEnd||(e=b.getText(f.commentStart+2,f.commentEnd),d(e,f.commentStart,f.commentEnd+2),a.start-=2,a.end-=2))});return!0},toggleLineComment:function(){var a=this.editor,
b=a.getTextView();if(b.getOptions("readonly"))return!1;var c=this.lineComment||"//",d=a.getModel();b.setRedraw(!1);n(this,!0,function(a,b){for(var e=d.getLineAtOffset(a.start),f=d.getLineAtOffset(a.end>a.start?a.end-1:a.end),h=!0,g=[],l,k=e;k<=f;k++){var p=d.getLine(k,!0);l=p.indexOf(c);g.push(l);if(!h||-1===l)h=!1;else if(0!==l){for(h=0;h<l;h++){var n=p.charCodeAt(h);if(!(32===n||9===n))break}h=h===l}}k=c.length;p=d.getLineStart(e);if(h){for(h=g.length-1;0<=h;h--)l=g[h]+d.getLineStart(e+h),b("",
l,l+k);l=d.getLineStart(f);g=p===a.start?a.start:a.start-k;e=a.end-k*(f-e+1)+(a.end===l+1?k:0)}else{for(h=g.length-1;0<=h;h--)l=d.getLineStart(e+h),b(c,l,l);g=p===a.start?a.start:a.start+k;e=a.end+k*(f-e+1)}a.start=g;a.end=e});b.setRedraw(!0);return!0},trimTrailingWhitespaces:function(){var a=this.editor,b=a.getModel(),c=a.getSelections();a.getTextView().setRedraw(!1);this.startUndo();for(var d=/(\s+$)/,e=b.getLineCount(),f=0;f<e;f++){var g=b.getLine(f);if(g=d.exec(g)){var l=b.getLineStart(f),k=g[0].length,
n=l+g.index;b.setText("",n,n+k);c.forEach(function(a){a.start>n&&(a.start=Math.max(n,a.start-k));a.start!==a.end&&a.end>n&&(a.end=Math.max(n,a.end-k))})}}this.endUndo();a.setSelections(c,!1);a.getTextView().setRedraw(!0)},startUndo:function(){this.undoStack&&this.undoStack.startCompoundChange()},skipClosingBracket:function(a){var b=this.editor;if(b.getTextView().getOptions("readonly"))return!1;var c=b.getModel(),d=b.getSelections();return 1===d.length&&d[0].start===d[0].end&&(d[0].start===c.getCharCount()?
"":c.getText(d[0].start,d[0].start+1))===a?(d[0].start=d[0].end=d[0].start+1,b.setSelections(d),!0):!1},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()},setAutoPairParentheses:function(a){this.autoPairParentheses=a},setAutoPairBraces:function(a){this.autoPairBraces=a},setAutoPairSquareBrackets:function(a){this.autoPairSquareBrackets=a},setAutoPairAngleBrackets:function(a){this.autoPairAngleBrackets=a},setAutoPairQuotations:function(a){this.autoPairQuotation=a},setAutoCompleteComments:function(a){this.autoCompleteComments=
a},setLineComment:function(a){this.lineComment=a},setSmartIndentation:function(a){this.smartIndentation=a}};q.SourceCodeActions=b;String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/g,"")});String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/g,"")});return q});
define("orion/editor/undoStack",[],function(){function k(c,e,d,f,k){this.model=c;this.offset=e;this.text=d;this.previousText=f;this.type=k}function m(c){this.owner=c;this.changes=[]}function e(c,e){this.size=void 0!==e?e:100;this.reset();var d=this;this._listener={onChanging:function(c){d._onChanging(c)},onDestroy:function(c){d._onDestroy(c)}};if(c.getModel){var f=c.getModel();f.getBaseModel&&(f=f.getBaseModel());this.model=f;this.setView(c)}else this.shared=!0,this.model=c;this.model.addEventListener("Changing",
this._listener.onChanging)}k.prototype={getRedoChanges:function(){return[{start:this.offset,end:this.offset+this.previousText.length,text:this.text}]},getUndoChanges:function(){return[{start:this.offset,end:this.offset+this.text.length,text:this.previousText}]},undo:function(c,e){this._doUndoRedo(this.offset,this.previousText,this.text,c,e);return!0},redo:function(c,e){this._doUndoRedo(this.offset,this.text,this.previousText,c,e);return!0},merge:function(c,e,d,f,k){if(f===this.type){if(1===f&&c===
this.offset+this.text.length)return this.text+=e,!0;if(-1===f&&k===this.offset)return this.offset=c,this.previousText=d+this.previousText,!0;if(-1===f&&c===this.offset)return this.previousText+=d,!0}return!1},_doUndoRedo:function(c,e,d,f,k){this.model.setText(e,c,c+d.length);k&&f&&(d=f.getModel(),d!==this.model&&(c=d.mapOffset(c,!0)),f.setSelection(c,c+e.length))}};m.prototype={getRedoChanges:function(){for(var c=[],e=0;e<this.changes.length;e++)c=c.concat(this.changes[e].getRedoChanges());return c},
getUndoChanges:function(){for(var c=[],e=this.changes.length-1;0<=e;e--)c=c.concat(this.changes[e].getUndoChanges());return c},add:function(c){this.changes.push(c)},end:function(c){c&&(this.endSelection=c.getSelections());(c=this.owner)&&c.end&&c.end()},undo:function(c,e){1<this.changes.length&&c&&c.setRedraw(!1);for(var d=this.changes.length-1;0<=d;d--)this.changes[d].undo(c,!1);e&&c&&c.setSelections(this.startSelection);1<this.changes.length&&c&&c.setRedraw(!0);(d=this.owner)&&d.undo&&d.undo();
return 0<this.changes.length},redo:function(c,e){1<this.changes.length&&c&&c.setRedraw(!1);for(var d=0;d<this.changes.length;d++)this.changes[d].redo(c,!1);e&&c&&c.setSelections(this.endSelection);(1<this.changes.length,c)&&c.setRedraw(!0);(d=this.owner)&&d.redo&&d.redo();return 0<this.changes.length},merge:function(c,e,d,f,k,l){var b=this.changes.length;return 0<b&&this===l?this.changes[b-1].merge(c,e,d,f,k):!1},start:function(c){c&&(this.startSelection=c.getSelections());(c=this.owner)&&c.start&&
c.start()}};e.prototype={destroy:function(){this._onDestroy()},add:function(c){this.compoundChange?this.compoundChange.add(c):(this.stack.splice(this.index,this.stack.length-this.index,c),this.index++,this.stack.length>this.size&&(this.stack.shift(),this.index--))},markClean:function(){this._commitUndo();if(this.cleanChange=this.stack[this.index-1])this.cleanChange.type=2},isClean:function(){return this.cleanChange===this.stack[this.index-1]},canUndo:function(){return 0<this.index},canRedo:function(){return 0<
this.stack.length-this.index},endCompoundChange:function(){this.compoundChange&&this.compoundChange.end(this.view);this.compoundChange=void 0},getSize:function(){return{undo:this.index,redo:this.stack.length-this.index}},getRedoChanges:function(){this._commitUndo();for(var c=[],e=this.index;e<this.stack.length;e++)c=c.concat(this.stack[e].getRedoChanges());return c},getUndoChanges:function(){this._commitUndo();for(var c=[],e=this.index;0<=e;e--)c=c.concat(this.stack[e].getUndoChanges());return c},
undo:function(){this._commitUndo();var c;c=!1;this._ignoreUndo=!0;do{if(0>=this.index)break;c=this.stack[--this.index]}while(!(c=c.undo(this.view,!0)));this._ignoreUndo=!1;return c},redo:function(){this._commitUndo();var c;c=!1;this._ignoreUndo=!0;do{if(this.index>=this.stack.length)break;c=this.stack[this.index++]}while(!(c=c.redo(this.view,!0)));this._ignoreUndo=!1;return c},reset:function(){this.index=0;this.cleanChange=void 0;this.stack=[];this._ignoreUndo=!1;this._compoundChange=void 0},setView:function(c){this.view!==
c&&(this.view&&c.removeEventListener("Destroy",this._listener.onDestroy),(this.view=c)&&c.addEventListener("Destroy",this._listener.onDestroy))},startCompoundChange:function(c){this._commitUndo();c=new m(c);this.add(c);this.compoundChange=c;this.compoundChange.start(this.view);return this.compoundChange},_commitUndo:function(){this.endCompoundChange()},_onDestroy:function(c){(!c||!this.shared)&&this.model.removeEventListener("Changing",this._listener.onChanging);this.view&&(this.view.removeEventListener("Destroy",
this._listener.onDestroy),this.view=null)},_trackUnsavedChanges:function(c){if(this._unsavedChanges){var e=this._unsavedChanges.length,d=c.removedCharCount,f=c.start,k=c.start+d,l=0;0===c.addedCharCount?l=-1:0===d&&(l=1);if(0<e&&l===this._previousChangeType){e=this._unsavedChanges[e-1];if(0===d&&f===e.end+e.text.length){e.text+=c.text;return}if(0===c.addedCharCount&&k===e.start){e.start=f;return}}this._previousChangeType=l;this._unsavedChanges.push({start:f,end:k,text:c.text})}},_onChanging:function(c){this._trackUnsavedChanges(c);
if(!this._ignoreUndo){var e=c.text,d=c.start,f=c.addedCharCount,n=c.removedCharCount;c=d+n;var l=0;0===f&&1===n?l=-1:1===f&&0===n&&(l=1);f=this.stack.length;n=this.model.getText(d,c);(!(0<f&&this.index===f)||!this.stack[f-1].merge(d,e,n,l,c,this.compoundChange))&&this.add(new k(this.model,d,e,n,l))}}};return{UndoStack:e}});
define("orion/editor/rulers","i18n!orion/editor/nls/messages orion/editor/textView orion/editor/annotations orion/editor/tooltip orion/objects orion/editor/util orion/util".split(" "),function(k,m,e,c,g,d,f){function n(a,b,c){this._location=a||"left";this._overview=b||"page";this._rulerStyle=c;this._view=null}function l(a,b,c,d){n.call(this,b,c,d);var e=this;this._listener={onTextModelChanged:function(a){e._onTextModelChanged(a)},onAnnotationModelChanged:function(a){e._onAnnotationModelChanged(a)}};
this.setAnnotationModel(a)}function b(a,b,c,d,e){l.call(this,a,b,"page",c);this._oddStyle=d||{style:{backgroundColor:"white"}};this._evenStyle=e||{style:{backgroundColor:"white"}};this._numOfDigits=0;this._firstLine=1}function a(a,b,c){l.call(this,a,b,"page",c)}function q(a,b,c){l.call(this,a,b,"document",c)}function h(b,c,d){a.call(this,b,c,d)}n.prototype={getLocation:function(){return this._location},getOverview:function(){return this._overview},getRulerStyle:function(){return this._rulerStyle},
getView:function(){return this._view},setView:function(a){this._onTextModelChanged&&this._view&&this._view.removeEventListener("ModelChanged",this._listener.onTextModelChanged);this._view=a;this._onTextModelChanged&&this._view&&this._view.addEventListener("ModelChanged",this._listener.onTextModelChanged)}};l.prototype=g.mixin(new n,{getAnnotations:function(a,b){var c=this._annotationModel;if(!c)return[];var d=this._view.getModel(),e=d.getLineStart(a),f=d.getLineEnd(b-1),h=d;d.getBaseModel&&(h=d.getBaseModel(),
e=d.mapOffset(e),f=d.mapOffset(f));for(var g=[],c=this.getAnnotationsByType(c,e,f),e=0;e<c.length;e++)for(var f=c[e],l=h.getLineAtOffset(f.start),k=h.getLineAtOffset(Math.max(f.start,f.end-1)),n=l;n<=k;n++){var m=n;if(d!==h){m=h.getLineStart(n);m=d.mapOffset(m,!0);if(-1===m)continue;m=d.getLineAtOffset(m)}if(a<=m&&m<b){var q=this._mergeAnnotation(g[m],f,n-l,k-l+1);q&&(g[m]=q)}}if(!this._multiAnnotation&&this._multiAnnotationOverlay)for(var y in g)g[y]._multiple&&(g[y].html+=this._multiAnnotationOverlay.html);
return g},getAnnotationModel:function(){return this._annotationModel},getWidestAnnotation:function(){return null},setAnnotationModel:function(a){this._annotationModel&&this._annotationModel.removEventListener("Changed",this._listener.onAnnotationModelChanged);(this._annotationModel=a)&&this._annotationModel.addEventListener("Changed",this._listener.onAnnotationModelChanged)},setMultiAnnotation:function(a){this._multiAnnotation=a},setMultiAnnotationOverlay:function(a){this._multiAnnotationOverlay=
a},onClick:function(a,b){if(void 0!==a){var d=this._view,e=d.getModel(),f=e.getLineStart(a),h=e.getLineEnd(a,!0),g=d.getSelection().start,d=d.getSelection().end,l=this._annotationModel,k,n,m;if(l){e.getBaseModel&&(f=e.mapOffset(f),h=e.mapOffset(h),g=e.mapOffset(g),d=e.mapOffset(d));var q=this;n=(k=this._findNextAnnotation(l,f,h,g,d,function(a){return q.isAnnotationTypeVisible(a)}))?k.start:f;m=k?k.end:f;e.getBaseModel&&(n=e.mapOffset(n,!0),m=e.mapOffset(m,!0));k&&void 0!==k.groupId&&(this._currentClickGroup=
this._currentClickGroup===k.groupId?null:k.groupId,this._setCurrentGroup(a))}this._view.setSelection(m,n,1/3,function(){});(e=c.Tooltip.getTooltip(this._view))&&(k&&"left"===this.getLocation()?e.show({getTooltipInfo:function(){return q._getTooltipInfo([k])}},!1,!1):e.hide())}},onDblClick:function(a,b){},onMouseMove:function(a,b){var d=c.Tooltip.getTooltip(this._view);if(d&&!(d.isVisible()&&this._tooltipLineIndex===a)&&(this._tooltipLineIndex=a,!(b.clientX===this._lastMouseX&&b.clientY===this._lastMouseY))){this._lastMouseX=
b.clientX;this._lastMouseY=b.clientY;this._hoverTimeout&&(window.clearTimeout(this._hoverTimeout),this._hoverTimeout=null);var e=b.target?b.target:b.srcElement;this._curElementBounds=e.getBoundingClientRect();e._ruler&&(this._curElementBounds.top=b.clientY,this._curElementBounds.height=1);var f=this;f._hoverTimeout=window.setTimeout(function(){f._hoverTimeout=null;d.onHover({getTooltipInfo:function(){var a=f._getAnnotationsAtLineIndex(f._tooltipLineIndex),a=f._getTooltipContents(f._tooltipLineIndex,
a);return f._getTooltipInfo(a,b.clientY,{source:"ruler",rulerLocation:f.getLocation()})}},b.clientX,b.clientY)},175)}},onMouseOver:function(a,b){this.onMouseMove(a,b);this._currentClickGroup||this._setCurrentGroup(a)},onMouseOut:function(a,b){this._currentClickGroup||this._setCurrentGroup(-1);this._hoverTimeout&&(window.clearTimeout(this._hoverTimeout),this._hoverTimeout=null)},_findNextAnnotation:function(a,b,c,d,e,f){var h=null,g,l=b;if(0<=d&&0<=e&&d>=b&&d<c)for(var l=d,k=a.getAnnotations(d,e);!g&&
k.hasNext();)if(b=k.next(),!f||f(b.type))b.start===d&&b.end===e&&(g=b);a=a.getAnnotations(l,c);for(var n;a.hasNext();)if(b=a.next(),!f||f(b.type)){h||(h=b);if(!g){h=b;break}if(n&&(g.start!==b.start||g.end!==b.end)){n=!1;h=b;break}g&&g===b&&(n=!0)}n&&(h=null);return h},_getAnnotationsAtLineIndex:function(a){if(void 0!==a){var b=this._view.getModel(),c=this._annotationModel,d=[];c&&(d=b.getLineStart(a),a=b.getLineEnd(a),b.getBaseModel&&(d=b.mapOffset(d),a=b.mapOffset(a)),d=this.getAnnotationsByType(c,
d,a));return d}},_getTooltipInfo:function(a,b,c){if(!a)return null;var d=Object.create(null);d.top=this._curElementBounds.top;d.left=this._curElementBounds.left;d.height=this._curElementBounds.height;d.width=this._curElementBounds.width;"string"===typeof a&&b&&(d.top=b,d.height=1);var e=this.getLocation();b=this.getRulerStyle();var e="left"===e?"right":"left",f=0,h=0,f=this._view._clientDiv.getBoundingClientRect().left-(d.left+d.width),h=d.height;"left"===e&&(f=-25,1===d.height&&(f+=2));0<=b.styleClass.indexOf("folding")&&
(h-=14);return{contents:a,position:e,tooltipOffsetX:f,tooltipOffsetY:h,anchorArea:d,context:c}},_getTooltipContents:function(a,b){return b},_getOnClickTooltipInfo:function(a){var b=this._view,c=Object.create(null);c.top=this._curElementBounds.top;c.left=this._curElementBounds.left;c.height=this._curElementBounds.height;c.width=this._curElementBounds.width;var d="left"===this.getLocation()?"right":"left";a={contents:[a],position:d,anchorArea:c};b=b._clientDiv.getBoundingClientRect();a.offsetX=b.left-
(c.left+c.width);a.offsetY=c.height;"left"===a.position&&(a.offsetX=20);return a},_onAnnotationModelChanged:function(a){function b(a){for(var f=0;f<a.length;f++)if(e.isAnnotationTypeVisible(a[f].type)){h=a[f].start;var g=a[f].end;d.getBaseModel&&(h=d.mapOffset(h,!0),g=d.mapOffset(g,!0));-1!==h&&-1!==g&&c.redrawLines(d.getLineAtOffset(h),d.getLineAtOffset(Math.max(h,g-1))+1,e)}}var c=this._view;if(c){var d=c.getModel(),e=this,f=d.getLineCount();if(a.textModelChangedEvent){var h=a.textModelChangedEvent.start;
d.getBaseModel&&(h=d.mapOffset(h,!0));a=d.getLineAtOffset(h);c.redrawLines(a,f,e)}else b(a.added),b(a.removed),b(a.changed)}},_mergeAnnotation:function(a,b,c,d){a||(a={});0===c&&(a.html&&b.html?(b.html!==a.html&&(!a._multiple&&this._multiAnnotation)&&(a.html=this._multiAnnotation.html),a._multiple=!0):a.html=b.html);a.style=this._mergeStyle(a.style,b.style);return a},_mergeStyle:function(a,b){if(b){a||(a={});a.styleClass=a.styleClass&&b.styleClass&&a.styleClass!==b.styleClass?a.styleClass+(" "+b.styleClass):
b.styleClass;var c;if(b.style)for(c in a.style||(a.style={}),b.style)void 0===a.style[c]&&(a.style[c]=b.style[c]);if(b.attributes)for(c in a.attributes||(a.attributes={}),b.attributes)void 0===a.attributes[c]&&(a.attributes[c]=b.attributes[c])}return a},_setCurrentGroup:function(a){var b=this._annotationModel,c=null,d=b.getTextModel(),e,f=this._currentGroupAnnotation;if(-1!==a){var h=d.getLineStart(a),g=d.getLineEnd(a);d.getBaseModel&&(h=d.mapOffset(h),g=d.mapOffset(g));for(e=b.getAnnotations(h,g);e.hasNext();)if(d=
e.next(),this.isAnnotationTypeVisible(d.type)&&d.start<=h&&d.end>=g&&void 0!==d.groupId){c=d;break}if(f&&c&&f.groupId===c.groupId)return}this._currentGroupAnnotation=null;f&&b.removeAnnotations(f.groupType);if(c&&-1!==a){this._currentGroupAnnotation=c;e=b.getAnnotations();for(a=[];e.hasNext();)d=e.next(),delete d.groupAnnotation,d.groupId===c.groupId&&(d=d.createGroupAnnotation(),a.push(d));b.replaceAnnotations(null,a)}}});e.AnnotationTypeList.addMixin(l.prototype);b.prototype=new l;b.prototype.getAnnotations=
function(a,b){for(var c=l.prototype.getAnnotations.call(this,a,b),d=this._view.getModel(),e=a;e<b;e++){var f=e-this._firstLine&1?this._oddStyle:this._evenStyle,h=e;d.getBaseModel&&(h=d.getLineStart(h),h=d.getBaseModel().getLineAtOffset(d.mapOffset(h)));c[e]||(c[e]={});c[e].html=this._firstLine+h+"";c[e].style||(c[e].style=f)}return c};b.prototype.getWidestAnnotation=function(){var a=this._view.getModel().getLineCount();return this.getAnnotations(a-1,a)[a-1]};b.prototype.setFirstLine=function(a){this._firstLine=
void 0!==a?a:1};b.prototype._onTextModelChanged=function(a){var b=a.start;a=this._view.getModel();var c=a.getBaseModel?a.getBaseModel().getLineCount():a.getLineCount(),c=(this._firstLine+c-1+"").length;this._numOfDigits!==c&&(this._numOfDigits=c,b=a.getLineAtOffset(b),this._view.redrawLines(b,a.getLineCount(),this))};a.prototype=new l;q.prototype=new l;q.prototype.getRulerStyle=function(){var a={style:{lineHeight:"1px",fontSize:"1px"}};return a=this._mergeStyle(a,this._rulerStyle)};q.prototype._getTooltipContents=
function(a,b){if(b&&0===b.length){var c=this._view.getModel(),d=a;c.getBaseModel&&(d=c.getLineStart(d),d=c.getBaseModel().getLineAtOffset(c.mapOffset(d)));return f.formatMessage(k.line,d+1)}return l.prototype._getTooltipContents.call(this,a,b)};q.prototype._mergeAnnotation=function(a,b,c,d){if(0===c)return a||(a={html:"\x26nbsp;",style:{style:{height:3*d+"px"}}},a.style=this._mergeStyle(a.style,b.overviewStyle)),a};h.prototype=new a;h.prototype.onClick=function(a,b){if(void 0!==a){var d=this._annotationModel;
if(d){var e=this._view.getModel(),f=e.getLineStart(a),h=e.getLineEnd(a,!0);e.getBaseModel&&(f=e.mapOffset(f),h=e.mapOffset(h),e=e.getBaseModel());for(var g,d=d.getAnnotations(f,h);!g&&d.hasNext();)h=d.next(),this.isAnnotationTypeVisible(h.type)&&e.getLineAtOffset(h.start)===e.getLineAtOffset(f)&&(g=h);g&&((e=c.Tooltip.getTooltip(this._view))&&e.hide(),g.expanded?g.collapse():g.expand())}}};h.prototype._getTooltipContents=function(b,c){if(c&&0<c.length){var d=this._view.getModel(),e=d.getLineStart(b);
d.getBaseModel&&(e=d.mapOffset(e),d=d.getBaseModel());for(var e=d.getLineAtOffset(e),f=0;f<c.length;f++){var h=c[f];if(this.isAnnotationTypeVisible(h.type)&&d.getLineAtOffset(h.start)===e){if(c[f].expanded)break;return a.prototype._getTooltipContents.call(this,b,[h])}}}return null};h.prototype._onAnnotationModelChanged=function(b){function c(a){for(h=0;h<a.length;h++)if(f.isAnnotationTypeVisible(a[h].type)){var b=a[h].start;e.getBaseModel&&(b=e.mapOffset(b,!0));-1!==b&&(l=Math.min(l,e.getLineAtOffset(b)))}}
if(b.textModelChangedEvent)a.prototype._onAnnotationModelChanged.call(this,b);else{var d=this._view;if(d){var e=d.getModel(),f=this,h,g=e.getLineCount(),l=g;c(b.added);c(b.removed);c(b.changed);b=d.getRulers();for(h=0;h<b.length;h++)d.redrawLines(l,g,b[h])}}};e=function(a,b){n.call(this,a,"fixed",b)};e.prototype=g.mixin(new n,{setView:function(a){this._destroy();n.prototype.setView.call(this,a);this._create()},_create:function(){function a(b){var c=b.themeClass;c?((c=c.replace("textviewZoom",""))&&
(c=" "+c),c="textviewZoom"+c):c="textviewZoom";b.themeClass=c;b.noScroll=!0;b.readonly=!0;return b}function b(){var a=l._metrics.viewPadding,c=l._metrics.viewPadding,d=l.getLineHeight(),e=n.getLineHeight(),f=l.getModel().getLineCount(),d=l._lineHeight?l._scrollHeight:f*d,e=n._lineHeight?n._scrollHeight:f*e,f=e/d,h=l.getClientArea().height+a.top+a.bottom,c=n.getClientArea().height+c.top+c.bottom;return{zoomFactor:f,documentHeight:d,zoomDocumentHeight:e,clientHeight:h,zoomClientHeight:c,scrollWidth:l._metrics.scrollWidth,
windowHeight:h*f,padding:a}}function c(a){a=a||{y:l.getTopPixel()};var d=b();n.setTopPixel(a.y*(d.zoomFactor+(d.windowHeight-d.clientHeight-d.scrollWidth)/d.documentHeight));a=a.y*d.zoomFactor;d=d.clientHeight*d.zoomFactor;x.top=a;x.bottom=a+d;a=n.convert({y:a},"document","page").y;a-=x.node.getBoundingClientRect().top;B.style.top=a+"px";B.style.height=d-s+"px"}function e(a){a.wrapMode&&!a.wrapOffset&&l._metrics.charWidth?(a=f.createElement(q,"div"),a.style.position="fixed",a.style.left="-1000px",
n._clientDiv.appendChild(a),a.innerHTML=Array(Math.ceil(l.getClientArea().width/l._metrics.charWidth)+1).join("a"),a=a.getBoundingClientRect(),a=Math.min(150,Math.ceil(a.right-a.left))+"px"):a="";var b=x.node.style.width;x.node.style.width=a;return b!==a}function h(a,b,c){c||x.top<=a.y&&a.y<=x.bottom?(x.mouseDown=!0,x.delta=b-B.getBoundingClientRect().top+x.node.getBoundingClientRect().top):(a=n.getOffsetAtLocation(a.x,a.y),l.setSelection(a,a,0.5,function(){}))}function g(a){if(x.mouseDown){var c=
b();a=Math.min(c.zoomClientHeight-c.windowHeight,Math.max(0,a-x.delta));l.setTopPixel(a*(c.documentHeight-c.clientHeight)/Math.min(c.zoomDocumentHeight,c.zoomClientHeight-c.windowHeight))}}var l=this.getView();if(l){var k=a(l.getOptions());k.parent=this.node;var n=this._zoomView=new m.TextView(k);n._clientDiv.contentEditable=!1;n.setModel(l.getModel());var q=l.getOptions("parent").ownerDocument,B=this._windowDiv=f.createElement(q,"div");B.className="rulerZoomWindow";this.node.appendChild(B);var s=
parseInt(d.getNodeStyle(B,"border-top-width",0))+parseInt(d.getNodeStyle(B,"border-bottom-width",0)),x=this;l.addEventListener("Scroll",this._scrollListener=function(a){c(a.newValue)});l.addEventListener("Resize",this._resizeListener=function(){e(n.getOptions());c()});l.addEventListener("Redraw",this._redrawListener=function(a){a.ruler||n.redrawLines(a.startLine,a.endLine)});l.addEventListener("Options",this._optionsListener=function(b){b=a(b.options);n.setOptions(b);e(n.getOptions())});n.addEventListener("LineStyle",
this._lineListener=function(a){l.onLineStyle(a)});f.isIOS||f.isAndroid?(B.addEventListener("touchstart",function(a){1===a.touches.length&&(h(a,a.touches[0].clientY,!0),a.preventDefault())}),B.addEventListener("touchend",function(a){0===a.touches.length&&(x.mouseDown=!1)}),B.addEventListener("touchmove",function(a){1===a.touches.length&&g(a.touches[0].clientY)}),n.addEventListener("TouchStart",function(a){1===a.touchCount&&(h(a,a.event.touches[0].clientY),a.preventDefault())})):(B.style.pointerEvents=
"none",n.addEventListener("MouseDown",function(a){var b=a.event;(b.which?0===b.button:1===b.button)&&h(a,b.clientY);a.preventDefault()}),n.addEventListener("MouseUp",function(a){x.mouseDown=!1;a.preventDefault()}),n.addEventListener("MouseMove",function(a){g(a.event.clientY);a.preventDefault()}));(q.defaultView||q.parentWindow).setTimeout(function(){c()},0)}},_destroy:function(){var a=this.getView();a&&(a.removeEventListener("Scroll",this._scrollListener),this._scrollListener=null,a.removeEventListener("Resize",
this._resizeListener),this._resizeListener=null,a.removeEventListener("Redraw",this._redrawListener),this._redrawListener=null,a.removeEventListener("Options",this._optionsListener),this._optionsListener=null);if(a=this._zoomView)a.removeEventListener("LineStyle",this._lineListener),a.setModel(null),a.destroy(),this._zoomView=null}});return{BaseRuler:n,Ruler:l,AnnotationRuler:a,LineNumberRuler:b,OverviewRuler:q,FoldingRuler:h,ZoomRuler:e}});
define("orion/editor/textDND",["orion/util"],function(k){function m(e,c){this._view=e;this._undoStack=c;this._dragSelection=null;this._dropOffset=-1;this._dropText=null;var g=this;this._listener={onDragStart:function(c){g._onDragStart(c)},onDragEnd:function(c){g._onDragEnd(c)},onDragEnter:function(c){g._onDragEnter(c)},onDragOver:function(c){g._onDragOver(c)},onDrop:function(c){g._onDrop(c)},onDestroy:function(c){g._onDestroy(c)}};e.addEventListener("DragStart",this._listener.onDragStart);e.addEventListener("DragEnd",
this._listener.onDragEnd);e.addEventListener("DragEnter",this._listener.onDragEnter);e.addEventListener("DragOver",this._listener.onDragOver);e.addEventListener("Drop",this._listener.onDrop);e.addEventListener("Destroy",this._listener.onDestroy)}m.prototype={destroy:function(){var e=this._view;e&&(e.removeEventListener("DragStart",this._listener.onDragStart),e.removeEventListener("DragEnd",this._listener.onDragEnd),e.removeEventListener("DragEnter",this._listener.onDragEnter),e.removeEventListener("DragOver",
this._listener.onDragOver),e.removeEventListener("Drop",this._listener.onDrop),e.removeEventListener("Destroy",this._listener.onDestroy),this._view=null)},_onDestroy:function(e){this.destroy()},_onDragStart:function(e){var c=this._view,g=c.getSelectionText();g&&(this._dragSelection=c.getSelections(),e.event.dataTransfer.effectAllowed="copyMove",e.event.dataTransfer.setData("Text",g))},_onDragEnd:function(e){if(this._dragSelection){var c=this._view,g=e.event.dataTransfer.dropEffect;if(!k.isFirefox&&
("none"!==g||this._dropText))g=e.event.dataTransfer.dropEffect=this._dropEffect;this._undoStack&&this._undoStack.startCompoundChange();(e="move"===g)&&c.setText({text:"",selection:this._dragSelection});if(this._dropText){var g=this._dropText,d=this._dropOffset;e&&this._dragSelection.forEach(function(c){d>=c.end?d-=c.end-c.start:d>=c.start&&(d=c.start)});c.setText(g,d,d);c.setSelection(d,d+g.length);this._dropText=null;this._dropOffset=-1}this._undoStack&&this._undoStack.endCompoundChange();this._dragSelection=
null}},_onDragEnter:function(e){this._onDragOver(e)},_onDragOver:function(e){var c=e.event.dataTransfer.types,g=!this._view.getOptions("readonly");g&&c&&(g=c.contains?c.contains("text/plain")||c.contains("Text"):-1!==c.indexOf("text/plain")||-1!==c.indexOf("Text"));g?k.isFirefox||(this._dropEffect=e.event.dataTransfer.dropEffect=(k.isMac?e.event.altKey:e.event.ctrlKey)?"copy":"move"):e.event.dataTransfer.dropEffect="none"},_onDrop:function(e){var c=this._view,g=e.event.dataTransfer.getData("Text");
g&&(k.isFirefox||(e.event.dataTransfer.dropEffect=this._dropEffect),e=c.getOffsetAtLocation(e.x,e.y),this._dragSelection?(this._dropOffset=e,this._dropText=g):(c.setText(g,e,e),c.setSelection(e,e+g.length)))}};return{TextDND:m}});
define("orion/editor/linkedMode","i18n!orion/editor/nls/messages orion/keyBinding orion/editor/keyModes orion/editor/annotations orion/objects orion/util".split(" "),function(k,m,e,c,g){function d(c){this._data=c}function f(c,b,a){var d=c.getTextView();e.KeyMode.call(this,d);this.editor=c;this.undoStack=b;this.contentAssist=a;this.linkedModeModel=null;d.setAction("linkedModeEnter",function(){this.exitLinkedMode(!0);return!0}.bind(this));d.setAction("linkedModeCancel",function(){this.exitLinkedMode(!1);
return!0}.bind(this));d.setAction("linkedModeNextGroup",function(){var a=this.linkedModeModel;this.selectLinkedGroup((a.selectedGroupIndex+1)%a.groups.length);return!0}.bind(this));d.setAction("linkedModePreviousGroup",function(){var a=this.linkedModeModel;this.selectLinkedGroup(0<a.selectedGroupIndex?a.selectedGroupIndex-1:a.groups.length-1);return!0}.bind(this));this.linkedModeListener={onActivating:function(a){this._groupContentAssistProvider&&(this.contentAssist.setProviders([this._groupContentAssistProvider]),
this.contentAssist.setProgress(null))}.bind(this),onModelChanged:function(a){if(!this.ignoreVerify){for(var b=this.editor.mapOffset(a.start),c=this.linkedModeModel,d,e;c;)if(d=this._getPositionChanged(c,b,b+a.removedCharCount),e=d.position,void 0===e||e.model!==c)this.exitLinkedMode(!1),c=this.linkedModeModel;else break;if(c){c=0;a=a.addedCharCount-a.removedCharCount;d=d.positions;for(var f,g=0;g<d.length;++g){f=d[g];e=f.position;var l=e.offset<=b&&b<=e.offset+e.length;l&&!f.ansestor?(e.offset+=c,
e.length+=a,c+=a):(e.offset+=c,f.ansestor&&l&&(e.length+=a));f.escape&&(f.model.escapePosition=e.offset)}this._updateAnnotations(d)}}}.bind(this),onVerify:function(a){if(!this.ignoreVerify){for(var b=this.editor,c=b.mapOffset(a.start),d=this.editor.mapOffset(a.end),e=this.linkedModeModel,f,g;e;)if(f=this._getPositionChanged(e,c,d),g=f.position,void 0===g||g.model!==e)this.exitLinkedMode(!1),e=this.linkedModeModel;else break;if(e){var l=this._compoundChange;l?l.owner.model===e&&l.owner.group===g.group||
(this.endUndo(),this.startUndo()):this.startUndo();e.selectedGroupIndex=g.group;var l=0,k=a.text.length-(d-c);f=f.positions;for(var n,c=c-g.position.offset,m=d-g.position.offset,q=0;q<f.length;++q)n=f[q],d=n.position,n.oldOffset=d.offset,n.model===e&&n.group===g.group?(d.offset+=l,d.length+=k,l+=k):(d.offset+=l,n.ansestor&&(d.length+=g.count*k)),n.escape&&(n.model.escapePosition=d.offset);this.ignoreVerify=!0;for(q=f.length-1;0<=q;q--)n=f[q],n.model===e&&n.group===g.group&&b.setText(a.text,n.oldOffset+
c,n.oldOffset+m,!1);this.ignoreVerify=!1;a.text=null;this._updateAnnotations(f)}}}.bind(this)}}var n={};d.prototype={chop:function(c,b){return b.substring(c.length)},computeProposals:function(c,b,a){b=a.prefix;c=[];a=(a=this._data.style?this._data.style:null)?a:"emphasis";for(var d=this._data.values,e=0;e<d.length;e++){var f=d[e];"string"===typeof f&&0===f.indexOf(b)?c.push({proposal:this.chop(b,f),description:f,hover:f,style:a}):"object"===typeof f&&f.proposal&&c.push({proposal:this.chop(b,f.proposal),
description:f.description?f.description:f.proposal,hover:f.hover?f.hover:f.proposal,style:a})}b=this._data.title?this._data.title:null;0<c.length&&c.splice(0,0,{proposal:"",description:b?b:"Options",style:"noemphasis_title",unselectable:!0});return c}};f.prototype=new e.KeyMode;g.mixin(f.prototype,{createKeyBindings:function(){var c=m.KeyBinding,b=[];b.push({actionID:"linkedModeEnter",keyBinding:new c(13)});b.push({actionID:"linkedModeCancel",keyBinding:new c(27)});b.push({actionID:"linkedModeNextGroup",
keyBinding:new c(9)});b.push({actionID:"linkedModePreviousGroup",keyBinding:new c(9,!1,!0)});return b},enterLinkedMode:function(c){if(!this.linkedModeModel){var b=this.editor.getTextView();b.addKeyMode(this);b.addEventListener("Verify",this.linkedModeListener.onVerify);b.addEventListener("ModelChanged",this.linkedModeListener.onModelChanged);this.contentAssist.addEventListener("Activating",this.linkedModeListener.onActivating);this.editor.reportStatus(k.linkedModeEntered,null,!0)}this._sortedPositions=
null;this.linkedModeModel&&(c.previousModel=this.linkedModeModel,c.parentGroup=this.linkedModeModel.selectedGroupIndex,this.linkedModeModel.nextModel=c);this.linkedModeModel=c;this.selectLinkedGroup(0)},exitLinkedMode:function(c){if(this.isActive()){this._compoundChange&&(this.endUndo(),this._compoundChange=null);this._sortedPositions=null;var b=this.linkedModeModel;this.linkedModeModel=b.previousModel;b.parentGroup=b.previousModel=void 0;this.linkedModeModel&&(this.linkedModeModel.nextModel=void 0);
if(!this.linkedModeModel){var a=this.editor,d=a.getTextView();d.removeKeyMode(this);d.removeEventListener("Verify",this.linkedModeListener.onVerify);d.removeEventListener("ModelChanged",this.linkedModeListener.onModelChanged);d=this.contentAssist;d.removeEventListener("Activating",this.linkedModeListener.onActivating);d.offset=void 0;this.editor.reportStatus(k.linkedModeExited,null,!0);c&&"number"===typeof b.escapePosition&&a.setCaretOffset(b.escapePosition,!1)}this.selectLinkedGroup(0)}},startUndo:function(){if(this.undoStack){var c=
this,b=this.linkedModeModel;this._compoundChange=this.undoStack.startCompoundChange({model:b,group:b.selectedGroupIndex,end:function(){c._compoundChange=null}})}},endUndo:function(){this.undoStack&&this.undoStack.endCompoundChange()},isActive:function(){return!!this.linkedModeModel},isStatusActive:function(){return!!this.linkedModeModel},selectLinkedGroup:function(c){var b=this.linkedModeModel;if(b){b.selectedGroupIndex=c;c=b.groups[c];var a=c.positions[0],e=this.editor;e.setSelection(a.offset,a.offset+
a.length);if(b=this.contentAssist)b.offset=void 0,c.data&&"link"===c.data.type&&c.data.values?((this._groupContentAssistProvider=new d(c.data)).getPrefix=function(){var b=e.getSelection();return b.start===b.end&&(b=e.getCaretOffset(),a.offset<=b&&b<=a.offset+a.length)?e.getText(a.offset,b):""},b.offset=a.offset,b.deactivate(),b.activate()):this._groupContentAssistProvider&&(this._groupContentAssistProvider=null,b.deactivate())}this._updateAnnotations()},_getModelPositions:function(c,b,a){for(var d=
b.groups,e=0;e<d.length;e++)for(var f=d[e].positions,g=0;g<f.length;g++){var k=f[g];a&&(k={offset:k.offset+a,length:k.length});k={index:g,group:e,count:f.length,model:b,position:k};c.push(k);b.nextModel&&b.nextModel.parentGroup===e&&(k.ansestor=!0,this._getModelPositions(c,b.nextModel,(a||0)+f[g].offset-f[0].offset))}},_getSortedPositions:function(c){var b=this._sortedPositions;if(!b){for(b=[];c.previousModel;)c=c.previousModel;for(this._getModelPositions(b,c);c;)"number"===typeof c.escapePosition&&
b.push({escape:!0,model:c,position:{offset:c.escapePosition,length:0}}),c=c.nextModel;b.sort(function(a,b){return a.position.offset-b.position.offset});this._sortedPositions=b}return b},_getPositionChanged:function(c,b,a){var d;c=this._getSortedPositions(c);for(var e=c.length-1;0<=e;e--)if(!c[e].escape){var f=c[e].position;if(f.offset<=b&&a<=f.offset+f.length){d=c[e];break}}return{position:d,positions:c}},_updateAnnotations:function(d){var b=this.editor.getAnnotationModel();if(b){for(var a=[],e=[],
f=b.getAnnotations(),g;f.hasNext();)switch(g=f.next(),g.type){case c.AnnotationType.ANNOTATION_LINKED_GROUP:case c.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP:case c.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:a.push(g)}if(f=this.linkedModeModel){d=d||this._getSortedPositions(f);for(var k=0;k<d.length;k++)if(g=d[k],g.model===f&&!g.escape){var n=c.AnnotationType.ANNOTATION_LINKED_GROUP;g.group===f.selectedGroupIndex&&(n=0===g.index?c.AnnotationType.ANNOTATION_SELECTED_LINKED_GROUP:c.AnnotationType.ANNOTATION_CURRENT_LINKED_GROUP);
g=g.position;g=c.AnnotationType.createAnnotation(n,g.offset,g.offset+g.length,"");e.push(g)}}b.replaceAnnotations(a,e)}}});n.LinkedMode=f;return n});
define("orion/editor/factories","orion/editor/actions orion/editor/undoStack orion/editor/rulers orion/editor/annotations orion/editor/textDND orion/editor/linkedMode orion/util".split(" "),function(k,m,e,c,g,d,f){function n(){}function l(){}function b(){}function a(){}function q(){}function h(){}function p(){}var r={};n.prototype={createKeyBindings:function(a,b,c,e){e=new k.TextActions(a,b,e);var f=new d.LinkedMode(a,b,c);a=new k.SourceCodeActions(a,b,c,f);return{textActions:e,linkedMode:f,sourceCodeActions:a}}};
r.KeyBindingsFactory=n;l.prototype={createUndoStack:function(a){a=a.getTextView();return new m.UndoStack(a,200)}};r.UndoFactory=l;b.prototype={createLineNumberRuler:function(a){return new e.LineNumberRuler(a,"left",{styleClass:"ruler lines"},{styleClass:"rulerLines odd"},{styleClass:"rulerLines even"})}};r.LineNumberRulerFactory=b;a.prototype={createFoldingRuler:function(a){return new e.FoldingRuler(a,"left",{styleClass:"ruler folding"})}};r.FoldingRulerFactory=a;q.prototype={createZoomRuler:function(a){return new e.ZoomRuler(f.isIOS||
f.isAndroid?"right":"innerRight",{styleClass:"ruler zoom"})}};r.ZoomRulerFactory=q;h.prototype={createAnnotationModel:function(a){return new c.AnnotationModel(a)},createAnnotationStyler:function(a,b){return new c.AnnotationStyler(a,b)},createAnnotationRulers:function(a){var b=new e.AnnotationRuler(a,"left",{styleClass:"ruler annotations"});a=new e.OverviewRuler(a,"right",{styleClass:"ruler overview"});return{annotationRuler:b,overviewRuler:a}}};r.AnnotationFactory=h;p.prototype={createTextDND:function(a,
b){return new g.TextDND(a.getTextView(),b)}};r.TextDNDFactory=p;return r});define("orion/editor/editorFeatures",["orion/editor/factories","orion/editor/actions","orion/editor/linkedMode","orion/objects"],function(k,m,e,c){return c.mixin({},k,m,e)});
define("orion/webui/splitter",["orion/EventTarget","orion/util","orion/metrics","orion/webui/littlelib"],function(k,m,e,c){function g(c){k.attach(this);this._init(c)}g.prototype={_init:function(d){this.$splitter=c.node(d.node);if(!this.$splitter)throw"no dom node for splitter found";this.$leading=c.node(d.sidePanel);if(!this.$leading)throw"no dom node for side panel found";this.$trailing=c.node(d.mainPanel);if(!this.$trailing)throw"no dom node for main panel found";this._tracking=!1;this._animationDelay=
501;this._collapseTrailing=d.closeReversely||!1;this._proportional=d.proportional||!1;this._prefix="/orion/splitter/"+(this.$splitter.id||document.body.id||"");d.toggle&&(this._thumb=document.createElement("div"),this.$splitter.appendChild(this._thumb),this._thumb.classList.add("splitThumb"),this._vertical?this._thumb.classList.add(this._collapseTrailing?"splitVerticalThumbDownLayout":"splitVerticalThumbUpLayout"):this._thumb.classList.add(this._collapseTrailing?"splitThumbRightLayout":"splitThumbLeftLayout"));
this.$splitter.classList.add("split");var e=localStorage.getItem(this._prefix+"/orientation");this.setOrientation(e?"vertical"===e?2:1:d.vertical?2:1);m.isIOS||m.isAndroid?(this.$splitter.addEventListener("touchstart",this._touchStart.bind(this),!1),this._thumb&&this._thumb.addEventListener("touchstart",this._touchStart.bind(this),!1),this.$splitter.addEventListener("touchmove",this._touchMove.bind(this),!1),this.$splitter.addEventListener("touchend",this._touchEnd.bind(this),!1)):(this.$splitter.addEventListener("mousedown",
this._mouseDown.bind(this),!1),window.addEventListener("mouseup",this._mouseUp.bind(this),!1));window.addEventListener("resize",this._resize.bind(this),!1)},isClosed:function(){return this._closed},getOrientation:function(){return this._vertical?2:1},setOrientation:function(c,e){var g=2===c;if(g!==this._vertical||e)this._vertical=g,localStorage.setItem(this._prefix+"/orientation",this._vertical?"vertical":"horizontal"),this.$splitter.style.position="absolute",this.$trailing.style.position="absolute",
this.$leading.style.position="absolute",this._offsetStorageLabel="/offset",this._vertical&&!this._proportional&&(this._offsetStorageLabel="/offsetY"),this._vertical?(this.$splitter.classList.remove("splitLayout"),this.$splitter.classList.add("splitVerticalLayout"),this._topLeft="top",this._bottomRight="bottom",this._widthHeight="height"):(this.$splitter.classList.remove("splitVerticalLayout"),this.$splitter.classList.add("splitLayout"),this._topLeft="left",this._bottomRight="right",this._widthHeight=
"width"),this._initializeFromStoredSettings(),this._setStyleConstants(),this._collapseTrailing?(this.$splitter.style[this._topLeft]="auto",this.$leading.style[this._topLeft]="0px",this.$leading.style[this._widthHeight]="auto",this.$trailing.style[this._topLeft]="auto"):(this.$splitter.style[this._bottomRight]="auto",this.$leading.style[this._topLeft]="0px",this.$leading.style[this._bottomRight]="auto",this.$trailing.style[this._widthHeight]="auto"),this.$trailing.style[this._bottomRight]="0px",this._thumb&&
(g=this._thumb.classList,this._vertical?(g.remove(this._collapseTrailing?"splitThumbRightLayout":"splitThumbLeftLayout"),g.add(this._collapseTrailing?"splitVerticalThumbDownLayout":"splitVerticalThumbUpLayout")):(g.remove(this._collapseTrailing?"splitVerticalThumbDownLayout":"splitVerticalThumbUpLayout"),g.add(this._collapseTrailing?"splitThumbRightLayout":"splitThumbLeftLayout"))),this._closed?(this._closed=!1,this._thumbDown(!0,!0)):this._adjustToOffset(),this._resize(),this.$splitter.style.visibility=
"visible",this.$trailing.style.display="block",this.$leading.style.display="block"},resize:function(){this._resize()},_setStyleConstants:function(){this._vertical?(this.$splitter.style.left="",this.$splitter.style.right="",this.$leading.style.left="auto",this.$leading.style.right="auto",this.$leading.style.width="100%",this.$trailing.style.left="auto",this.$trailing.style.right="auto",this.$trailing.style.width="100%"):(this.$splitter.style.top="",this.$splitter.style.bottom="",this.$leading.style.top=
"auto",this.$leading.style.bottom="auto",this.$leading.style.height="100%",this.$trailing.style.top="auto",this.$trailing.style.bottom="auto",this.$trailing.style.height="100%")},toggleSidePanel:function(){this._thumbDown()},openSidePanel:function(){this._closed||this._thumbDown()},addResizeListener:function(c){this.addEventListener("resize",function(e){c(e.node)})},_initializeFromStoredSettings:function(){var d=localStorage.getItem(this._prefix+"/toggleState");this._closed="string"===typeof d?"closed"===
d:this._closeByDefault;this._adjustSplitterSize();(d=localStorage.getItem(this._prefix+this._offsetStorageLabel))?(this._offset=parseInt(d,10),this._proportional&&(this._offset=Math.max(0,Math.min(100-this._splitterSize,this._offset)))):(d=c.bounds(this.$splitter),this._offset=this._adjustOffset(d[this._topLeft]))},_adjustSplitterSize:function(){this._splitterSize=c.bounds(this.$splitter)[this._widthHeight];if(this._proportional){var d=c.bounds(this.$splitter.parentNode);this._splitterSize/=d[this._widthHeight]/
100}},_adjustOffset:function(d){var e=c.bounds(this.$splitter.parentNode);d=this._collapseTrailing?e[this._widthHeight]-(d+this._splitterSize-e[this._topLeft]):d-e[this._topLeft];this._proportional&&(d/=e[this._widthHeight]/100);return d},_adjustToOffset:function(){0>this._offset&&(this._offset=0);var c=this._proportional?"%":"px";this._collapseTrailing?(this.$splitter.style[this._bottomRight]=this._offset+c,this.$leading.style[this._bottomRight]=this._offset+this._splitterSize+c,this.$trailing.style[this._widthHeight]=
this._offset+c):(this.$splitter.style[this._topLeft]=this._offset+c,this.$leading.style[this._widthHeight]=this._offset+c,this.$trailing.style[this._topLeft]=this._offset+this._splitterSize+c)},_resize:function(){"none"!==this.$splitter.style.display&&(this._proportional&&(this._adjustSplitterSize(),this._adjustToOffset()),this._notifyResizeListeners(this.$trailing),this._notifyResizeListeners(this.$leading))},_notifyResizeListeners:function(c){this.dispatchEvent({type:"resize",node:c})},_notifyToggleListeners:function(){this.dispatchEvent({type:"toggle",
closed:this._closed})},_thumbDown:function(c,f){c||this._addAnimation();if(this._closed){var g=localStorage.getItem(this._prefix+this._offsetStorageLabel);this._offset=g?parseInt(g,10):350;this._closed=!1}else localStorage.setItem(this._prefix+this._offsetStorageLabel,this._offset),this._offset=0,this._closed=!0;this._adjustToOffset();c||this._removeAnimation();f||(localStorage.setItem(this._prefix+"/toggleState",this._closed?"closed":null),e.logEvent("preferenceChange","splitterClosed",this._prefix,
this._closed?0:1))},_removeAnimation:function(){var c=this;window.setTimeout(function(){c.$leading.classList.remove("generalAnimation");c.$trailing.classList.remove("generalAnimation");c.$splitter.classList.remove("generalAnimation");c._resize()},this._animationDelay)},_addAnimation:function(){this.$leading.classList.add("generalAnimation");this.$trailing.classList.add("generalAnimation");this.$splitter.classList.add("generalAnimation")},_down:function(){this.$splitter.classList.add("splitTracking");
this.$trailing.classList.add("panelTracking");this.$leading.classList.add("panelTracking")},_move:function(d,e){var g=this._vertical?e:d,l=c.bounds(this.$splitter)[this._widthHeight]/2;this._offset=this._collapseTrailing?this._adjustOffset(g+l):this._adjustOffset(g-l);this._adjustToOffset();this._notifyResizeListeners(this.$trailing);this._notifyResizeListeners(this.$leading)},_up:function(){this.$splitter.classList.remove("splitTracking");this.$trailing.classList.remove("panelTracking");this.$leading.classList.remove("panelTracking");
var c=this._closed;0<this._offset?(localStorage.setItem(this._prefix+this._offsetStorageLabel,this._offset),this._closed=!1):this._closed=!0;c!==this._closed&&(localStorage.setItem(this._prefix+"/toggleState",this._closed?"closed":null),e.logEvent("preferenceChange","splitterClosed",this._prefix,this._closed?0:1))},_mouseDown:function(d){if(d.target===this._thumb)return c.stop(d),this._thumbDown();this._tracking||(this._down(d),this._tracking=this._mouseMove.bind(this),window.addEventListener("mousemove",
this._tracking),c.setFramesEnabled(!1),c.stop(d))},_mouseMove:function(c){this._tracking&&(this._move(c.clientX,c.clientY),this._resize())},_mouseUp:function(d){this._tracking&&(c.setFramesEnabled(!0),window.removeEventListener("mousemove",this._tracking),this._tracking=null,this._up(),c.stop(d))},_touchStart:function(d){if(1===d.touches.length){c.stop(d);if(d.target===this._thumb)return this._thumbDown();this._down(d);this._touching=!0}},_touchMove:function(c){this._touching&&(c=c.touches,1===c.length&&
(c=c[0],this._move(c.clientX,c.clientY)))},_touchEnd:function(c){0===c.touches.length&&(this._touching=!1,this._up())}};g.prototype.constructor=g;return{Splitter:g,ORIENTATION_HORIZONTAL:1,ORIENTATION_VERTICAL:2}});define("text!orion/compare/sideBySideTemplate.html",[],function(){return'\x3cdiv id\x3d"topWidget_id" style\x3d"height:100%;width:100%;position:relative"\x3e\n\t\x3cdiv class\x3d"leftPanelLayout "\x3e\n\t\t\x3cdiv class\x3d"titleActionContainer"\x3e\n\t\t\t\x3cdiv class\x3d"compareActionContainer" id\x3d"left_action_id"\x3e\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"titleContainer" id\x3d"left_title_id"\x3e\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv class\x3d"compareEditorParent" id\x3d"left_editor_id"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"statusContainer" id\x3d"left_status_id"\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"split compareSplitLayout"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"rightPanelLayout"\x3e\n\t\t\x3cdiv class\x3d"titleActionContainer"\x3e\n\t\t\t\x3cdiv class\x3d"compareActionContainer" id\x3d"right_action_id"\x3e\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"titleContainer" id\x3d"right_title_id"\x3e\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv class\x3d"compareEditorParent"  id\x3d"right_editor_wrapper_id"\x3e\n\t\t\t\x3cdiv class\x3d"canvasContainer"\x3e\n\t\t\t\t\x3ccanvas id\x3d"diff_canvas_id" class\x3d"compareCanvas" width\x3d"46" height\x3d"3000"\x3e\x3c/canvas\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"compareEditorParentWithCanvas" id\x3d"right_editor_id"\x3e\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv class\x3d"statusContainer" id\x3d"right_status_id"\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e'});
define("orion/compare/compareUIFactory",["orion/webui/littlelib","orion/webui/splitter","text!orion/compare/sideBySideTemplate.html"],function(k,m,e){var c=c||{};c.TwoWayCompareUIFactory=function(){function c(d){this._parentDivID=d.parentDivID;this._commandSpanId=d.commandSpanId;this._showTitle=d.showTitle;this._leftTitle=d.leftTitle;this._rightTitle=d.rightTitle;this._showLineStatus=d.showLineStatus}c.prototype={_init:function(){var c=this._parentDivID+"_";this._topWidgetDiv=k.node("topWidget_id");
this._topWidgetDiv.id=c+"topWidget_id";this._leftEditorParentDiv=k.node("left_editor_id");this._leftEditorParentDiv.id=c+"left_editor_id";this._rightEditorParentDiv=k.node("right_editor_id");this._rightEditorParentDiv.id=c+"right_editor_id";this._rightEditorWrapperDiv=k.node("right_editor_wrapper_id");this._rightEditorWrapperDiv.id=c+"right_editor_wrapper_id";this._leftActionDiv=k.node("left_action_id");this._leftActionDiv.id=c+"left_action_id";this._rightActionDiv=k.node("right_action_id");this._rightActionDiv.id=
c+"right_action_id";this._leftTitleDiv=k.node("left_title_id");this._leftTitleDiv.id=c+"left_title_id";this._rightTitleDiv=k.node("right_title_id");this._rightTitleDiv.id=c+"right_title_id";this._leftStatusDiv=k.node("left_status_id");this._leftStatusDiv.id=c+"left_status_id";this._rightStatusDiv=k.node("right_status_id");this._rightStatusDiv.id=c+"right_status_id";this._diffCanvasDiv=k.node("diff_canvas_id");this._diffCanvasDiv.id=c+"diff_canvas_id";this._splitterId=c+"orion_splitter";this._showTitle||
this.disableTitle();this._showLineStatus||this.disableLineStatus()},_createSplitter:function(){var c=k.$(".split",this._topWidgetDiv);c.id=this._splitterId;var e=k.$(".leftPanelLayout",this._topWidgetDiv),g=k.$(".rightPanelLayout",this._topWidgetDiv);c&&(e&&g)&&(this._splitter=new m.Splitter({node:c,sidePanel:e,mainPanel:g,proportional:!0}))},buildUI:function(){k.node(this._parentDivID).innerHTML=e;this._init();this._createSplitter()},destroy:function(){},getSplitter:function(){return this._splitter},
isLeftPane:function(c){return k.$(".leftPanelLayout",this._topWidgetDiv)===c},getEditorParentDiv:function(c){return c?this._leftEditorParentDiv:this._rightEditorParentDiv},getTitleDiv:function(c){return c?this._leftTitleDiv:this._rightTitleDiv},getActionDivId:function(c){return c?this._leftActionDiv.id:this._rightActionDiv.id},getStatusDiv:function(c){return c?this._leftStatusDiv:this._rightStatusDiv},getCommandSpanId:function(){return this._commandSpanId},getDiffCanvasDiv:function(){return this._diffCanvasDiv},
disableTitle:function(){this._leftEditorParentDiv.style.top="0px";this._rightEditorWrapperDiv.style.top="0px";this._leftTitleDiv.style.height="0px";this._rightTitleDiv.style.height="0px"},disableLineStatus:function(){this._leftEditorParentDiv.style.marginBottom="0px";this._rightEditorWrapperDiv.style.marginBottom="0px";this._leftStatusDiv.style.height="0px";this._rightStatusDiv.style.height="0px"}};return c}();return c});
var JsDiff=function(){function k(c){for(var d=[],b=0;b<c.length;b++)c[b]&&d.push(c[b]);return d}function m(c){c=c.replace(/&/g,"\x26amp;");c=c.replace(/</g,"\x26lt;");c=c.replace(/>/g,"\x26gt;");return c=c.replace(/"/g,"\x26quot;")}var e=function(c){this.ignoreWhitespace=c};e.prototype={diff:function(c,d,b){this.ignoreWhitespace=b;if(d===c)return[{value:d}];if(!d)return[{value:c,removed:!0}];if(!c)return[{value:d,added:!0}];d=this.tokenize(d);c=this.tokenize(c);b=d.length;var a=c.length,e=b+a,f=[{newPos:-1,
components:[]}],g=this.extractCommon(f[0],d,c,0);if(f[0].newPos+1>=b&&g+1>=a)return f[0].components;for(var k=1;k<=e;k++)for(var m=-1*k;m<=k;m+=2){var v;v=f[m-1];var w=f[m+1],g=(w?w.newPos:0)-m;v&&(f[m-1]=void 0);var t=v&&v.newPos+1<b,A=w&&0<=g&&g<a;if(!t&&!A)f[m]=void 0;else{!t||A&&v.newPos<w.newPos?(v={newPos:w.newPos,components:w.components.slice(0)},this.pushComponent(v.components,c[g],"",void 0,!0)):(v={newPos:v.newPos,components:v.components.slice(0)},v.newPos++,this.pushComponent(v.components,
d[v.newPos],"",!0,void 0));g=this.extractCommon(v,d,c,m);if(v.newPos+1>=b&&g+1>=a)return v.components;f[m]=v}}},pushComponent:function(c,d,b,a,e){var f=c[c.length-1];f&&f.added===a&&f.removed===e?c[c.length-1]={value:this.join(f.value,d),helperValue:this.join(f.helperValue,b),added:a,removed:e}:c.push({value:d,helperValue:b,added:a,removed:e})},extractCommon:function(c,d,b,a){var e=d.length,f=b.length,g=c.newPos;for(a=g-a;g+1<e&&a+1<f&&this.equals(d[g+1],b[a+1]);)g++,a++,this.pushComponent(c.components,
d[g],b[a],void 0,void 0);c.newPos=g;return a},equals:function(c,d){var b=/\S/;return this.ignoreWhitespace&&!b.test(c)&&!b.test(d)?!0:this._equals(c,d)},join:function(c,d){return c+d},tokenize:function(c){return c}};var c=new e;c._equals=function(c,d){return c===d};var g=new e(!1);g.tokenize=function(c){return k(c.split(/(\s+|\b)/))};g._equals=function(c,d){return c===d};var d=new e(!0);d.tokenize=function(c){return k(c.split(/([{}:;,]|\s+)/))};d._equals=function(c,d){return c===d};var f=new e;f.tokenize=
function(c){(c=c.split(/^/m))&&(0<c.length&&!c[c.length-1])&&c.pop();return c};f._equals=function(c,d){if(this.ignoreWhitespace){var b=c.replace(/^\s+|\s+$|\s+(?=\s)/g,""),a=d.replace(/^\s+|\s+$|\s+(?=\s)/g,"");return b===a}return c===d};return{diffChars:function(d,e,b){return c.diff(d,e,b)},diffWords:function(c,d,b){return g.diff(c,d,b)},diffLines:function(c,d,b){return f.diff(c,d,b)},diffCss:function(c,e){return d.diff(c,e)},createPatch:function(c,d,b,a,e){var g=[];g.push("Index: "+c);g.push("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d");
g.push("--- "+c+"\t"+a);g.push("+++ "+c+"\t"+e);c=f.diff(d,b);c.push({value:"",lines:[]});b=d=0;a=[];for(var k=e=1,m=0;m<c.length;m++){var u=c[m],v=u.lines||u.value.replace(/\n$/,"").split("\n");u.lines=v;if(u.added||u.removed){if(!d){var w=c[m-1];d=e;b=k;w&&(a.push.apply(a,w.lines.slice(-4).map(function(a){return" "+a})),d-=4,b-=4)}a.push.apply(a,v.map(function(a){return(u.added?"+":"-")+a}));u.added?k+=v.length:e+=v.length}else d&&(8>=v.length&&m<c.length-1?a.push.apply(a,v.map(function(a){return" "+
a})):(w=Math.min(v.length,4),g.push("@@ -"+d+","+(e-d+w)+" +"+b+","+(k-b+w)+" @@"),g.push.apply(g,a),g.push.apply(g,v.slice(0,w).map(function(a){return" "+a})),b=d=0,a=[])),e+=v.length,k+=v.length}1<c.length&&!/\n$/.test(c[c.length-2].value)&&g.push("\\ No newline at end of file\n");return g.join("\n")},convertChangesToXML:function(c){for(var d=[],b=0;b<c.length;b++){var a=c[b];a.added?d.push("\x3cins\x3e"):a.removed&&d.push("\x3cdel\x3e");d.push(m(a.value));a.added?d.push("\x3c/ins\x3e"):a.removed&&
d.push("\x3c/del\x3e")}return d.join("")}}}();"undefined"!==typeof module&&(module.exports=JsDiff);"function"===typeof define&&define.amd&&define("jsdiff/diff",[],function(){return JsDiff});
define("orion/compare/jsdiffAdapter",["jsdiff/diff"],function(k){var m=m||{};m.JSDiffAdapter=function(){function e(c){this._ignoreWhitespace=c}e.prototype={_specialLine:function(c,e,d){return e.value===c&&d!==c},adapt:function(c,e,d){d||(d="\n");var f=c.split(d),m=e.split(d),l=""===f[f.length-1],m=""===m[m.length-1],b=k.diffLines(c,e,this._ignoreWhitespace);c=[];e=[];for(var a=0,q=0,h=-1,p=0,r=!0,u=d,v=0;v<b.length;v++){var w=b[v],t=w.lines||w.value.split(d),A=t.length,z=0;1<t.length&&""===t[t.length-
1]&&A--;1<A&&!r&&""===t[0]&&(A--,z++);w.lines=t;if(!w.added&&!w.removed){if(!this._specialLine(d,w,u)){if(a||q)c.push([a,q,h]),q=a=0,h=-1,p+=q;c.push([A,A,0]);p+=A}}else if(w.added){-1===h&&(h=e.length+1);a+=A;for(r=z;r<A+z;r++)e.push(w.lines[r])}else q+=A;r=!1;1<t.length&&""===t[t.length-1]&&(r=!0);u=w.value?w.value[w.value.length-1]:d}if(a||q)c.push([a,q,h]),p+=q;p<f.length&&1<f.length&&(d=c[c.length-1],0===d[2]?(d[0]+=1,d[1]+=1):-1===d[2]?c.push([1,1,0]):l===m?c.push([1,1,0]):(m&&(d[0]+=1),l&&
(d[1]+=1)));return{mapper:c,changContents:{array:e,index:0}}},adaptCharDiff:function(c,e,d){c=d?k.diffWords(c,e,this._ignoreWhitespace):k.diffChars(c,e,this._ignoreWhitespace);e=[];for(var f=d=0,m=0,l=0,b=0;b<c.length;b++){var a=c[b];if(!a.added&&!a.removed){if(0<m||0<l)e.push([f,f+m,d,d+l]),f+=m,d+=l,l=m=0;f+=a.value.length;d=a.helperValue?d+a.helperValue.length:d+a.value.length}else a.added?m+=a.value.length:l+=a.value.length}(0<m||0<l)&&e.push([f,f+m,d,d+l]);return e}};return e}();return m});
define("orion/treeModelIterator",[],function(){var k={};k.TreeModelIterator=function(){function k(e,c){this.firstLevelChildren=e;this.reset();this._init(c)}k.prototype={_init:function(e){e&&(this.isExpanded=e.isExpanded,this.isExpandable=e.isExpandable,this.forceExpandFunc=e.forceExpandFunc,this.getChildrenFunc=e.getChildrenFunc)},topLevel:function(e){return e.parent?e.parent===this.root:!0},_getChildren:function(e){return"function"===typeof this.getChildrenFunc?this.getChildrenFunc(e):e?e.children:
null},_expanded:function(e){if(!e)return!0;var c=this._getChildren(e),c=c&&0<c.length;this.isExpanded&&c&&(c=this.isExpanded(e));return c},_expandable:function(e){return!e?!0:this.isExpandable?this.isExpandable(e):!1},_diveIn:function(e){return this._expanded(e)?(e=this._getChildren(e),this.setCursor(e[0]),this.cursor()):null},_drillToLast:function(e){return this._expanded(e)?(e=this._getChildren(e),this._drillToLast(e[e.length-1])):e},_forward:function(e){if(!this._cursor)return null;var c=this._diveIn(this._cursor);
if(!c){if(e&&this._expandable(this._cursor)&&this.forceExpandFunc){var g=this;return this.forceExpandFunc(this._cursor,"first",function(c){c&&g.setCursor(c)})}(c=this._findSibling(this._cursor,!0))&&this.setCursor(c)}return c},_backward:function(e){if(!this._cursor)return null;var c=this._findSibling(this._cursor,!1);c&&c!==this._cursor.parent&&(c=this._drillToLast(c));if(e&&c&&this._expandable(c)&&this.forceExpandFunc&&c!==this._cursor.parent){var g=this;return this.forceExpandFunc(c,"last",function(c){c&&
g.setCursor(c)})}c&&this.setCursor(c);return c},_findSibling:function(e,c){for(var g=this.topLevel(e),d=this._getChildren(e.parent),d=g?this.firstLevelChildren:d,f=0;f<d.length;f++)if(d[f]===e)return 0===f&&!c?g?null:e.parent:f===d.length-1&&c?g?null:this._findSibling(e.parent,c):c?d[f+1]:d[f-1];return null},_inParentChain:function(e,c){for(var g=e.parent;g;){if(g===c)return!0;g=g.parent}return!1},_getTopLevelParent:function(e){if(this.topLevel(e))return e;for(e=e.parent;e;){if(this.topLevel(e))return e;
e=e.parent}return null},_onCollapse:function(e){return this._expanded(e.parent)?e:this._onCollapse(e.parent)},_scan:function(e,c,g){this.setCursor(c);var d=[];for(d.push(c);;){if(this.iterate(e))d.push(this.cursor());else break;if(g===this.cursor())return d}return null},setCursor:function(e){this._prevCursor=this._cursor;this._cursor=e},setTree:function(e){this.firstLevelChildren=e;0<this.firstLevelChildren.length&&(this.root=this.firstLevelChildren[0].parent)},scan:function(e,c){var g=this.cursor(),
d=this._scan(!0,e,c);d||(d=this._scan(!1,e,c));this.setCursor(g);return d},iterate:function(e,c){return e?this._forward(c):this._backward(c)},iterateOnTop:function(e,c){var g=this._findSibling(this._getTopLevelParent(this.cursor()),e);g?this.setCursor(g):c&&0<this.firstLevelChildren.length&&this.setCursor(e?this.firstLevelChildren[0]:this.firstLevelChildren[this.firstLevelChildren.length-1])},collapse:function(e){return!this._cursor?null:this._inParentChain(this._cursor,e)?(this.setCursor(e),this._cursor):
null},reset:function(){this.root=this._prevCursor=this._cursor=null;0<this.firstLevelChildren.length&&(this._cursor=this.firstLevelChildren[0],this.root=this.firstLevelChildren[0].parent)},cursorMoved:function(){return this._cursor!==this._prevCursor},cursor:function(){return this._cursor},prevCursor:function(){return this._prevCursor}};return k}();return k});
define("orion/compare/diffTreeNavigator",["i18n!orion/compare/nls/messages","orion/treeModelIterator","orion/compare/compareUtils","orion/editor/annotations","orion/compare/jsdiffAdapter"],function(k,m,e,c,g){var d={},f,n,l,b,a,q,h,p,r,u,v,w,t,A,z,C;d.DiffTreeNavigator=function(){function d(a,b,c,e,f,g){this._root={type:"root",children:[]};this._initialized=!1;this.initAll(a,b,c,e,f,g)}f="orion.annotation.diff.addedBlock";n="orion.annotation.diff.currentAddedBlock";l="orion.annotation.diff.deletedBlock";
b="orion.annotation.diff.currentDeletedBlock";a="orion.annotation.diff.blockTop";q="orion.annotation.diff.currentBlockTop";h="orion.annotation.diff.blockConflict";p="orion.annotation.diff.currentBlockConflict";r="orion.annotation.diff.addedWord";u="orion.annotation.diff.currentAddedWord";v="orion.annotation.diff.deletedWord";w="orion.annotation.diff.currentDeletedWord";t="orion.annotation.diff.emptyDeletedWordLeft";A="orion.annotation.diff.emptyDeletedWordRight";z="orion.annotation.diff.emptyAddedWordLeft";
C="orion.annotation.diff.emptyAddedWordRight";c.AnnotationType.registerType(f,{title:"",html:"",lineStyle:{styleClass:"annotationLine addedBlockDiff"}});c.AnnotationType.registerType(n,{title:"",html:"",lineStyle:{styleClass:"annotationLine currentAddedBlockDiff"}});c.AnnotationType.registerType(l,{title:"",html:"",lineStyle:{styleClass:"annotationLine deletedBlockDiff"}});c.AnnotationType.registerType(b,{title:"",html:"",lineStyle:{styleClass:"annotationLine currentDeletedBlockDiff"}});c.AnnotationType.registerType(a,
{title:"",html:"",lineStyle:{styleClass:"annotationLine blockDiffTopOnly"}});c.AnnotationType.registerType(q,{title:"",html:"",lineStyle:{styleClass:"annotationLine currentBlockDiffTopOnly"}});c.AnnotationType.registerType(h,{title:"",html:"",lineStyle:{styleClass:"annotationLine blockDiffConflict"}});c.AnnotationType.registerType(p,{title:"",html:"",lineStyle:{styleClass:"annotationLine currentBlockDiffConflict"}});c.AnnotationType.registerType(r,{title:k["word added"],html:"",rangeStyle:{styleClass:"annotationRange addedWordDiff"}});
c.AnnotationType.registerType(u,{title:"",html:"",rangeStyle:{styleClass:"annotationRange currentAddedWordDiff"}});c.AnnotationType.registerType(v,{title:k["word deleted"],html:"",rangeStyle:{styleClass:"annotationRange deletedWordDiff"}});c.AnnotationType.registerType(w,{title:"",html:"",rangeStyle:{styleClass:"annotationRange currentDeletedWordDiff"}});c.AnnotationType.registerType(t,{title:"",html:"",rangeStyle:{styleClass:"annotationRange emptyDeletedWordDiffLeft"}});c.AnnotationType.registerType(A,
{title:"",html:"",rangeStyle:{styleClass:"annotationRange emptyDeletedWordDiffRight"}});c.AnnotationType.registerType(z,{title:"",html:"",rangeStyle:{styleClass:"annotationRange emptyAddedWordDiffLeft"}});c.AnnotationType.registerType(C,{title:"",html:"",rangeStyle:{styleClass:"annotationRange emptyAddedWordDiffRight"}});d.prototype={initAll:function(a,b,c,d,e,f,g){this._charOrWordDiff=a?a:"word";b&&(this._initialized=!0);this.editorWrapper=[{editor:b,diffFeeder:d},{editor:c,diffFeeder:e}];this._curveRuler=
g;(this._overviewRuler=f)&&this._overviewRuler.setDiffNavigator(this)},initMapper:function(a){if(a)for(var b=0;b<this.editorWrapper.length;b++)this.editorWrapper[b].diffFeeder.init(this.editorWrapper[b].editor.getTextView().getModel(),a)},destroy:function(){this.initAll(this._charOrWordDiff)},renderAnnotations:function(a){var b;for(b=0;b<this.editorWrapper.length;b++){this.editorWrapper[b].annoTypes=[];this.editorWrapper[b].diffFeeder.getBlockAnnoTypes(this.editorWrapper[b].annoTypes);this.editorWrapper[b].diffFeeder.getWordAnnoTypes(this.editorWrapper[b].annoTypes);
for(var c=0;c<this.editorWrapper[b].annoTypes.length;c++)this.editorWrapper[b].annoTypes[c].current&&this.editorWrapper[b].editor.getAnnotationStyler().addAnnotationType(this.editorWrapper[b].annoTypes[c].current),this.editorWrapper[b].annoTypes[c].normal&&this.editorWrapper[b].editor.getAnnotationStyler().addAnnotationType(this.editorWrapper[b].annoTypes[c].normal)}this._root.children=[];c=this.editorWrapper[0].diffFeeder.getDiffBlocks();if(!c||0===c.length)this.replaceAllAnnotations(!0,0,"block",
!1,[]),this.replaceAllAnnotations(!0,1,"block",!1,[]),this.replaceAllAnnotations(!0,0,"word",!1,[]),this.replaceAllAnnotations(!0,1,"word",!1,[]),this.replaceAllAnnotations(!0,0,"block",!0,[]),this.replaceAllAnnotations(!0,1,"block",!0,[]),this.replaceAllAnnotations(!0,0,"word",!0,[]),this.replaceAllAnnotations(!0,1,"word",!0,[]);else{a=new g.JSDiffAdapter(a);for(b=0;b<c.length;b++){var d=this.generatePairBlockAnnotations(this._root,b);this._root.children.push(d);var e=this.generatePairWordAnnotations(d,
b,a);e&&(d.children=e)}this.replaceAllAnnotations(!1,0,"block",!0);this.replaceAllAnnotations(!1,1,"block",!0);this.replaceAllAnnotations(!1,0,"word",!0);this.replaceAllAnnotations(!1,1,"word",!0);this.iterator=new m.TreeModelIterator(this._root.children)}},replaceAllAnnotations:function(a,b,c,d,e){if(this.editorWrapper[b].annoTypes)for(var f=0;f<this.editorWrapper[b].annoTypes.length;f++)this.editorWrapper[b].annoTypes[f].type===c&&this.replaceDiffAnnotations(this.editorWrapper[b].editor,e?e:this.editorWrapper[b].annoTypes[f].list,
d?this.editorWrapper[b].annoTypes[f].normal:this.editorWrapper[b].annoTypes[f].current,a)},getMapper:function(){return this.editorWrapper[0].diffFeeder.getMapper()},getFeeder:function(a){return a?this.editorWrapper[1].diffFeeder:this.editorWrapper[0].diffFeeder},iterateOnBlock:function(a,b){this.iterator&&(this.iterator.iterateOnTop(a,b),this.updateCurrentAnnotation(!0))},iterateOnChange:function(a){if(!this.iterator)return null;var b=this.iterator.iterate(a);if(b){var c=this.iterator.cursor();"block"===
c.type&&(c.children&&0<c.children.length)&&this.iterator.iterate(a);this.updateCurrentAnnotation(!0)}return b},gotoChangeUsingIndex:function(a){var b=0,c=0;if(0<=a)for(;c<this._root.children.length;){var d=this._root.children[c].children.length;if(b+d-1<a)b+=d;else return this.gotoBlock(c,a-b);c++}},gotoBlock:function(a,b){if(this.iterator){if(0>a||a>=this._root.children.length||0===this._root.children.length)a=0;void 0!==b&&0<=b&&this._root.children[a].children&&b<this._root.children[a].children.length?
this.iterator.setCursor(this._root.children[a].children[b]):this.iterator.setCursor(this._root.children[a]);this.updateCurrentAnnotation(!1);this._positionDiffBlock()}},_hitDiffAnnotation:function(a,b,c){if(c===this.editorWrapper[a].editor.getTextView()){for(var d=0;d<this._root.children.length;d++){c=this._root.children[d];var e=0===a?c.oldA:c.newA;if(b>=e.start&&b<=e.end){d=c;if(c.children&&0<c.children.length)for(e=0;e<c.children.length;e++){var f=c.children[e],g=0===a?f.oldA:f.newA;if(b>=g.start&&
b<=g.end){d=f;break}}return d}}return null}},gotoChange:function(a,b){for(var c=0;c<this.editorWrapper.length;c++){var d=this._hitDiffAnnotation(c,a,b);if(d)return this.iterator.setCursor(d),this.updateCurrentAnnotation(!1,b),!0}return!1},getCurrentBlockIndex:function(){if(!this.iterator)return-1;var a=this.iterator.cursor();return!a?-1:"block"===a.type?a.index:a.parent.index},getCurrentPosition:function(){if(!this.iterator)return{};var a=this.iterator.cursor();return!a?{}:"block"===a.type?{block:a.index+
1}:{block:a.parent.index+1,change:a.index+1}},getCurrentMapperIndex:function(){var a=this.getCurrentBlockIndex();0>a&&(a=0);var b=this.getFeeder().getDiffBlocks();if(!b||0===b.length)return-1;a>b.length-1&&(a=0);return b[a][1]},replaceDiffAnnotations:function(a,b,c,d){if(b&&c&&(a=a.getAnnotationModel())){for(var e=a.getAnnotations(),f=[];d&&e.hasNext();){var g=e.next();g.type===c&&f.push(g)}a.replaceAnnotations(f,b)}},updateCurrentAnnotation:function(a,b){this.replaceAllAnnotations(!0,0,"block",!1,
[]);this.replaceAllAnnotations(!0,1,"block",!1,[]);this.replaceAllAnnotations(!0,0,"word",!1,[]);this.replaceAllAnnotations(!0,1,"word",!1,[]);if(this.iterator){var d=this.iterator.cursor();if(d){var e,f,g={start:d.oldA.start,end:d.oldA.end},h={start:d.newA.start,end:d.newA.end};"word"===d.type?(e=this.editorWrapper[0].diffFeeder.getCurrentWordAnnoType(g,this.editorWrapper[0].editor.getTextView().getModel()),f=this.editorWrapper[1].diffFeeder.getCurrentWordAnnoType(h,this.editorWrapper[1].editor.getTextView().getModel())):
(e=this.editorWrapper[0].diffFeeder.getCurrentBlockAnnoType(d.index),f=this.editorWrapper[1].diffFeeder.getCurrentBlockAnnoType(d.index));e&&this.replaceDiffAnnotations(this.editorWrapper[0].editor,[new (c.AnnotationType.getType(e.current))(g.start,g.end)],e,!0);f&&this.replaceDiffAnnotations(this.editorWrapper[1].editor,[new (c.AnnotationType.getType(f.current))(h.start,h.end)],f,!0);a?(this.autoSelecting=!0,this.editorWrapper[0].editor.setSelection(d.oldA.start,d.oldA.end,!0),this.editorWrapper[1].editor.setSelection(d.newA.start,
d.newA.end,!0),this.autoSelecting=!1):b&&(this.autoSelecting=!0,b!==this.editorWrapper[0].editor.getTextView()&&this.editorWrapper[0].editor.setSelection(d.oldA.start,d.oldA.end,!0),b!==this.editorWrapper[1].editor.getTextView()&&this.editorWrapper[1].editor.setSelection(d.newA.start,d.newA.end,!0),this.autoSelecting=!1)}}},generatePairBlockAnnotations:function(a,b){var c=this.generateBlockDiffAnnotations(0,b),d=this.generateBlockDiffAnnotations(1,b);return{parent:a,index:b,type:"block",oldA:c,newA:d}},
generatePairWordAnnotations:function(a,b,c){var d=this.editorWrapper[0].diffFeeder.getTextOnBlock(b),e=this.editorWrapper[1].diffFeeder.getTextOnBlock(b);b=null;var f=0,g=0;if(d&&e&&d.text&&e.text&&5E3>=d.text.length&&5E3>=e.text.length)b=c.adaptCharDiff(d.text,e.text,"word"===this._charOrWordDiff),g=e.start,f=d.start;else return null;c=[];d=[];this.generateWordDiffAnnotations(0,c,f,b,2,3);this.generateWordDiffAnnotations(1,d,g,b,0,1);b=[];for(f=0;f<c.length;f++)b.push({parent:a,index:f,type:"word",
oldA:c[f],newA:d[f]});return b},getAnnoModelList:function(a,b,c){for(var d=0;d<this.editorWrapper[a].annoTypes.length;d++)if(this.editorWrapper[a].annoTypes[d].type===b&&this.editorWrapper[a].annoTypes[d].normal===c)return this.editorWrapper[a].annoTypes[d].list;return null},generateBlockDiffAnnotations:function(a,b){var d=this.editorWrapper[a].diffFeeder.getCurrentBlockAnnoType(b),e=this.getAnnoModelList(a,"block",d.normal),f=this.editorWrapper[a].diffFeeder.getCharRange(b),d=c.AnnotationType.createAnnotation(d.normal,
f.start,f.end);e&&e.push(d);return d},generateWordDiffAnnotations:function(a,b,d,e,f,g){if(e){var h=this.editorWrapper[a].diffFeeder.getCurrentWordAnnoType({start:-1,end:-1});a=this.getAnnoModelList(a,"word",h.normal);for(var k=0;k<e.length;k++){var l=c.AnnotationType.createAnnotation(h.normal,e[k][f]+d,e[k][g]+d);a.push(l);b.push(l)}}},_updateOverviewRuler:function(){if(this._overviewRuler){var a=this.editorWrapper[0].editor.getTextView().getTopIndex();this.editorWrapper[0].editor.getTextView().redrawLines(a,
a+1,this._overviewRuler)}},_updateCurveRuler:function(){this._curveRuler&&this._curveRuler.render()},_setTextViewPosition:function(a,b){var c=a.getLineHeight(),d=a.getClientArea(),c=Math.floor(d.height/c/3);a.setTopIndex(0<b-c?b-c:0)},_positionDiffBlock:function(){var a=this.getCurrentBlockIndex();0>a&&(a=0);var b=this.getFeeder().getDiffBlocks();0!==b.length&&(this._setTextViewPosition(this.editorWrapper[0].editor.getTextView(),b[a][0]),this.editorWrapper[0].editor!==this.editorWrapper[1].editor&&
(a=e.lookUpLineIndex(this.getMapper(),0,b[a][1]),this._setTextViewPosition(this.editorWrapper[1].editor.getTextView(),a)),this._updateOverviewRuler(),this._updateCurveRuler())},matchPositionFromOverview:function(a){this._initialized&&(a=0>a?0:e.getAnnotationIndex(this.getFeeder().getDiffBlocks(),a),this.gotoBlock(a))},gotoDiff:function(a,b){this.gotoChange(a,b)&&(this._updateOverviewRuler(),this._updateCurveRuler())},nextDiff:function(){this.iterateOnBlock(!0,!0);this._positionDiffBlock()},prevDiff:function(){this.iterateOnBlock(!1,
!0);this._positionDiffBlock()},nextChange:function(){var a=this.iterateOnChange(!0);this._positionDiffBlock();return a},prevChange:function(){this.iterateOnChange(!1);this._positionDiffBlock()}};return d}();d.DiffBlockFeeder=function(){function a(){}a.prototype={_isAddedSide:function(){return 0===this._mapperColumnIndex},getWordAnnoTypes:function(a){this._isAddedSide()?a.push({type:"word",current:u,normal:r,list:[]}):a.push({type:"word",current:w,normal:v,list:[]});a.push({type:"word",current:t});
a.push({type:"word",current:A});a.push({type:"word",current:z});a.push({type:"word",current:C})},getCurrentWordAnnoType:function(a,b){return a.start===a.end&&b?this._isAddedSide()?{current:this._repositionEmptyWord(a,b),normal:r}:{current:this._repositionEmptyWord(a,b),normal:v}:this._isAddedSide()?{current:u,normal:r}:{current:w,normal:v}},_repositionEmptyWord:function(a,b){var c=b.getLineAtOffset(a.start),d=b.getLineStart(c),e=b.getLineEnd(c);if(d!==e){if(a.start===e)return a.start--,this._isAddedSide()?
C:A;a.end++}else if(0<c&&(c--,d=b.getLineStart(c),e=b.getLineEnd(c),d!==e))return a.start=e-1,a.end=e,this._isAddedSide()?C:A;return this._isAddedSide()?z:t},getMapper:function(){return this._mapper},getDiffBlocks:function(){return this._diffBlocks},getDiffBlockH:function(a){if(!this._diffBlocks||0===this._diffBlocks.length)return-1;a=this._diffBlocks[a][1];return-1===a?0:this._mapper[a][this._mapperColumnIndex]},getOverviewLineCount:function(){return this._textModel.getLineCount()},getLineNumber:function(a){return a},
getCharRange:function(a){if(!this._diffBlocks||0===this._diffBlocks.length)return null;var b=this._diffBlocks[a][0],c=b+this._mapper[this._diffBlocks[a][1]][this._mapperColumnIndex]-1;a=this._textModel.getLineStart(b);if(c<b)return{start:a,end:a};b=this._textModel.getLineEnd(c,!0);return{start:a,end:b}},getTextOnBlock:function(a){if(!this._diffBlocks||0===this._diffBlocks.length)return null;a=this.getCharRange(a);return{start:a.start,text:this._textModel.getText(a.start,a.end)}},isMapperEmpty:function(){return 0===
this._mapper.length}};return a}();d.TwoWayDiffBlockFeeder=function(){function c(a,b,d,e){this._mapperColumnIndex=d;this._reverseAnnotation=e;this.init(a,b)}c.prototype=new d.DiffBlockFeeder;c.prototype._isAddedSide=function(){return this._reverseAnnotation?0!==this._mapperColumnIndex:0===this._mapperColumnIndex};c.prototype.init=function(a,b){this._textModel=a;this._diffBlocks=void 0;if(b){this._mapper=b;this._diffBlocks=[];for(var c=0,d=0;d<this._mapper.length;d++)0!==this._mapper[d][2]&&this._diffBlocks.push([c,
d]),c+=this._mapper[d][this._mapperColumnIndex]}};c.prototype.getBlockAnnoTypes=function(c){this._isAddedSide()?c.push({type:"block",normal:f,current:n,list:[]}):c.push({type:"block",normal:l,current:b,list:[]});c.push({type:"block",normal:a,current:q,list:[]});c.push({type:"block",normal:h,current:p,list:[]})};c.prototype.getCurrentBlockAnnoType=function(c){if(!this._diffBlocks||0===this._diffBlocks.length||this._diffBlocks.length<=c)return null;c=this._diffBlocks[c][1];return 0===this._mapper[c][this._mapperColumnIndex]?
{normal:a,current:q}:e.isMapperConflict(this.getMapper(),c)?{normal:h,current:p}:this._isAddedSide()?{type:"block",normal:f,current:n,list:[]}:{type:"block",normal:l,current:b,list:[]}};return c}();d.inlineDiffBlockFeeder=function(){function a(b,c){this._mapperColumnIndex=c;this.init(b)}a.prototype=new d.DiffBlockFeeder;a.prototype.setModel=function(a){this._textModel=a};a.prototype.init=function(a){this._diffBlocks=void 0;if(a){this._mapper=a;this._diffBlocks=[];this._gapBlocks=[];for(var b=a=0,
c=0;c<this._mapper.length;c++){if(0!==this._mapper[c][2]){if(this._isAddedSide()){var d=a+this._mapper[c][1];this._diffBlocks.push([d,c]);this._gapBlocks.push([d,d+this._mapper[c][0],b])}else this._diffBlocks.push([a,c]),this._gapBlocks.push([a,a+this._mapper[c][1],b]);a+=this._mapper[c][0]+this._mapper[c][1]}else this._gapBlocks.push([a,a+this._mapper[c][this._mapperColumnIndex],b]),a+=this._mapper[c][this._mapperColumnIndex];b+=this._mapper[c][this._mapperColumnIndex]}}};a.prototype.getBlockAnnoTypes=
function(a){this._isAddedSide()?a.push({type:"block",normal:f,current:n,list:[]}):a.push({type:"block",normal:l,current:b,list:[]});a.push({type:"block",normal:h,current:p,list:[]})};a.prototype.getCurrentBlockAnnoType=function(a){if(!this._diffBlocks||0===this._diffBlocks.length)return null;a=this._diffBlocks[a][1];return 0===this._mapper[a][this._mapperColumnIndex]?{current:u,normal:r}:e.isMapperConflict(this.getMapper(),a)?{normal:h,current:p}:this._isAddedSide()?{type:"block",normal:f,current:n,
list:[]}:{type:"block",normal:l,current:b,list:[]}};a.prototype.getDiffBlockH=function(a){if(!this._diffBlocks||0===this._diffBlocks.length)return-1;a=this._diffBlocks[a][1];return this._mapper[a][0]+this._mapper[a][1]};a.prototype.getLineNumber=function(a){for(var b=0;b<this._gapBlocks.length;b++)if(this._gapBlocks[b][0]!==this._gapBlocks[b][1]&&a>=this._gapBlocks[b][0]&&a<this._gapBlocks[b][1])return a-this._gapBlocks[b][0]+this._gapBlocks[b][2];return-1};return a}();return d});
define("orion/compare/compareView","i18n!orion/compare/nls/messages orion/Deferred orion/EventTarget orion/webui/littlelib orion/compare/diffParser orion/compare/compareRulers orion/editor/editor orion/editor/editorFeatures orion/keyBinding orion/editor/textView orion/compare/compareUIFactory orion/compare/compareUtils orion/compare/jsdiffAdapter orion/compare/diffTreeNavigator".split(" "),function(k,m,e,c,g,d,f,n,l,b,a,q,h,p,r,u,v){var w={};w.CompareView=function(){function a(){e.attach(this);this._diffParser=
new g.DiffParser}a.prototype={_clearOptions:function(){this.options={};this.options.blockNumber=1;this.options.changeNumber=0},_disableAnnoBookMark:function(a){a.forEach(function(a){if(a=a.getAnnotationRuler())a.onDblClick=function(){}})},_getLineDelim:function(a,b){return"\n"},_generateMapper:function(a,b,c,d,e,f){f=this._getLineDelim(b,d);this._diffParser.setLineDelim(f);if(this.options.mapper&&this.options.toggler&&!a)return{delim:f,mapper:this.options.mapper,output:this.options.newFile.Content,
diffArray:this.options.diffArray};if(!d&&"string"===typeof c&&"string"===typeof b)return a=(new h.JSDiffAdapter(this.isWhitespaceIgnored())).adapt(b,c,f),this.options.toggler&&(this.options.mapper=a.mapper,this.options.newFile.Content=c,this.options.diffArray=a.changContents),{delim:f,mapper:a.mapper,output:c,diffArray:a.changContents};a=this._diffParser.parse(b,d,e,!0);b=this._diffParser.getDiffArray();this.options.toggler&&(this.options.mapper=a.mapper,this.options.newFile.Content=c,this.options.diffArray=
b);return{delim:f,mapper:a.mapper,output:c,diffArray:b}},_loadImageFile:function(a,b,c){var d=document.createElement("img");d.src=a;var e=new m;d.onload=function(){b.appendChild(d);if(c){var a=document.createElement("hr");b.appendChild(a)}e.resolve(d.height)};d.onerror=function(){e.resolve(0)};return e},_initSyntaxHighlighter:function(a){this._syntaxHighlighters=null;if(this.options.highlighters&&0<this.options.highlighters.length&&!(1>a.length||2<a.length))this._syntaxHighlighters=[{highlighter:this.options.highlighters[0],
target:a[0]}],2===a.length&&2===this.options.highlighters.length&&this._syntaxHighlighters.push({highlighter:this.options.highlighters[1],target:a[1]})},_highlightSyntax:function(){if(this._syntaxHighlighters){var a=[];this._syntaxHighlighters.forEach(function(b){a.push(b.highlighter.highlight(b.target.fileName,b.target.contentType,b.target.editor))}.bind(this));m.all(a,function(a){return{_error:a}}).then(function(a){this._diffNavigator.renderAnnotations(this.isWhitespaceIgnored());this._diffNavigator.gotoBlock(this.options.blockNumber-
1,this.options.changeNumber-1);this.dispatchEvent({type:"contentLoaded"});this.options.toggler&&this.options.toggler.dispatchEvent({type:"contentLoaded"})}.bind(this))}else window.setTimeout(function(){this._diffNavigator.renderAnnotations(this.isWhitespaceIgnored());this._diffNavigator.gotoBlock(this.options.blockNumber-1,this.options.changeNumber-1);this.dispatchEvent({type:"contentLoaded"});this.options.toggler&&this.options.toggler.dispatchEvent({type:"contentLoaded"})}.bind(this),50)},isWhitespaceIgnored:function(){return this.getWidget().options.ignoreWhitespace},
ignoreWhitespace:function(a){var b=this.getWidget().options;b.ignoreWhitespace=a;b.diffProvider&&b.diffContent?b.diffProvider._diffProvider.getDiffContent(b.resource,{ignoreWS:a?"true":"false"}).then(function(a){b.diffContent=b.hasConflicts?a.split("diff --git")[1]:a;this.getWidget().refresh(!0,!0)}.bind(this),function(){}):this.getWidget().refresh(!0,!0)},setOptions:function(a,b){b&&this._clearOptions();this.options||(this.options={});a&&Object.keys(a).forEach(function(b){this.options[b]=a[b]}.bind(this));
if(a.newFileOnRight){var c=this.options.newFile;this.options.newFile=this.options.oldFile;this.options.oldFile=c}},getOptions:function(){return this.options},getCurrentDiffPos:function(){return this._diffNavigator.getCurrentPosition()},initDiffNav:function(){this._diffNavigator.gotoBlock(0,0)},nextDiff:function(){this._diffNavigator.nextDiff()},prevDiff:function(){this._diffNavigator.prevDiff()},nextChange:function(){return this._diffNavigator.nextChange()},prevChange:function(){this._diffNavigator.prevChange()},
getWidget:function(){return this},startup:function(){this.initEditors();this.refresh(!0)},initEditors:function(a){},initImageMode:function(){}};return a}();w.TwoWayCompareView=function(){function e(b){w.CompareView.call(this,b);this.setOptions(b,!0);this._diffNavigator=new p.DiffTreeNavigator("word");this.type="twoWay";this._uiFactory=this.options.uiFactory;this._uiFactory||(this._uiFactory=new a.TwoWayCompareUIFactory({parentDivID:this.options.parentDivId,showTitle:this.options.showTitle?this.options.showTitle:
!1,showLineStatus:this.options.showLineStatus?this.options.showLineStatus:!1}),this._uiFactory.buildUI());this._viewLoadedCounter=0;this.options.commandProvider&&this.options.commandProvider.initCommands(this);this._curveRuler=new d.CompareCurveRuler(this._uiFactory.getDiffCanvasDiv())}e.prototype=Object.create(w.CompareView.prototype);e.prototype.initEditors=function(a){this.options.preCreate&&this.options.preCreate();this._editors=[];this._editors.push(this._createEditor(a,this._uiFactory.getEditorParentDiv(!1),
this._uiFactory.getStatusDiv(!1),this.options.oldFile));this._editors.push(this._createEditor(a,this._uiFactory.getEditorParentDiv(!0),this._uiFactory.getStatusDiv(!0),this.options.newFile,!0));this._overviewRuler=new d.CompareOverviewRuler("right",{styleClass:"ruler overview"},null,function(a,b){this._diffNavigator.matchPositionFromOverview(a)}.bind(this));this.options.postCreate&&this.options.postCreate();window.onbeforeunload=function(){if(this.isDirty())return k["There are unsaved changes."]}.bind(this)};
e.prototype.disableAnnoBookMark=function(){this._disableAnnoBookMark(this._editors)};e.prototype.initImageMode=function(){this._editors&&(this._editors.forEach(function(a){a.destroy()}),this._editors=null);this._uiFactory.getEditorParentDiv(!0).classList.add("compareEditorParentImageMode");this._uiFactory.getEditorParentDiv().classList.add("compareEditorParentImageMode");this._uiFactory.disableTitle();this._uiFactory.disableLineStatus();this._imageMode=!0};e.prototype.getImageMode=function(){return this._imageMode};
e.prototype.getEditors=function(){return this._editors};e.prototype.gotoDiff=function(a,b,c){c=c?this._editors[1].getTextView():this._editors[0].getTextView();a=c.getModel().getLineStart(a)+b;this._diffNavigator.gotoDiff(a,c)};e.prototype.copyToLeft=function(){this._curveRuler.copyTo(!0)};e.prototype.copyToRight=function(){this._curveRuler.copyTo(!1)};e.prototype.resizeEditors=function(){this._editors.forEach(function(a){a.getTextView().resize()})};e.prototype.getSplitter=function(){return this._uiFactory.getSplitter()};
e.prototype._createEditor=function(a,c,d,e,g){var h="undefined"===typeof e.readonly?!0:e.readonly,l=function(){var a=new b.TextView({parent:c,readonly:h,tabSize:4});this._viewLoadedCounter++;2===this._viewLoadedCounter&&this._diffNavigator.matchPositionFromOverview(-1);if(this.onLoad)this.onLoad();var d=this.getSplitter();d&&d.addResizeListener(function(b){if(b){var c=!1;(c=this._uiFactory.isLeftPane(b)?g:!g)&&a.resize()}}.bind(this));return a}.bind(this),m=e.keyBindingFactory;m||(m=new n.KeyBindingsFactory);
var p=null;if(d)var q="",p=function(a,b){d&&(q=b?k["ERROR: "]+a:a,d.textContent=""+q)};l=new f.Editor({textViewFactory:l,undoStackFactory:new n.UndoFactory,annotationFactory:new n.AnnotationFactory,keyBindingFactory:m,statusReporter:p,domNode:c});l.installTextView();l.setInput(null,null,e.Content?e.Content:a);l.setOverviewRulerVisible(!1);var r=l.getTextView();r.addEventListener("Selection",function(a){a=Array.isArray(a.newValue)?a.newValue:[a.newValue];!(1<a.length)&&a[0].isEmpty()&&!this._diffNavigator.autoSelecting&&
this._diffNavigator.editorWrapper[0].diffFeeder&&this._diffNavigator.gotoDiff(a[0].getCaret(),r)}.bind(this));r.getModel().addEventListener("Changed",function(a){this._curveRuler.onChanged(a,!g)||(this.options.mapper=null)}.bind(this));g?r.addEventListener("Scroll",function(a){this._curveRuler&&(this._curveRuler.matchPositionFrom(!0),this._curveRuler.render());if(this.onScroll)this.onScroll()}.bind(this)):r.addEventListener("Scroll",function(a){this._curveRuler&&this._curveRuler.render()}.bind(this));
return l};e.prototype.isDirty=function(){return this._editors?this._editors.some(function(a){return a.isDirty()}):!1};e.prototype._destroy=function(){this._editors&&(this._diffNavigator.destroy(),this._editors.forEach(function(a){a.destroy()}),this._uiFactory.destroy())};e.prototype.destroy=function(){this._destroyed=!0;this._destroy()};e.prototype.addRulers=function(){if(this._editors&&!this._hasRuler){var a=new d.LineNumberCompareRuler(this._diffNavigator,0,"left",{styleClass:"ruler lines"},{styleClass:"rulerLines odd"},
{styleClass:"rulerLines even"}),b=new d.LineNumberCompareRuler(this._diffNavigator,0,"left",{styleClass:"ruler lines"},{styleClass:"rulerLines odd"},{styleClass:"rulerLines even"});this._editors[1].getTextView().addRuler(a);this._editors[0].getTextView().addRuler(b);this._editors[0].getTextView().addRuler(this._overviewRuler);this._hasRuler=!0}};e.prototype.refresh=function(a,b,c){if(!this._destroyed){if(this._imageMode){this.options.commandProvider&&this.options.commandProvider.renderCommands(this);
var d=this;return this._loadImageFile(this.options.newFile.URL,this._uiFactory.getEditorParentDiv(!0)).then(function(a){return d._loadImageFile(d.options.oldFile.URL,d._uiFactory.getEditorParentDiv()).then(function(b){return(new m).resolve(a>b?a:b)})})}b=this._generateMapper(b,this.options.oldFile.Content,this.options.newFile.Content,this.options.diffContent,this.options.hasConflicts,!this.options.toggler);var e=this.options.oldFile.Content,f=this.options.newFile.Content;"string"!==typeof f&&(f=b.output);
var g=new p.TwoWayDiffBlockFeeder(this._editors[0].getTextView().getModel(),b.mapper,1,this.options.newFileOnRight),h=new p.TwoWayDiffBlockFeeder(this._editors[1].getTextView().getModel(),b.mapper,0,this.options.newFileOnRight);this._diffNavigator.initAll(this.options.charDiff?"char":"word",this._editors[0],this._editors[1],g,h,this._overviewRuler,this._curveRuler);this._curveRuler.init(b.mapper,this._editors[1],this._editors[0],this._diffNavigator);a&&("number"===typeof c?1===c?this._editors[1].setInput(this.options.newFile.Name,
null,f):this._editors[0].setInput(this.options.oldFile.Name,null,e):(this._editors[1].setInput(this.options.newFile.Name,null,f),this._editors[0].setInput(this.options.oldFile.Name,null,e)));this._initSyntaxHighlighter([{fileName:this.options.newFile.Name,contentType:this.options.newFile.Type,editor:this._editors[1]},{fileName:this.options.oldFile.Name,contentType:this.options.oldFile.Type,editor:this._editors[0]}]);this._highlightSyntax();this.options.commandProvider&&this.options.commandProvider.renderCommands(this);
this.addRulers();2===this._viewLoadedCounter&&this._diffNavigator.gotoBlock(this.options.blockNumber-1,this.options.changeNumber-1);this.refreshTitle(0);this.refreshTitle(1);a=this._editors[1].getTextView().getModel().getLineCount()*this._editors[1].getTextView().getLineHeight()+5;c=this._editors[0].getTextView().getModel().getLineCount()*this._editors[0].getTextView().getLineHeight()+5;return a>c?a:c}};e.prototype.refreshTitle=function(a,b){if(1===a){var d=this._uiFactory.getTitleDiv(!0);d&&(c.empty(d),
d.appendChild(document.createTextNode(b||this._editors[a].isDirty()?this.options.newFile.Name+"*":this.options.newFile.Name)))}else if(d=this._uiFactory.getTitleDiv(!1))c.empty(d),d.appendChild(document.createTextNode(b||this._editors[a].isDirty()?this.options.oldFile.Name+"*":this.options.oldFile.Name))};e.prototype.gotoLine=function(a,b,c,d){"number"!==typeof b&&(b=0);var e=function(){d(a)}.bind(this);this._editors[1].onGotoLine(a,b,c,e)};e.prototype.getMainEditor=function(){return this._editors?
this._editors[1]:null};e.prototype.getLineNumber=function(a){return a};return e}();w.InlineCompareView=function(){function a(b){w.CompareView.call(this,b);this.setOptions(b,!0);this._diffNavigator=new p.DiffTreeNavigator("word");this.type="inline";this.options.commandProvider&&this.options.commandProvider.initCommands(this);this._editorDiv=this.options.parentDivId}a.prototype=Object.create(w.CompareView.prototype);a.prototype.addRulers=function(){this._textView&&!this._hasRuler&&(this._textView.addRuler(this._rulerOrigin),
this._textView.addRuler(this._rulerNew),this._textView.addRuler(this._overviewRuler),this._hasRuler=!0)};a.prototype.removeRulers=function(){this._textView&&this._hasRuler&&(this._textView.removeRuler(this._rulerOrigin),this._textView.removeRuler(this._rulerNew),this._textView.removeRuler(this._overviewRuler),this._hasRuler=!1)};a.prototype.destroyEditor=function(){this._textView&&(this._diffNavigator.destroy(),this._textView.setText(""),this.removeRulers())};a.prototype.isDirty=function(){return!1};
a.prototype.destroy=function(){this._destroyed=!0;this._textView&&(this._diffNavigator.destroy(),this._textView.destroy())};a.prototype.initEditors=function(a){this.options.preCreate&&this.options.preCreate();var e=c.node(this._editorDiv),g=function(){return new b.TextView({parent:e,readonly:!0,tabSize:4})}.bind(this);this._editor=new f.Editor({textViewFactory:g,undoStackFactory:new n.UndoFactory,annotationFactory:new n.AnnotationFactory,domNode:e});this._editor.installTextView();this._editor.setInput(null,
null,a);this._editor.setOverviewRulerVisible(!1);this._editor.setAnnotationRulerVisible(!0);this._textView=this._editor.getTextView();this._rulerOrigin=new d.LineNumberCompareRuler(this._diffNavigator,1,"left",{styleClass:"ruler lines inlineRulerLeft"},{styleClass:"rulerLines odd"},{styleClass:"rulerLines even"});this._rulerNew=new d.LineNumberCompareRuler(this._diffNavigator,0,"left",{styleClass:"ruler lines"},{styleClass:"rulerLines odd"},{styleClass:"rulerLines even"});this._overviewRuler=new d.CompareOverviewRuler("right",
{styleClass:"ruler overview"},null,function(a,b){this._diffNavigator.matchPositionFromOverview(a)}.bind(this));this._textView.addEventListener("Selection",function(a){a=Array.isArray(a.newValue)?a.newValue:[a.newValue];!(1<a.length)&&a[0].isEmpty()&&!this._diffNavigator.autoSelecting&&this._diffNavigator.editorWrapper[0].diffFeeder&&this._diffNavigator.gotoDiff(a[0].getCaret(),this._textView)}.bind(this))};a.prototype.disableAnnoBookMark=function(){this._disableAnnoBookMark([this._editor])};a.prototype.initImageMode=
function(){this._editor&&(this._editor.destroy(),this._editor=null);c.node(this._editorDiv).classList.add("compareEditorParentImageMode");this._imageMode=!0};a.prototype.getImageMode=function(){return this._imageMode};a.prototype._initDiffPosition=function(a){var b=a.getModel();if(b&&b.getAnnotations&&(b=b.getAnnotations(),0<b.length)){var b=b[0][0],c=a.getLineHeight(),d=a.getClientArea(),c=Math.floor(d.height/c/3);a.setTopIndex(0<b-c?b-c:0)}};a.prototype.refresh=function(a,b){if(!this._destroyed){if(this._imageMode){this.options.commandProvider&&
this.options.commandProvider.renderCommands(this);var d=this;return this._loadImageFile(this.options.newFile.URL,c.node(this._editorDiv),!0).then(function(a){return d._loadImageFile(d.options.oldFile.URL,c.node(d._editorDiv)).then(function(b){return(new m).resolve(a+b+20)})})}var e=this._generateMapper(b,this.options.oldFile.Content,this.options.newFile.Content,this.options.diffContent,this.options.hasConflicts,!this.options.toggler);this._mapper=e.mapper;this._textView.getModel().setText(this.options.oldFile.Content);
var f=new p.inlineDiffBlockFeeder(e.mapper,1),g=new p.inlineDiffBlockFeeder(e.mapper,0);q.mergeDiffBlocks(this._textView.getModel(),g.getDiffBlocks(),e.mapper,e.diffArray.array,e.diffArray.index,this._diffParser._lineDelimiter);f.setModel(this._textView.getModel());g.setModel(this._textView.getModel());this._diffNavigator.initAll(this.options.charDiff?"char":"word",this._editor,this._editor,f,g,this._overviewRuler);this._initSyntaxHighlighter([{fileName:this.options.oldFile.Name,contentType:this.options.oldFile.Type,
editor:this._editor}]);this._highlightSyntax();this.options.commandProvider&&this.options.commandProvider.renderCommands(this);this.removeRulers();this.addRulers();e=this._textView.getTopIndex();this._textView.redrawLines(e,e+1,this._overviewRuler);this._textView.redrawLines(e,e+1,this._rulerOrigin);this._textView.redrawLines(e,e+1,this._rulerNew);this._diffNavigator.gotoBlock(this.options.blockNumber-1,this.options.changeNumber-1);return this._textView.getLineHeight()*this._textView.getModel().getLineCount()+
5}};a.prototype.setConflicting=function(a){this._conflcit=a};a.prototype.gotoDiff=function(a){this._diffNavigator.gotoChangeUsingIndex(a)};a.prototype.gotoLine=function(a,b,c,d){"number"!==typeof b&&(b=0);var e=q.convertMergedLineNumber(this._mapper,a);a=function(){d(e)}.bind(this);this._editor.onGotoLine(e,b,c,a)};a.prototype.getMainEditor=function(){return this._editor?this._editor:null};a.prototype.getLineNumber=function(a,b,c){return b?(b=this._diffNavigator.getFeeder(c?!1:!0))?b.getLineNumber(a):
a:q.convertMergedLineNumber(this._mapper,a,c)};return a}();w.toggleableCompareView=function(){function a(b,c){e.attach(this);c&&(c.toggler=this);this._widget="inline"===b?new w.InlineCompareView(c):new w.TwoWayCompareView(c)}a.prototype={startup:function(){this._widget.startup()},initImageMode:function(){this._imageMode=!0;this._widget.initImageMode()},_toggle:function(a){this._widget.destroy();c.empty(c.node(a.parentDivId));this._widget="inline"===this._widget.type?new w.TwoWayCompareView(a):new w.InlineCompareView(a);
this._imageMode?this._widget.initImageMode():this._widget.initEditors();this._widget.refresh(!0);if(a.onInputChanged&&"twoWay"===this._widget.type)a.onInputChanged()},toggle:function(){var a=this._widget.options;if(!this._imageMode){var b=this._widget.getCurrentDiffPos();a.blockNumber=b.block;a.changeNumber=b.change}this._toggle(a)},isDirty:function(){return this._widget.isDirty()},destroy:function(){return this._widget.destroy()},getWidget:function(){return this._widget}};return a}();return w});
define("orion/compare/compareCommands","i18n!orion/compare/nls/messages orion/commands orion/Deferred orion/keyBinding orion/webui/littlelib orion/EventTarget".split(" "),function(k,m,e,c,g,d){var f={};f.CompareCommandFactory=function(){function f(c){d.attach(this);this.setOptions(c,!0)}f.prototype={setOptions:function(c,b){b&&(this.options={});this.options||(this.options={});c&&Object.keys(c).forEach(function(a){this.options[a]=c[a]}.bind(this))},getOptions:function(){return this.options},initCommands:function(d){var b=
this.options.commandSpanId,a=this.options.toggleCommandSpanId,f=this.options.commandService;if(f&&(b||a)){var g=new m.Command({name:k.CpCurChangeRightToLeft,tooltip:k.CpCurChangeRightToLeft,imageClass:"core-sprite-leftarrow",id:"orion.compare.copyToLeft",groupId:"orion.compareGroup",visibleWhen:function(a){return"twoWay"===d.type&&!d.getImageMode()&&d.options.newFile&&!d.options.newFile.readonly}.bind(this),callback:function(a){a.items.copyToLeft()}}),n=new m.Command({name:k.CpCurChangeLeftToRight,
tooltip:k.CpCurChangeLeftToRight,imageClass:"core-sprite-rightarrow",id:"orion.compare.copyToRight",groupId:"orion.compareGroup",visibleWhen:function(a){return"twoWay"===d.type&&!d.getImageMode()&&d.options.oldFile&&!d.options.oldFile.readonly}.bind(this),callback:function(a){a.items.copyToRight()}}),r=new m.Command({tooltip:k.IgnoreWhitespaceTooltip,name:k.IgnoreWhitespace,imageClass:"core-sprite-whitespace",id:"orion.compare.ignoreWhitespace",groupId:"orion.compareGroup",type:"toggle",visibleWhen:function(a){a=
a.isWhitespaceIgnored();r.checked=a;r.name=a?k.UseWhitespace:k.IgnoreWhitespace;r.tooltip=a?k.UseWhitespaceTooltip:k.IgnoreWhitespaceTooltip;return!0},preCallback:function(a){a=a.handler.getWidget();if("function"===typeof a.options.onSave&&a.isDirty()){var b=window.confirm(k.confirmUnsavedChanges);return!b?(new e).resolve():a.options.onSave(b)}return(new e).resolve(!0)},callback:function(a){a.items.ignoreWhitespace(r.checked);this.dispatchEvent({type:"compareConfigChanged",name:"ignoreWhiteSpace",
value:r.checked})}.bind(this)}),u=new m.Command({tooltip:k["Switch to unified diff"],name:k.Unified,imageClass:"compare-sprite-inline-2way",id:"orion.compare.toggleInline2Way",groupId:"orion.compareGroup",type:"switch",visibleWhen:function(a){if(!a.options.toggler)return!1;a="twoWay"===a.options.toggler.getWidget().type;u.checked=!a;u.name=a?k.Unified:k["Side by side"];u.tooltip=a?k["Switch to unified diff"]:k["Switch to side by side diff"];return!0},preCallback:function(a){a=a.handler.getWidget();
if("function"===typeof a.options.onSave&&a.isDirty()){var b=window.confirm(k.confirmUnsavedChanges);return!b?(new e).resolve():a.options.onSave(b)}return(new e).resolve(!0)},callback:function(a){this.dispatchEvent({type:"compareConfigChanged",name:"mode",value:"twoWay"===a.items.options.toggler.getWidget().type?"inline":"twoWay"});a.items.options.toggler.toggle()}.bind(this)}),v=new m.Command({name:k["Next diff block"],tooltip:k["Next diff block"],imageClass:"core-sprite-move-down",id:"orion.compare.nextDiff",
groupId:"orion.compareGroup",visibleWhen:function(a){return!d.getImageMode()},callback:function(a){a.items.nextDiff()}}),w=new m.Command({name:k["Previous diff block"],tooltip:k["Previous diff block"],imageClass:"core-sprite-move-up",id:"orion.compare.prevDiff",groupId:"orion.compareGroup",visibleWhen:function(a){return!d.getImageMode()},callback:function(a){a.items.prevDiff()}}),t=new m.Command({name:k["Next diff change"],tooltip:k["Next diff change"],imageClass:"core-sprite-move-down",id:"orion.compare.nextChange",
groupId:"orion.compareGroup",visibleWhen:function(a){return!d.getImageMode()},callback:function(a){a.items.nextChange()}}),A=new m.Command({name:k["Previous diff change"],tooltip:k["Previous diff change"],imageClass:"core-sprite-move-up",id:"orion.compare.prevChange",groupId:"orion.compareGroup",visibleWhen:function(a){return!d.getImageMode()},callback:function(a){a.items.prevChange(a)}});f.addCommand(g);f.addCommand(n);f.addCommand(r);f.addCommand(u);f.addCommand(v);f.addCommand(w);f.addCommand(t);
f.addCommand(A);a?f.registerCommandContribution(a,"orion.compare.toggleInline2Way",108):b&&f.registerCommandContribution(b,"orion.compare.toggleInline2Way",108);b&&(f.registerCommandContribution(b,"orion.compare.copyToLeft",110,null,!1,new c.KeyBinding(37,!0,!1,!0)),f.registerCommandContribution(b,"orion.compare.copyToRight",111,null,!1,new c.KeyBinding(39,!0,!1,!0)),f.registerCommandContribution(b,"orion.compare.nextDiff",112,null,!1,new c.KeyBinding(40,!0)),f.registerCommandContribution(b,"orion.compare.prevDiff",
113,null,!1,new c.KeyBinding(38,!0)),d.options.wordLevelNav?(f.registerCommandContribution(b,"orion.compare.nextChange",114,null,!1,new c.KeyBinding(40,!0,!0)),f.registerCommandContribution(b,"orion.compare.prevChange",115,null,!1,new c.KeyBinding(38,!0,!0))):(f.registerCommandContribution(b,"orion.compare.nextChange",114,null,!0,new c.KeyBinding(40,!0,!0)),f.registerCommandContribution(b,"orion.compare.prevChange",115,null,!0,new c.KeyBinding(38,!0,!0))),f.registerCommandContribution(b,"orion.compare.ignoreWhitespace",
109))}},renderCommands:function(c){var b=this.options.commandSpanId,a=this.options.toggleCommandSpanId,d=this.options.commandService;if(d&&(b||a))a&&(g.empty(g.node(a)),d.renderCommands(a,a,c,c,"tool",null)),b&&(g.empty(g.node(b)),this.options.gridRenderer&&this.options.gridRenderer.navGridHolder?(this.options.gridRenderer.navGridHolder.splice(0,this.options.gridRenderer.navGridHolder.length),this.options.gridRenderer.additionalCmdRender?this.options.gridRenderer.before?(this.options.gridRenderer.additionalCmdRender(this.options.gridRenderer.navGridHolder),
d.renderCommands(b,b,c,c,"tool",null,this.options.gridRenderer.navGridHolder)):(d.renderCommands(b,b,c,c,"tool",null,this.options.gridRenderer.navGridHolder),this.options.gridRenderer.additionalCmdRender(this.options.gridRenderer.navGridHolder)):d.renderCommands(b,b,c,c,"tool",null,this.options.gridRenderer.navGridHolder)):d.renderCommands(b,b,c,c,"tool",null))}};return f}();return f});
define("compare/builder/compare","orion/commandRegistry orion/staticDataSource orion/contentTypes orion/Deferred orion/webui/littlelib orion/compare/compareView orion/compare/compareCommands".split(" "),function(k,m,e,c,g,d,f){function n(a){var b=new c,d=new XMLHttpRequest;d.open("GET",a,!0);d.onreadystatechange=function(){if(4===d.readyState){var a="undefined"!==typeof d.response?d.response:d.responseText,a="string"===typeof a?a:null,c=d.status;200<=c&&400>c?b.resolve(a):b.reject(a)}};d.send();return b}
function l(a){if(!a)return a;var b=g.node(a);if(b){if("ul"!==b.nodeName.toLowerCase()){var c=document.createElement("ul");c.id=a+"__compareCmdUL";c.classList.add("layoutLeft");c.classList.add("commandList");b.appendChild(c);return c.id}b.classList.add("commandList")}return a}function b(b,c,e,g,k){!b.highlighters&&(b.oldFile&&b.oldFile.Name&&b.newFile&&b.newFile.Name)&&(b.highlighters=[new m.SyntaxHighlighter,new m.SyntaxHighlighter]);b.oldFile&&b.oldFile.Name&&(b.oldFile.Type=q.getFilenameContentType(b.oldFile.Name));
b.newFile&&b.newFile.Name&&(b.newFile.Type=q.getFilenameContentType(b.newFile.Name));if(c||k)c=new f.CompareCommandFactory({commandService:a,commandSpanId:l(c),toggleCommandSpanId:l(k)}),b.commandProvider=c;e="inline"===e?"inline":"twoWay";this.compareView=g?new d.toggleableCompareView(e,b):"inline"===e?new d.inlineCompareView(b):new d.TwoWayCompareView(b);this.compareView.startup()}var a=new k.CommandRegistry({}),q=new e.ContentTypeRegistry(m.ContentTypes);b.prototype={getCompareView:function(){return this.compareView},
setFileNames:function(a,b){var c=this.getCompareView().getWidget().options;c.newFile&&a&&(c.newFile.Name=a,c.newFile.Type=q.getFilenameContentType(a));c.oldFile&&b&&(c.oldFile.Name=b,c.oldFile.Type=q.getFilenameContentType(b))},refresh:function(){var a=this.getCompareView().getWidget().options;if(a.oldFile.URL&&a.newFile.URL){var b=[];b.push(n(a.oldFile.URL));b.push(n(a.newFile.URL));c.all(b,function(a){return{_error:a}}).then(function(a){this.getCompareView().getWidget().options.oldFile.Content=
a[0];this.getCompareView().getWidget().options.newFile.Content=a[1];this.getCompareView().getWidget().refresh(!0)}.bind(this))}else this.getCompareView().getWidget().refresh(!0)}};return b});define(["compare/builder/compare"],function(k){return k});